"use strict";var Kr=Object.create;var It=Object.defineProperty;var Lr=Object.getOwnPropertyDescriptor;var Gr=Object.getOwnPropertyNames;var Vr=Object.getPrototypeOf,Hr=Object.prototype.hasOwnProperty;var Qr=(e,t)=>{for(var n in t)It(e,n,{get:t[n],enumerable:!0})},kn=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Gr(t))!Hr.call(e,i)&&i!==n&&It(e,i,{get:()=>t[i],enumerable:!(r=Lr(t,i))||r.enumerable});return e};var ht=(e,t,n)=>(n=e!=null?Kr(Vr(e)):{},kn(t||!e||!e.__esModule?It(n,"default",{value:e,enumerable:!0}):n,e)),Yr=e=>kn(It({},"__esModule",{value:!0}),e);var Ea={};Qr(Ea,{FAST_MCTP_PAYLOAD_TYPE_CUSTOM_PAYLOAD:()=>Vt,FAST_MCTP_PAYLOAD_TYPE_DEFAULT:()=>Gt,FAST_MCTP_PAYLOAD_TYPE_ORDER:()=>Ht,MCTP_INIT_ORDER_PAYLOAD_ID:()=>Lt,MCTP_PAYLOAD_TYPE_CUSTOM_PAYLOAD:()=>ct,MCTP_PAYLOAD_TYPE_DEFAULT:()=>pt,PermitTypes:()=>Fn,SWIFT_PAYLOAD_TYPE_CUSTOM_PAYLOAD:()=>Je,SWIFT_PAYLOAD_TYPE_DEFAULT:()=>$e,ZeroPermit:()=>we,addBridgeLockedFeeMoveCalls:()=>_r,addBridgeWithFeeMoveCalls:()=>Mr,addBridgeWithFeeMoveCalls2:()=>Ot,addInitOrderMoveCalls:()=>kr,addresses:()=>l,assertArgumentIsImmutable:()=>wt,broadcastJitoBundleId:()=>on,checkHyperCoreDeposit:()=>Qt,checkSdkVersionSupport:()=>Ut,confirmJitoBundleId:()=>sn,createApproveInstruction:()=>nn,createAssociatedTokenAccountInstruction:()=>re,createCloseAccountInstruction:()=>Jn,createHyperCoreDepositFromSolanaInstructions:()=>ln,createHyperCoreDepositFromSuiMoveCalls:()=>Mn,createInitializeRandomTokenAccountInstructions:()=>ve,createMctpBridgeLedgerInstruction:()=>rt,createMctpBridgeWithFeeInstruction:()=>nt,createMctpFromSolanaInstructions:()=>pn,createMctpFromSuiMoveCalls:()=>Sn,createMonoChainFromSolanaInstructions:()=>dn,createPayloadWriterCloseInstruction:()=>je,createPayloadWriterCreateInstruction:()=>Ye,createSplTransferInstruction:()=>Re,createSwapFromSolanaInstructions:()=>gr,createSwapFromSuiMoveCalls:()=>Ra,createSwiftFromSolanaInstructions:()=>cn,createSwiftOrderHash:()=>Pt,createSwiftRandomKey:()=>dt,createSyncNativeInstruction:()=>et,createTransferAllAndCloseInstruction:()=>Ke,decentralizeClientSwapInstructions:()=>Oe,decideRelayer:()=>rn,deserializeInstructionInfo:()=>yt,estimateQuoteRequiredGas:()=>Pa,estimateQuoteRequiredGasAprox:()=>Ma,estimateQuoteRequiredGasAprox2:()=>_a,fetchAllCoins:()=>kt,fetchAllTokenList:()=>Zr,fetchMayanSuiPackageId:()=>He,fetchQuote:()=>qr,fetchTokenList:()=>Xr,generateFetchQuoteUrl:()=>vn,getAddressLookupTableAccounts:()=>Ee,getAmountOfFractionalAmount:()=>w,getAnchorInstructionData:()=>te,getAssociatedTokenAddress:()=>U,getCurrentChainTime:()=>ea,getDisplayAmount:()=>Wt,getEstimateGasEvm:()=>Jt,getEvmChainIdByName:()=>At,getEvmSwiftParams:()=>yn,getFastMctpFromEvmTxPayload:()=>Tn,getGasDecimal:()=>j,getGasDecimalsInSolana:()=>Kt,getHyperCoreDepositFromEvmTxPayload:()=>hn,getHyperCoreUSDCDepositCustomPayload:()=>lt,getHyperCoreUSDCDepositPermitParams:()=>zr,getJitoTipTransfer:()=>an,getLookupTableAddress:()=>Fe,getMctpFromEvmTxPayload:()=>en,getMonoChainFromEvmTxPayload:()=>An,getNormalizeFactor:()=>We,getPermitDomain:()=>On,getPermitParams:()=>Dn,getQuoteSuitableReferrerAddress:()=>Qe,getSafeU64Blob:()=>B,getSdkVersion:()=>Ne,getSuggestedRelayer:()=>Yt,getSvmDurableNonce:()=>zt,getSwapEvm:()=>Ue,getSwapFromEvmTxPayload:()=>Tt,getSwapSolana:()=>ke,getSwapSui:()=>ze,getSwiftFromEvmGasLessParams:()=>gn,getSwiftFromEvmTxPayload:()=>fn,getSwiftOrderTypeData:()=>wr,getSwiftToTokenHexString:()=>qe,getWormholeChainIdById:()=>ce,getWormholeChainIdByName:()=>_,hexToUint8Array:()=>Q,isValidAptosType:()=>En,nativeAddressToHexString:()=>h,resolveInputCoin:()=>De,sandwichInstructionInCpiProxy:()=>A,sendJitoBundle:()=>St,solMint:()=>Ce,submitSwiftEvmSwap:()=>jt,submitSwiftSolanaSwap:()=>$t,submitTransactionWithRetry:()=>ft,swapFromEvm:()=>Sa,swapFromSolana:()=>ba,unwrapSol:()=>sa,validateJupSwap:()=>le,validateJupSwapInstructionData:()=>un,wait:()=>ut,wrapSol:()=>ia});module.exports=Yr(Ea);var ye=ht(require("cross-fetch"));var l={MAYAN_FORWARDER_CONTRACT:"0x337685fdaB40D39bd02028545a4FfA7D287cC3E2",MAYAN_PROGRAM_ID:"FC4eXxkyrMPTjiYUpp4EAnkmwMbQyZ6NDCh1kfLn6vsf",AUCTION_PROGRAM_ID:"8QJmxZcEzwuYmCPy6XqgN2sHcYCcFq6AEfBMJZZuLo5a",MCTP_PROGRAM_ID:"dkpZqrxHFrhziEMQ931GLtfy11nFkCsfMftH9u6QwBU",FAST_MCTP_PROGRAM_ID:"Gx9rivpS3YR8pBFwMuP6omYqVxunpLvLkNn7ubNyuZZ5",SWIFT_PROGRAM_ID:"BLZRi6frs4X4DNLw56V4EXai1b6QVESN1BhHBTYM9VcY",SWIFT_V2_PROGRAM_ID:"92peaC8g5ANAxpK2aCfLTC12JgPncRKCGULQNB2DMvRH",FEE_MANAGER_PROGRAM_ID:"5VtQHnhs2pfVEr68qQsbTRwKh4JV5GTu9mBHgHFxpHeQ",WORMHOLE_PROGRAM_ID:"worm2ZoG2kUd4vFXhvjh93UUH596ayRfgQ2MgjNMTth",WORMHOLE_PROGRAM_ID_FOGO:"worm2mrQkG1B1KTz37erMfWN8anHkSK24nzca7UD8BB",WORMHOLE_SHIM_POST_MESSAGE_PROGRAM_ID:"EtZMZM22ViKMo4r5y4Anovs3wKQ2owUmDpjygnMMcdEX",CCTP_CORE_PROGRAM_ID:"CCTPmbSD7gX1bxKPAmg77w8oFzNFpaQiQUWD43TKaecd",CCTPV2_CORE_PROGRAM_ID:"CCTPV2Sm4AdWt5296sk4P66VBZ7bEhcARwFaaS9YPbeC",CCTP_TOKEN_PROGRAM_ID:"CCTPiPYPc6AsJuwueEnWgSgucamXDZwBd53dQ11YiKX3",CCTPV2_TOKEN_PROGRAM_ID:"CCTPV2vPZJS2u2BBsUoscuikbYjnpFmbFsvVuJdgUMQe",TOKEN_PROGRAM_ID:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA",TOKEN_2022_PROGRAM_ID:"TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb",ASSOCIATED_TOKEN_PROGRAM_ID:"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL",SPL_UTILS_PROGRAM_ID:"B96dV3Luxzo6SokJx3xt8i5y8Mb7HRR6Eec8hCjJDT69",LOOKUP_TABLE_SOLANA:"Ff3yi1meWQQ19VPZMzGg6H8JQQeRudiV7QtVtyzJyoht",LOOKUP_TABLE_FOGO:"ZnLmtY5qckPcBQfdD4uKh9GtiQTrzQfQXEX86U3aLq7",SUI_MCTP_STATE:"0xb787fe0f7530b4fd2162fa0cc92f4f6c5a97c54b4c5c55eb04ab29f4b803ac9c",SUI_MCTP_FEE_MANAGER_STATE:"0xa1b4a96ce93d36dd0bbce0adc39533a07d2f32928918c80cd6fe7868320978f2",SUI_SWIFT_STATE:"0x7ac01a7c14c53098a41593c7623823bb677b5201fb3ee35b75b47cfc6c6c6f40",SUI_SWIFT_FEE_MANAGER_STATE:"0xe42174b6d742f40bd2b67b967542b21e6d7433f2d277a80bb59866ac73ff3f52",SUI_CCTP_CORE_PACKAGE_ID:"0x08d87d37ba49e785dde270a83f8e979605b03dc552b5548f26fdf2f49bf7ed1b",SUI_CCTP_CORE_STATE:"0xf68268c3d9b1df3215f2439400c1c4ea08ac4ef4bb7d6f3ca6a2a239e17510af",SUI_CCTP_TOKEN_PACKAGE_ID:"0x2aa6c5d56376c371f88a6cc42e852824994993cb9bab8d3e6450cbe3cb32b94e",SUI_CCTP_TOKEN_STATE:"0x45993eecc0382f37419864992c12faee2238f5cfe22b98ad3bf455baf65c8a2f",SUI_WORMHOLE_PACKAGE_ID:"0x5306f64e312b581766351c07af79c72fcb1cd25147157fdc2f8ad76de9a3fb6a",SUI_WORMHOLE_STATE:"0xaeab97f96cf9877fee2883315d459552b2b921edc16d7ceac6eab944dd88919c",SUI_LOGGER_PACKAGE_ID:"0x05680e9030c147b413a489f7891273acc221d49bd061c433e5771bc170fc37ac",EXPLORER_URL:"https://explorer-api.mayan.finance/v3",PRICE_URL:"https://price-api.mayan.finance/v3",RELAYER_URL:"https://relayer-api.mayan.finance/v3",SWIFT_RELAYER_URL:"https://swift-relayer-api.mayan.finance/v3",GAS_ESTIMATE_URL:"https://gas-estimate.mayan.finance/v2",HC_ARBITRUM_BRIDGE:"0x2df1c51e09aecf9cacb7bc98cb1742757f163df7",HC_ARBITRUM_DEPOSIT_PROCESSOR:"0xdDd77e62C848C3334f1148d4F1457FC59ede4E4B",ARBITRUM_USDC_CONTRACT:"0xaf88d065e77c8cC2239327C5EDb3A432268e5831",PAYLOAD_WRITER_PROGRAM_ID:"DwMLtdtJqJQkHzNcrdTBuWHJByJfgpKBnvFvzyKdy3cU",CPI_PROXY_PROGRAM_ID:"D8C8iW6zmoKg5TRr8nQ7h14TMWqQX8FiBdj2ju5MF3wa"};var G=require("ethers"),me=require("@solana/web3.js"),Be=require("buffer");var Bt={_format:"hh-sol-artifact-1",contractName:"ERC20Permit",sourceName:"contracts/token/ERC20/extensions/ERC20Permit.sol",abi:[{inputs:[],name:"ECDSAInvalidSignature",type:"error"},{inputs:[{internalType:"uint256",name:"length",type:"uint256"}],name:"ECDSAInvalidSignatureLength",type:"error"},{inputs:[{internalType:"bytes32",name:"s",type:"bytes32"}],name:"ECDSAInvalidSignatureS",type:"error"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"allowance",type:"uint256"},{internalType:"uint256",name:"needed",type:"uint256"}],name:"ERC20InsufficientAllowance",type:"error"},{inputs:[{internalType:"address",name:"sender",type:"address"},{internalType:"uint256",name:"balance",type:"uint256"},{internalType:"uint256",name:"needed",type:"uint256"}],name:"ERC20InsufficientBalance",type:"error"},{inputs:[{internalType:"address",name:"approver",type:"address"}],name:"ERC20InvalidApprover",type:"error"},{inputs:[{internalType:"address",name:"receiver",type:"address"}],name:"ERC20InvalidReceiver",type:"error"},{inputs:[{internalType:"address",name:"sender",type:"address"}],name:"ERC20InvalidSender",type:"error"},{inputs:[{internalType:"address",name:"spender",type:"address"}],name:"ERC20InvalidSpender",type:"error"},{inputs:[{internalType:"uint256",name:"deadline",type:"uint256"}],name:"ERC2612ExpiredSignature",type:"error"},{inputs:[{internalType:"address",name:"signer",type:"address"},{internalType:"address",name:"owner",type:"address"}],name:"ERC2612InvalidSigner",type:"error"},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"uint256",name:"currentNonce",type:"uint256"}],name:"InvalidAccountNonce",type:"error"},{inputs:[],name:"InvalidShortString",type:"error"},{inputs:[{internalType:"string",name:"str",type:"string"}],name:"StringTooLong",type:"error"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[],name:"EIP712DomainChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[],name:"DOMAIN_SEPARATOR",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"value",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"decimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[],name:"eip712Domain",outputs:[{internalType:"bytes1",name:"fields",type:"bytes1"},{internalType:"string",name:"name",type:"string"},{internalType:"string",name:"version",type:"string"},{internalType:"uint256",name:"chainId",type:"uint256"},{internalType:"address",name:"verifyingContract",type:"address"},{internalType:"bytes32",name:"salt",type:"bytes32"},{internalType:"uint256[]",name:"extensions",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"nonces",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"permit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"}],name:"transferFrom",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"}],bytecode:"0x",deployedBytecode:"0x",linkReferences:{},deployedLinkReferences:{}};var Rn=ht(require("js-sha3"));var jr=Rn.sha3_256,En=e=>/^(0x)?[0-9a-fA-F]+::\w+::\w+$/.test(e);function h(e,t){if(t===ie.solana||t===ie.fogo)return(0,G.zeroPadValue)(new me.PublicKey(e).toBytes(),32);if(t===ie.ethereum||t===ie.bsc||t===ie.polygon||t===ie.avalanche||t===ie.arbitrum||t===ie.optimism||t===ie.base||t===ie.unichain||t===ie.linea||t===ie.sonic||t===ie.hyperevm||t===ie.monad)return(0,G.zeroPadValue)(e,32);if(t===ie.aptos&&En(e))return`0x${jr(e)}`;if(t===ie.sui||t===ie.ton){let n=e.startsWith("0x")?e.substring(2):e;if(Be.Buffer.from(n,"hex").length!==32)throw new Error("Invalid address: "+e);return(0,G.zeroPadValue)(e,32)}else throw console.log(`Unsupported chain id: ${t}`,e),new Error("Unsupported token chain")}function Q(e){return new Uint8Array(Be.Buffer.from(e.startsWith("0x")?e.substring(2):e,"hex"))}function U(e,t,n=!1,r=new me.PublicKey(l.TOKEN_PROGRAM_ID),i=new me.PublicKey(l.ASSOCIATED_TOKEN_PROGRAM_ID)){if(!n&&!me.PublicKey.isOnCurve(t.toBuffer()))throw new Error("TokenOwnerOffCurveError");let[a]=me.PublicKey.findProgramAddressSync([t.toBuffer(),r.toBuffer(),e.toBuffer()],i);return a}function $r(e){return(typeof e=="string"||typeof e=="number")&&e!==""&&e!==null&&!isNaN(Number(e))&&Number.isFinite(Number(e))}function w(e,t){if(e==null)throw new Error("getAmountOfFractionalAmount: Amount is null or undefined");if(typeof e!="string"&&typeof e!="number")throw new Error("getAmountOfFractionalAmount: Amount is not a string or number");if(typeof e=="string"&&e.length===0)throw new Error("getAmountOfFractionalAmount: Amount is empty");if(!Number.isFinite(Number(e)))throw new Error("getAmountOfFractionalAmount: Amount is not a number");if(!$r(t))throw new Error("getAmountOfFractionalAmount: decimals is not a number");let n=Math.min(8,Number(t)),r=Number(e).toFixed(n+1),i=new RegExp(`^-?\\d+(?:\\.\\d{0,${n}})?`),a=r.match(i);if(!a)throw new Error("getAmountOfFractionalAmount: fixedAmount is null");let p=a[0];return(0,G.parseUnits)(p,Number(t))}function Wt(e,t){return Number((0,G.formatUnits)(e,t))}var ie={solana:1,ethereum:2,bsc:4,polygon:5,avalanche:6,arbitrum:23,optimism:24,base:30,aptos:22,sui:21,ton:13,unichain:44,linea:38,hypercore:65e3,sonic:52,hyperevm:47,fogo:51,monad:48};function _(e){let t=ie[e];if(!t)throw new Error(`Chain Id not found for chain: ${e}`);return t}var Nt={[1]:2,[56]:4,[137]:5,[43114]:6,[42161]:23,[10]:24,[8453]:30,[130]:44,[59144]:38,[146]:52,[999]:47,[143]:48};function At(e){let t=ie[e],n=Object.keys(Nt);for(let r of n)if(Nt[r]===t)return Number(r);throw new Error(`Unsupported chain: ${e}`)}function ce(e){return Nt[e]}var Xe=[12,2,5];function Ne(){return Xe.join("_")}function Ut(e){return Xe[0]<e[0]?!1:Xe[0]>e[0]?!0:Xe[1]<e[1]?!1:Xe[1]>e[1]||Xe[2]>=e[2]}function j(e){return e==="solana"||e==="sui"||e==="ton"?9:18}function Kt(e){return e==="solana"?9:8}var Jr=BigInt(2)**BigInt(64)-BigInt(1);function B(e){if(e<BigInt(0)||e>Jr)throw new Error(`Invalid u64: ${e}`);let t=Be.Buffer.alloc(8);return t.writeBigUInt64LE(e),t}var we={value:BigInt(0),deadline:0,v:0,r:`0x${me.SystemProgram.programId.toBuffer().toString("hex")}`,s:`0x${me.SystemProgram.programId.toBuffer().toString("hex")}`};function ut(e){return new Promise(t=>{setTimeout(()=>{t()},e)})}function Qe(e,t){if(!e||!t)return null;if(e.type==="WH")return t?.solana||null;if(e.type==="MCTP")return e.toChain==="solana"?t?.solana||null:e.toChain==="sui"?t?.sui||null:t?.evm||null;if(e.type==="SWIFT"){if(e.swiftVersion==="V2")return e.fromChain==="solana"||e.fromChain==="fogo"?t?.solana||null:e.fromChain==="sui"?t?.sui||null:t?.evm||null;if(e.toChain==="solana")return t?.solana||null;if(e.toChain==="sui")throw new Error("Swift V1 does not support SUI");return t?.evm||null}if(e.type==="FAST_MCTP"){if(e.toChain==="solana")return t?.solana||null;if(e.toChain!=="sui")return t?.evm||null}return e.type==="MONO_CHAIN"?e.fromChain==="solana"?t?.solana||null:e.fromChain==="sui"?t?.sui||null:t?.evm||null:null}var pt=1,ct=2,Lt=1,Gt=1,Vt=2,Ht=3,$e=1,Je=2;async function On(e,t){let n=new G.ethers.Contract(e.contract,Bt.abi,t),r,i;try{let[s,c]=await Promise.all([n.DOMAIN_SEPARATOR(),n.name()]);r=s,i=c}catch{throw{mayanError:{permitIssue:!0}}}let a={name:i,version:"1",chainId:e.chainId,verifyingContract:e.contract};for(let s=1;s<11;s++)if(a.version=String(s),G.TypedDataEncoder.hashDomain(a).toLowerCase()===r.toLowerCase())return a;let p=G.ethers.zeroPadValue(G.ethers.toBeHex(e.chainId),32),o=G.ethers.keccak256(G.ethers.toUtf8Bytes("EIP712Domain(string name,string version,address verifyingContract,bytes32 salt)"));if(e.realOriginChainId&&e.realOriginContractAddress&&e.wChainId!==e.realOriginChainId){let s=new Uint8Array(2);s[0]=e.realOriginChainId>>8&255,s[1]=e.realOriginChainId&255;let c=new Uint8Array(2+32);c.set(s,0),c.set(G.ethers.getBytes(G.ethers.zeroPadValue(e.realOriginContractAddress,32)),2);let u=G.ethers.keccak256(c),d=G.ethers.keccak256(G.ethers.toUtf8Bytes("EIP712Domain(string name,string version,uint256 chainId,address verifyingContract,bytes32 salt)"));for(let f=0;f<11;f++)if(G.ethers.keccak256(new G.ethers.AbiCoder().encode(["bytes32","bytes32","bytes32","uint256","address","bytes32"],[d,G.ethers.keccak256(G.ethers.toUtf8Bytes(i)),G.ethers.keccak256(G.ethers.toUtf8Bytes(String(f))),e.chainId,e.contract,u])).toLowerCase()===r.toLowerCase())return a.version=String(f),a.salt=u,a}for(let s=0;s<11;s++)if(G.ethers.keccak256(new G.ethers.AbiCoder().encode(["bytes32","bytes32","bytes32","address","bytes32"],[o,G.ethers.keccak256(G.ethers.toUtf8Bytes(i)),G.ethers.keccak256(G.ethers.toUtf8Bytes(String(s))),e.contract,p])).toLowerCase()===r.toLowerCase())return delete a.chainId,a.version=String(s),a.salt=p,a;throw{mayanError:{permitIssue:!0}}}var Fn={Permit:[{name:"owner",type:"address"},{name:"spender",type:"address"},{name:"value",type:"uint256"},{name:"nonce",type:"uint256"},{name:"deadline",type:"uint256"}]};async function Dn(e,t,n,r,i,a){if(e.standard!=="erc20"&&e.standard!=="hypertoken")throw new Error("Token is not ERC20");if(!e.supportsPermit)throw new Error("Token does not support permit");let p=new G.ethers.Contract(e.contract,Bt.abi,i),[o,s]=await Promise.all([On(e,i),p.nonces(t)]);return{domain:o,types:Fn,value:{owner:t,spender:n,nonce:String(s),value:String(r),deadline:String(a)}}}async function zr(e,t,n){if(!e.hyperCoreParams)throw new Error("Quote does not have hyperCoreParams");if(e.toChain!=="hypercore")throw new Error("Quote toChain is not hypercore");if(e.toToken.contract.toLowerCase()!==l.ARBITRUM_USDC_CONTRACT.toLowerCase())throw new Error("Quote toToken is not USDC on Arbitrum");let r={name:"USDC",standard:"erc20",symbol:"USDC",mint:"CR4xnGrhsu1fWNPoX4KbTUUtqGMF3mzRLfj4S6YEs1Yo",verified:!0,contract:"0xaf88d065e77c8cc2239327c5edb3a432268e5831",chainId:42161,wChainId:23,decimals:6,logoURI:"http://assets.coingecko.com/coins/images/6319/small/usdc.png?1696506694",coingeckoId:"usd-coin",realOriginContractAddress:"0xaf88d065e77c8cc2239327c5edb3a432268e5831",realOriginChainId:23,supportsPermit:!0,verifiedAddress:"0xaf88d065e77c8cc2239327c5edb3a432268e5831"},[i,a]=await Promise.all([Dn(r,t,l.HC_ARBITRUM_BRIDGE,BigInt(e.hyperCoreParams.depositAmountUSDC64),n,BigInt(e.deadline64)),Qt(t,e.toToken.contract)]);if(!a)throw new Error("Because of concurrency, deposit is not possible at the moment, please try again later");return i}function lt(e,t,n){let r=Be.Buffer.alloc(109),i=Be.Buffer.from(Q(t));if(i.length!==20)throw new Error("Invalid destination address length, expected 20 bytes");let a=Be.Buffer.from(Q(n));if(a.length!==65)throw new Error("Invalid USDC permit signature length, expected 65 bytes");if(!e.redeemRelayerFee64||!e.hyperCoreParams)throw new Error("Invalid quote for HyperCore USDC deposit custom payload");return r.writeBigUInt64BE(BigInt(e.redeemRelayerFee64),0),r.set(i,8),r.writeBigUInt64BE(BigInt(e.hyperCoreParams.depositAmountUSDC64),28),r.writeBigUInt64BE(BigInt(e.deadline64),36),r.set(a,44),r}function qe(e){if(e.toChain==="sui"){if(!e.toToken.verifiedAddress)throw new Error("To token verified address is required for SUI");return h(e.toToken.verifiedAddress,_("sui"))}else if(e.toChain==="ton"){if(e.toToken.contract===G.ZeroAddress)return h(me.SystemProgram.programId.toString(),_("solana"));if(!e.toToken.verifiedAddress)throw new Error("To token verified address is required for Ton chain");return e.toToken.verifiedAddress}else return e.toToken.contract===G.ZeroAddress?h(me.SystemProgram.programId.toString(),_("solana")):h(e.toToken.contract,_(e.toChain))}function We(e,t){if(e==="ton"){if(t!=="SWIFT")throw new Error("Unsupported quote type for Tonchain destination");return 1/0}return 8}function dt(e){try{let t=Be.Buffer.from(e.quoteId.startsWith("0x")?e.quoteId.substring(2):e.quoteId,"hex");if(t.length<32){let n=me.Keypair.generate().publicKey.toBytes();return Be.Buffer.concat([t,n.slice(0,32-t.length)])}return t.subarray(0,32)}catch{}return me.Keypair.generate().publicKey.toBuffer()}function mt(e){return Object.entries(e).filter(([t,n])=>n!=null&&!Array.isArray(n)).map(([t,n])=>`${encodeURIComponent(t)}=${encodeURIComponent(n)}`).join("&")}async function Ie(e){if(e.status.toString().startsWith("5")){let t=new Error("Internal server error");try{let n=await e.json();(n?.code||n?.statusCode)&&(n?.message||n?.msg)&&(t={code:n?.code||n?.statusCode,message:n?.message||n?.msg})}catch{t=new Error("Internal server error")}throw t}}async function Zr(e){let t=e?`?standard=${e.join(",")}`:"",n=await(0,ye.default)(`${l.PRICE_URL}/tokens${t}`,{method:"GET",redirect:"follow"});if(await Ie(n),n.status===200)return await n.json();throw new Error("Cannot fetch Mayan tokens!")}async function Xr(e,t=!1,n){let r={chain:e,nonPortal:t,standard:n?n?.join(","):void 0},i=await(0,ye.default)(`${l.PRICE_URL}/tokens?${mt(r)}`);if(await Ie(i),i.status===200)return(await i.json())[e];throw new Error("Cannot fetch Mayan tokens!")}function vn(e,t={wormhole:!0,swift:!0,mctp:!0,shuttle:!0,gasless:!1,onlyDirect:!1,fastMctp:!0,fullList:!1,payload:void 0,monoChain:!0}){let{gasDrop:n,referrerBps:r}=e,i=e.slippageBps;if(i!=="auto"&&!Number.isFinite(i)){if(e.slippage===void 0||e.slippage===null||!Number.isFinite(e.slippage))throw new Error("Either slippageBps or slippage must be provided");i=e.slippage*100}let p={...{wormhole:t.wormhole!==!1,swift:t.swift!==!1,mctp:t.mctp!==!1,shuttle:t.shuttle===!0,fastMctp:t.fastMctp!==!1,gasless:t.gasless===!0,onlyDirect:t.onlyDirect===!0,fullList:t.fullList===!0,payload:typeof t.payload=="string"?t.payload:void 0,monoChain:t.monoChain!==!1},solanaProgram:l.MAYAN_PROGRAM_ID,forwarderAddress:l.MAYAN_FORWARDER_CONTRACT,amountIn:!e.amountIn64&&Number.isFinite(e.amount)?e.amount:void 0,amountIn64:e.amountIn64,fromToken:e.fromToken,fromChain:e.fromChain,toToken:e.toToken,toChain:e.toChain,slippageBps:i,referrer:e.referrer,referrerBps:Number.isFinite(r)?r:void 0,gasDrop:Number.isFinite(n)?n:void 0,destinationAddress:e.destinationAddress??void 0,sdkVersion:Ne()},o=`${l.PRICE_URL}/quote?`,s=mt(p);return o+s}async function qr(e,t={swift:!0,mctp:!0,gasless:!1,onlyDirect:!1}){let n=vn(e,t),r=await(0,ye.default)(n,{method:"GET",redirect:"follow"});await Ie(r);let i=await r.json();if(r.status!==200&&r.status!==201)throw{code:i?.code||0,message:i?.msg||i?.message||"Route not found",data:i?.data};if(!Ut(i.minimumSdkVersion))throw{code:9999,message:"Swap SDK is outdated!"};return i.quotes}async function ea(e){let t=await(0,ye.default)(`${l.PRICE_URL}/clock/${e}`,{method:"GET",redirect:"follow"});await Ie(t);let n=await t.json();if(t.status!==200&&t.status!==201)throw n;return n.clock}async function Yt(){let e=await(0,ye.default)(`${l.RELAYER_URL}/active-relayers?solanaProgram=${l.MAYAN_PROGRAM_ID}`,{method:"GET",redirect:"follow"});await Ie(e);let t=await e.json();if(e.status!==200&&e.status!==201)throw t;return t.suggested}async function ke(e){let t=mt({...e,sdkVersion:Ne()}),n=await(0,ye.default)(`${l.PRICE_URL}/get-swap/solana?${t}`,{method:"GET",redirect:"follow"});await Ie(n);let r=await n.json();if(n.status!==200&&n.status!==201)throw r;return r}async function ze(e){let t=JSON.stringify({...e,sdkVersion:Ne()}),n=`${l.PRICE_URL}/get-swap/sui`,r=await(0,ye.default)(n,{method:"POST",redirect:"follow",body:t,headers:{"Content-Type":"application/json"}});await Ie(r);let i=await r.json();if(r.status!==200&&r.status!==201)throw i;return i}async function Ue(e){let t=mt({...e,sdkVersion:Ne()}),n=await(0,ye.default)(`${l.PRICE_URL}/get-swap/evm?${t}`,{method:"GET",redirect:"follow"});await Ie(n);let r=await n.json();if(n.status!==200&&n.status!==201)throw r;return r}async function jt(e,t){let n=await(0,ye.default)(`${l.EXPLORER_URL}/submit/evm`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,signature:t},(r,i)=>typeof i=="bigint"?i.toString():i)});await Ie(n)}async function $t(e,t){let n=await(0,ye.default)(`${l.EXPLORER_URL}/submit/v2/svm`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({signedTx:e,chainName:t})});await Ie(n);let r=await n.json();if(n.status!==200&&n.status!==201)throw r;return r}async function Qt(e,t){let n=mt({destWallet:e,destToken:t,sdkVersion:Ne()}),r=await(0,ye.default)(`${l.EXPLORER_URL}/hypercore/is-allowed?${n}`,{method:"GET",redirect:"follow"});await Ie(r);let i=await r.json();if(r.status!==200&&r.status!==201)throw i;return i.allowed===!0}async function Jt(e){let t=await(0,ye.default)(`${l.GAS_ESTIMATE_URL}/evm`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,sdkVersion:Ne()})});await Ie(t);let n=await t.json();if(t.status!==200&&t.status!==201)throw n;return{estimatedGas:BigInt(n.estimatedGas),gasPrice:BigInt(n.gasPrice)}}async function zt(e,t){let n=await(0,ye.default)(`${l.SWIFT_RELAYER_URL}/nonces/assign`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chainName:e,swapperAddress:t,sdkVersion:Ne()})});await Ie(n);let r=await n.json();if(n.status!==200&&n.status!==201)throw r;return r}var Ve=require("ethers"),it=require("@solana/web3.js");var xn={_format:"hh-sol-artifact-1",contractName:"MayanSwap",sourceName:"src/MayanSwap.sol",abi:[{inputs:[{internalType:"address",name:"_tokenBridge",type:"address"},{internalType:"address",name:"_weth",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint16",name:"emitterChainId",type:"uint16"},{indexed:!0,internalType:"bytes32",name:"emitterAddress",type:"bytes32"},{indexed:!0,internalType:"uint64",name:"sequence",type:"uint64"}],name:"Redeemed",type:"event"},{inputs:[{internalType:"address",name:"newGuardian",type:"address"}],name:"changeGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"uint8",name:"payloadId",type:"uint8"},{internalType:"bytes32",name:"tokenAddr",type:"bytes32"},{internalType:"uint16",name:"tokenChainId",type:"uint16"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"sourceAddr",type:"bytes32"},{internalType:"uint16",name:"sourceChainId",type:"uint16"},{internalType:"uint64",name:"sequence",type:"uint64"},{internalType:"uint64",name:"amountOutMin",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"uint64",name:"swapFee",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"bytes32",name:"auctionAddr",type:"bytes32"},{internalType:"bool",name:"unwrapRedeem",type:"bool"},{internalType:"bool",name:"unwrapRefund",type:"bool"}],internalType:"struct MayanStructs.Swap",name:"s",type:"tuple"}],name:"encodeSwap",outputs:[{internalType:"bytes",name:"encoded",type:"bytes"}],stateMutability:"pure",type:"function"},{inputs:[],name:"getWeth",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"isPaused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"encoded",type:"bytes"}],name:"parseRedeemPayload",outputs:[{components:[{internalType:"uint8",name:"payloadId",type:"uint8"},{internalType:"bytes32",name:"recipient",type:"bytes32"},{internalType:"uint64",name:"relayerFee",type:"uint64"},{internalType:"bool",name:"unwrap",type:"bool"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes",name:"customPayload",type:"bytes"}],internalType:"struct MayanStructs.Redeem",name:"r",type:"tuple"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"redeem",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"redeemAndUnwrap",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_pause",type:"bool"}],name:"setPause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"uint64",name:"swapFee",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"}],internalType:"struct MayanSwap.RelayerFees",name:"relayerFees",type:"tuple"},{components:[{internalType:"bytes32",name:"mayanAddr",type:"bytes32"},{internalType:"uint16",name:"mayanChainId",type:"uint16"},{internalType:"bytes32",name:"auctionAddr",type:"bytes32"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrer",type:"bytes32"},{internalType:"bytes32",name:"refundAddr",type:"bytes32"}],internalType:"struct MayanSwap.Recepient",name:"recipient",type:"tuple"},{internalType:"bytes32",name:"tokenOutAddr",type:"bytes32"},{internalType:"uint16",name:"tokenOutChainId",type:"uint16"},{components:[{internalType:"uint256",name:"transferDeadline",type:"uint256"},{internalType:"uint64",name:"swapDeadline",type:"uint64"},{internalType:"uint64",name:"amountOutMin",type:"uint64"},{internalType:"bool",name:"unwrap",type:"bool"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes",name:"customPayload",type:"bytes"}],internalType:"struct MayanSwap.Criteria",name:"criteria",type:"tuple"},{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"}],name:"swap",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address payable",name:"to",type:"address"}],name:"sweepEth",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address",name:"to",type:"address"}],name:"sweepToken",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"uint64",name:"swapFee",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"}],internalType:"struct MayanSwap.RelayerFees",name:"relayerFees",type:"tuple"},{components:[{internalType:"bytes32",name:"mayanAddr",type:"bytes32"},{internalType:"uint16",name:"mayanChainId",type:"uint16"},{internalType:"bytes32",name:"auctionAddr",type:"bytes32"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrer",type:"bytes32"},{internalType:"bytes32",name:"refundAddr",type:"bytes32"}],internalType:"struct MayanSwap.Recepient",name:"recipient",type:"tuple"},{internalType:"bytes32",name:"tokenOutAddr",type:"bytes32"},{internalType:"uint16",name:"tokenOutChainId",type:"uint16"},{components:[{internalType:"uint256",name:"transferDeadline",type:"uint256"},{internalType:"uint64",name:"swapDeadline",type:"uint64"},{internalType:"uint64",name:"amountOutMin",type:"uint64"},{internalType:"bool",name:"unwrap",type:"bool"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes",name:"customPayload",type:"bytes"}],internalType:"struct MayanSwap.Criteria",name:"criteria",type:"tuple"}],name:"wrapAndSwapETH",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{stateMutability:"payable",type:"receive"}]};var Ae={_format:"hh-sol-artifact-1",contractName:"MayanForwarder",sourceName:"src/MayanForwarder.sol",abi:[{inputs:[{internalType:"address",name:"_guardian",type:"address"},{internalType:"address[]",name:"_swapProtocols",type:"address[]"},{internalType:"address[]",name:"_mayanProtocols",type:"address[]"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"UnsupportedProtocol",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"},{indexed:!1,internalType:"address",name:"mayanProtocol",type:"address"},{indexed:!1,internalType:"bytes",name:"protocolData",type:"bytes"}],name:"ForwardedERC20",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"mayanProtocol",type:"address"},{indexed:!1,internalType:"bytes",name:"protocolData",type:"bytes"}],name:"ForwardedEth",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"SwapAndForwarded",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"tokenIn",type:"address"},{indexed:!1,internalType:"uint256",name:"amountIn",type:"uint256"},{indexed:!1,internalType:"address",name:"swapProtocol",type:"address"},{indexed:!1,internalType:"address",name:"middleToken",type:"address"},{indexed:!1,internalType:"uint256",name:"middleAmount",type:"uint256"},{indexed:!1,internalType:"address",name:"mayanProtocol",type:"address"},{indexed:!1,internalType:"bytes",name:"mayanData",type:"bytes"}],name:"SwapAndForwardedERC20",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"amountIn",type:"uint256"},{indexed:!1,internalType:"address",name:"swapProtocol",type:"address"},{indexed:!1,internalType:"address",name:"middleToken",type:"address"},{indexed:!1,internalType:"uint256",name:"middleAmount",type:"uint256"},{indexed:!1,internalType:"address",name:"mayanProtocol",type:"address"},{indexed:!1,internalType:"bytes",name:"mayanData",type:"bytes"}],name:"SwapAndForwardedEth",type:"event"},{inputs:[{internalType:"address",name:"newGuardian",type:"address"}],name:"changeGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{components:[{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],internalType:"struct MayanForwarder.PermitParams",name:"permitParams",type:"tuple"},{internalType:"address",name:"mayanProtocol",type:"address"},{internalType:"bytes",name:"protocolData",type:"bytes"}],name:"forwardERC20",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"mayanProtocol",type:"address"},{internalType:"bytes",name:"protocolData",type:"bytes"}],name:"forwardEth",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"guardian",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"mayanProtocols",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"nextGuardian",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address payable",name:"to",type:"address"}],name:"rescueEth",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address",name:"to",type:"address"}],name:"rescueToken",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"mayanProtocol",type:"address"},{internalType:"bool",name:"enabled",type:"bool"}],name:"setMayanProtocol",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"swapProtocol",type:"address"},{internalType:"bool",name:"enabled",type:"bool"}],name:"setSwapProtocol",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{components:[{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],internalType:"struct MayanForwarder.PermitParams",name:"permitParams",type:"tuple"},{internalType:"address",name:"swapProtocol",type:"address"},{internalType:"bytes",name:"swapData",type:"bytes"},{internalType:"address",name:"middleToken",type:"address"},{internalType:"uint256",name:"minMiddleAmount",type:"uint256"},{internalType:"address",name:"mayanProtocol",type:"address"},{internalType:"bytes",name:"mayanData",type:"bytes"}],name:"swapAndForwardERC20",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"address",name:"swapProtocol",type:"address"},{internalType:"bytes",name:"swapData",type:"bytes"},{internalType:"address",name:"middleToken",type:"address"},{internalType:"uint256",name:"minMiddleAmount",type:"uint256"},{internalType:"address",name:"mayanProtocol",type:"address"},{internalType:"bytes",name:"mayanData",type:"bytes"}],name:"swapAndForwardEth",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"swapProtocols",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"}],linkReferences:{},deployedLinkReferences:{}};var Cn=require("buffer");var ne=require("ethers"),qt=require("@solana/web3.js");var Zt={_format:"hh-sol-artifact-1",contractName:"MayanCircle",sourceName:"src/MayanCircle.sol",abi:[{inputs:[{internalType:"address",name:"_cctpTokenMessenger",type:"address"},{internalType:"address",name:"_wormhole",type:"address"},{internalType:"address",name:"_feeManager",type:"address"},{internalType:"uint16",name:"_auctionChainId",type:"uint16"},{internalType:"bytes32",name:"_auctionAddr",type:"bytes32"},{internalType:"uint8",name:"_consistencyLevel",type:"uint8"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"CallerAlreadySet",type:"error"},{inputs:[],name:"CallerNotSet",type:"error"},{inputs:[],name:"CctpReceiveFailed",type:"error"},{inputs:[],name:"DeadlineViolation",type:"error"},{inputs:[],name:"DomainAlreadySet",type:"error"},{inputs:[],name:"DomainNotSet",type:"error"},{inputs:[],name:"EmitterAlreadySet",type:"error"},{inputs:[],name:"EthTransferFailed",type:"error"},{inputs:[],name:"InvalidAction",type:"error"},{inputs:[],name:"InvalidAddress",type:"error"},{inputs:[],name:"InvalidAmountOut",type:"error"},{inputs:[],name:"InvalidCaller",type:"error"},{inputs:[],name:"InvalidDestAddr",type:"error"},{inputs:[],name:"InvalidDomain",type:"error"},{inputs:[],name:"InvalidEmitter",type:"error"},{inputs:[],name:"InvalidGasDrop",type:"error"},{inputs:[],name:"InvalidMintRecipient",type:"error"},{inputs:[],name:"InvalidNonce",type:"error"},{inputs:[],name:"InvalidOrder",type:"error"},{inputs:[],name:"InvalidPayload",type:"error"},{inputs:[],name:"InvalidProtocolFee",type:"error"},{inputs:[],name:"InvalidRedeemFee",type:"error"},{inputs:[],name:"InvalidReferrerFee",type:"error"},{inputs:[],name:"MintRecipientAlreadySet",type:"error"},{inputs:[],name:"MintRecipientNotSet",type:"error"},{inputs:[],name:"Paused",type:"error"},{inputs:[],name:"Unauthorized",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint32",name:"sourceDomain",type:"uint32"},{indexed:!1,internalType:"uint64",name:"sourceNonce",type:"uint64"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"OrderFulfilled",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint32",name:"sourceDomain",type:"uint32"},{indexed:!1,internalType:"uint64",name:"sourceNonce",type:"uint64"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"OrderRefunded",type:"event"},{inputs:[],name:"auctionAddr",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"auctionChainId",outputs:[{internalType:"uint16",name:"",type:"uint16"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint32",name:"destDomain",type:"uint32"},{internalType:"uint8",name:"payloadType",type:"uint8"},{internalType:"bytes",name:"customPayload",type:"bytes"}],name:"bridgeWithFee",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint256",name:"redeemFee",type:"uint256"},{internalType:"uint32",name:"destDomain",type:"uint32"},{internalType:"bytes32",name:"destAddr",type:"bytes32"}],name:"bridgeWithLockedFee",outputs:[{internalType:"uint64",name:"cctpNonce",type:"uint64"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"cctpTokenMessenger",outputs:[{internalType:"contract ITokenMessenger",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint16",name:"",type:"uint16"}],name:"chainIdToEmitter",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"newGuardian",type:"address"}],name:"changeGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"consistencyLevel",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{components:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChain",type:"uint16"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"}],internalType:"struct MayanCircle.OrderParams",name:"params",type:"tuple"}],name:"createOrder",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint32",name:"",type:"uint32"}],name:"domainToCaller",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"feeManager",outputs:[{internalType:"contract IFeeManager",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint64",name:"",type:"uint64"}],name:"feeStorage",outputs:[{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"redeemFee",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"cctpMsg",type:"bytes"},{internalType:"bytes",name:"cctpSigs",type:"bytes"},{internalType:"bytes",name:"encodedVm",type:"bytes"},{components:[{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"promisedAmount",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"protocolBps",type:"uint8"},{internalType:"bytes32",name:"driver",type:"bytes32"}],internalType:"struct MayanCircle.FulfillParams",name:"params",type:"tuple"},{internalType:"address",name:"swapProtocol",type:"address"},{internalType:"bytes",name:"swapData",type:"bytes"}],name:"fulfillOrder",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint16",name:"chainId",type:"uint16"}],name:"getDomain",outputs:[{internalType:"uint32",name:"domain",type:"uint32"}],stateMutability:"view",type:"function"},{inputs:[],name:"guardian",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"isPaused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"}],name:"keyToMintRecipient",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"localDomain",outputs:[{internalType:"uint32",name:"",type:"uint32"}],stateMutability:"view",type:"function"},{inputs:[],name:"paused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"cctpMsg",type:"bytes"},{internalType:"bytes",name:"cctpSigs",type:"bytes"},{internalType:"bytes",name:"encodedVm",type:"bytes"},{components:[{internalType:"uint8",name:"payloadType",type:"uint8"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"burnAmount",type:"uint64"},{internalType:"bytes32",name:"burnToken",type:"bytes32"},{internalType:"bytes32",name:"customPayload",type:"bytes32"}],internalType:"struct MayanCircle.BridgeWithFeeParams",name:"bridgeParams",type:"tuple"}],name:"redeemWithFee",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"cctpMsg",type:"bytes"},{internalType:"bytes",name:"cctpSigs",type:"bytes"},{internalType:"bytes32",name:"unlockerAddr",type:"bytes32"}],name:"redeemWithLockedFee",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint32",name:"cctpNonce",type:"uint32"},{internalType:"uint32",name:"cctpDomain",type:"uint32"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"bytes32",name:"unlockerAddr",type:"bytes32"}],name:"refineFee",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"},{internalType:"bytes",name:"cctpMsg",type:"bytes"},{internalType:"bytes",name:"cctpSigs",type:"bytes"},{components:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChain",type:"uint16"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"}],internalType:"struct MayanCircle.OrderParams",name:"orderParams",type:"tuple"},{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"uint16",name:"sourceChainId",type:"uint16"},{internalType:"uint8",name:"protocolBps",type:"uint8"}],internalType:"struct MayanCircle.ExtraParams",name:"extraParams",type:"tuple"}],name:"refund",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address payable",name:"to",type:"address"}],name:"rescueEth",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address",name:"to",type:"address"}],name:"rescueToken",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint8",name:"_consistencyLevel",type:"uint8"}],name:"setConsistencyLevel",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint16",name:"chainId",type:"uint16"},{internalType:"uint32",name:"domain",type:"uint32"}],name:"setDomain",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint32",name:"domain",type:"uint32"},{internalType:"bytes32",name:"caller",type:"bytes32"}],name:"setDomainCaller",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint16",name:"chainId",type:"uint16"},{internalType:"bytes32",name:"emitter",type:"bytes32"}],name:"setEmitter",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_feeManager",type:"address"}],name:"setFeeManager",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint32",name:"destDomain",type:"uint32"},{internalType:"address",name:"tokenIn",type:"address"},{internalType:"bytes32",name:"mintRecipient",type:"bytes32"}],name:"setMintRecipient",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_pause",type:"bool"}],name:"setPause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"},{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"uint8",name:"payloadType",type:"uint8"},{internalType:"uint64",name:"cctpNonce",type:"uint64"},{internalType:"uint32",name:"cctpDomain",type:"uint32"},{internalType:"bytes32",name:"unlockerAddr",type:"bytes32"},{internalType:"uint64",name:"gasDrop",type:"uint64"}],internalType:"struct MayanCircle.UnlockFeeMsg",name:"unlockMsg",type:"tuple"}],name:"unlockFee",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm1",type:"bytes"},{internalType:"bytes",name:"encodedVm2",type:"bytes"},{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"uint8",name:"payloadType",type:"uint8"},{internalType:"uint64",name:"cctpNonce",type:"uint64"},{internalType:"uint32",name:"cctpDomain",type:"uint32"},{internalType:"bytes32",name:"unlockerAddr",type:"bytes32"},{internalType:"uint64",name:"gasDrop",type:"uint64"}],internalType:"struct MayanCircle.UnlockFeeMsg",name:"unlockMsg",type:"tuple"},{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"uint8",name:"payloadType",type:"uint8"},{internalType:"uint64",name:"cctpNonce",type:"uint64"},{internalType:"uint32",name:"cctpDomain",type:"uint32"},{internalType:"bytes32",name:"unlockerAddr",type:"bytes32"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"}],internalType:"struct MayanCircle.UnlockRefinedFeeMsg",name:"refinedMsg",type:"tuple"}],name:"unlockFeeRefined",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"wormhole",outputs:[{internalType:"contract IWormhole",name:"",type:"address"}],stateMutability:"view",type:"function"},{stateMutability:"payable",type:"receive"}],linkReferences:{},deployedLinkReferences:{}};var Wn=require("buffer");var X=require("@solana/web3.js");var ee=require("buffer"),$=6;function fe(e){switch(e){case"ethereum":return 0;case"avalanche":return 1;case"optimism":return 2;case"arbitrum":return 3;case"solana":return 5;case"base":return 6;case"polygon":return 7;case"sui":return 8;case"unichain":return 10;case"linea":return 11;case"sonic":return 13;case"hyperevm":return 19;case"monad":return 15;default:throw new Error("unsupported chain for cctp")}}function Ct(e,t){let n=new X.PublicKey(l.CCTP_CORE_PROGRAM_ID),r=new X.PublicKey(l.CCTP_TOKEN_PROGRAM_ID),[i]=X.PublicKey.findProgramAddressSync([ee.Buffer.from("message_transmitter")],n),[a]=X.PublicKey.findProgramAddressSync([ee.Buffer.from("sender_authority")],r),[p]=X.PublicKey.findProgramAddressSync([ee.Buffer.from("local_token"),e.toBytes()],r),[o]=X.PublicKey.findProgramAddressSync([ee.Buffer.from("token_messenger")],r),[s]=X.PublicKey.findProgramAddressSync([ee.Buffer.from("token_minter")],r),c=fe(t),[u]=X.PublicKey.findProgramAddressSync([ee.Buffer.from("remote_token_messenger"),ee.Buffer.from(c.toString())],r),[d]=X.PublicKey.findProgramAddressSync([ee.Buffer.from("__event_authority")],n),[f]=X.PublicKey.findProgramAddressSync([ee.Buffer.from("__event_authority")],r);return{messageTransmitter:i,senderAuthority:a,remoteTokenMessengerKey:u,tokenMessenger:o,tokenMinter:s,eventAuthToken:f,eventAuthCore:d,localToken:p}}function Xt(e,t,n,r){let i=new X.PublicKey(l.CCTPV2_CORE_PROGRAM_ID),a=new X.PublicKey(l.CCTPV2_TOKEN_PROGRAM_ID),[p]=X.PublicKey.findProgramAddressSync([ee.Buffer.from("message_transmitter")],i),[o]=X.PublicKey.findProgramAddressSync([ee.Buffer.from("sender_authority")],a),[s]=X.PublicKey.findProgramAddressSync([ee.Buffer.from("local_token"),e.toBytes()],a),[c]=X.PublicKey.findProgramAddressSync([ee.Buffer.from("token_messenger")],a),[u]=X.PublicKey.findProgramAddressSync([ee.Buffer.from("token_minter")],a),d=fe(t),[f]=X.PublicKey.findProgramAddressSync([ee.Buffer.from("remote_token_messenger"),ee.Buffer.from(d.toString())],a),[m]=X.PublicKey.findProgramAddressSync([ee.Buffer.from("__event_authority")],i),[y]=X.PublicKey.findProgramAddressSync([ee.Buffer.from("__event_authority")],a),[b]=X.PublicKey.findProgramAddressSync([ee.Buffer.from("denylist_account"),n.toBytes()],a),[g]=X.PublicKey.findProgramAddressSync([ee.Buffer.from("denylist_account"),r.toBytes()],a);return{messageTransmitter:p,senderAuthority:o,remoteTokenMessengerKey:f,tokenMessenger:c,tokenMinter:u,eventAuthToken:y,eventAuthCore:m,localToken:s,cctpDenyListAccount:b,realDenyListAccount:g}}function ta(e,t,n,r){let i=ce(Number(n)),a=_(e.fromChain),p=_(e.toChain);if(a!==i)throw new Error(`Signer chain id(${Number(n)}) and quote from chain are not same! ${a} !== ${i}`);let o=e.cheaperChain===e.fromChain;if(o&&r)throw new Error("Bridge lock fee cannot have custom payload");let s=h(t,p),c=w(e.redeemRelayerFee,$),u=w(e.gasDrop,Math.min(j(e.toChain),8)),d=BigInt(e.effectiveAmountIn64),f=fe(e.toChain);if(!e.mctpMayanContract)throw new Error("MCTP contract address is missing");let m=e.mctpMayanContract;if(e.toChain==="solana"&&o)throw new Error("Cannot lock fee for transfer to solana");let y=w(e.bridgeFee,j(e.fromChain));return o&&(y=BigInt(0)),{lockFee:o,tokenIn:e.mctpInputContract,amountIn:d,redeemFee:c,gasDrop:u,destAddr:s,destDomain:f,payloadType:r?ct:pt,customPayload:r?`0x${Wn.Buffer.from(r).toString("hex")}`:"0x",bridgeFee:y,contractAddress:m}}function Bn(e,t,n,r){let i=ta(e,t,n,r),{contractAddress:a,tokenIn:p,amountIn:o,destAddr:s,lockFee:c,redeemFee:u,gasDrop:d,destDomain:f,customPayload:m,payloadType:y,bridgeFee:b}=i,g=new ne.Contract(a,Zt.abi),T,I;return c?T=g.interface.encodeFunctionData("bridgeWithLockedFee",[p,o,d,u,f,s]):T=g.interface.encodeFunctionData("bridgeWithFee",[p,o,u,d,s,f,y,m]),I=(0,ne.toBeHex)(b),{to:a,data:T,value:I,_params:i}}function na(e,t,n,r){let i=ce(Number(r)),a=_(e.fromChain),p=_(e.toChain);if(a!==i)throw new Error(`Signer chain id(${Number(r)}) and quote from chain are not same! ${a} !== ${i}`);if(!e.mctpMayanContract)throw new Error("MCTP contract address is missing");let o=e.mctpMayanContract,s=h(t,p),c;n?c=h(n,p):c=h(qt.SystemProgram.programId.toString(),_("solana"));let u=w(e.redeemRelayerFee,$),d=w(e.gasDrop,Math.min(j(e.toChain),8)),f=BigInt(e.effectiveAmountIn64),m=w(e.minAmountOut,Math.min(8,e.toToken.decimals)),y=BigInt(e.deadline64);if(e.toChain==="sui"&&!e.toToken.verifiedAddress)throw new Error("To token verified address is missing for SUI");let b=e.toToken.contract===ne.ZeroAddress?h(qt.SystemProgram.programId.toString(),_("solana")):h(e.toChain==="sui"?e.toToken.verifiedAddress:e.toToken.contract,e.toToken.wChainId);return{params:{tokenIn:e.mctpInputContract,amountIn:f,gasDrop:d,destAddr:s,destChain:p,tokenOut:b,minAmountOut:m,deadline:y,redeemFee:u,referrerAddr:c,referrerBps:e.referrerBps||0},bridgeFee:w(e.bridgeFee,j(e.fromChain)),contractAddress:o}}function Nn(e,t,n,r){let i=na(e,t,n,r),{contractAddress:a,params:p,bridgeFee:o}=i,c=new ne.Contract(a,Zt.abi).interface.encodeFunctionData("createOrder",[p]),u=(0,ne.toBeHex)(o);return{to:a,data:c,value:u,_params:i}}async function en(e,t,n,r,i,a){if(e.type!=="MCTP")throw new Error("Quote type is not MCTP");if(!Number.isFinite(Number(r)))throw new Error("Invalid signer chain id");r=Number(r);let p=i||we,o=new ne.Contract(l.MAYAN_FORWARDER_CONTRACT,Ae.abi),s=w(e.bridgeFee,j(e.fromChain)),c=(0,ne.toBeHex)(s);if(e.fromToken.contract===e.mctpInputContract)if(e.hasAuction){if(!Number(e.deadline64))throw new Error("MCTP order requires timeout");let u=Nn(e,t,n,r),d="forwardERC20",f=[e.fromToken.contract,u._params.params.amountIn,p,u._params.contractAddress,u.data];return{data:o.interface.encodeFunctionData(d,f),to:l.MAYAN_FORWARDER_CONTRACT,value:(0,ne.toBeHex)(c),chainId:r,_forwarder:{method:d,params:f}}}else{let u=Bn(e,t,r,a),d="forwardERC20",f=[e.fromToken.contract,u._params.amountIn,p,u._params.contractAddress,u.data];return{data:o.interface.encodeFunctionData(d,f),to:l.MAYAN_FORWARDER_CONTRACT,value:(0,ne.toBeHex)(c),chainId:r,_forwarder:{method:d,params:f}}}else{let{minMiddleAmount:u}=e,{swapRouterCalldata:d,swapRouterAddress:f}=await Ue({referrerAddress:n||void 0,fromToken:e.fromToken.contract,slippageBps:e.slippageBps,forwarderAddress:l.MAYAN_FORWARDER_CONTRACT,amountIn64:e.effectiveAmountIn64,chainName:e.fromChain,middleToken:e.mctpInputContract});if(!u)throw new Error("MCTP swap requires middle amount, router address and calldata");if(e.hasAuction){if(!Number(e.deadline64))throw new Error("MCTP order requires timeout");let m=Nn(e,t,n,r);if(!e.minMiddleAmount)throw new Error("MCTP swap requires middle amount");let y=w(e.minMiddleAmount,$);if(e.fromToken.contract===ne.ZeroAddress){let b=m._params.params.amountIn;if(b<=s)throw new Error("Amount in is less than bridge fee");s!==BigInt(0)&&(b-=s),c=(0,ne.toBeHex)(m._params.params.amountIn);let g="swapAndForwardEth",T=[b,f,d,e.mctpInputContract,y,m._params.contractAddress,m.data];return{data:o.interface.encodeFunctionData(g,T),to:l.MAYAN_FORWARDER_CONTRACT,value:(0,ne.toBeHex)(c),chainId:r,_forwarder:{method:g,params:T}}}else{let b="swapAndForwardERC20",g=[e.fromToken.contract,m._params.params.amountIn,p,f,d,e.mctpInputContract,y,m._params.contractAddress,m.data];return{data:o.interface.encodeFunctionData(b,g),to:l.MAYAN_FORWARDER_CONTRACT,value:(0,ne.toBeHex)(c),chainId:r,_forwarder:{method:b,params:g}}}}else{let m=Bn(e,t,r,a);if(!e.minMiddleAmount)throw new Error("MCTP swap requires middle amount");let y=w(e.minMiddleAmount,$);if(e.fromToken.contract===ne.ZeroAddress){let b=m._params.amountIn;if(b<=s)throw new Error("Amount in is less than bridge fee");s!==BigInt(0)&&(b-=s),c=(0,ne.toBeHex)(m._params.amountIn);let g="swapAndForwardEth",T=[b,f,d,e.mctpInputContract,y,m._params.contractAddress,m.data];return{data:o.interface.encodeFunctionData(g,T),to:l.MAYAN_FORWARDER_CONTRACT,value:(0,ne.toBeHex)(c),chainId:r,_forwarder:{method:g,params:T}}}else{let b="swapAndForwardERC20",g=[e.fromToken.contract,m._params.amountIn,p,f,d,e.mctpInputContract,y,m._params.contractAddress,m.data];return{data:o.interface.encodeFunctionData(b,g),to:l.MAYAN_FORWARDER_CONTRACT,value:(0,ne.toBeHex)(c),chainId:r,_forwarder:{method:b,params:g}}}}}}var Me=require("ethers"),br=require("@solana/web3.js");var Un={_format:"hh-sol-artifact-1",contractName:"MayanSwift",sourceName:"src/MayanSwift.sol",abi:[{type:"constructor",inputs:[{name:"_wormhole",type:"address",internalType:"address"},{name:"_refundVerifier",type:"address",internalType:"address"},{name:"_refundEmitterChainId",type:"uint16",internalType:"uint16"},{name:"_refundEmitterAddr",type:"bytes32",internalType:"bytes32"},{name:"_feeManager",type:"address",internalType:"address"},{name:"_rescueVault",type:"address",internalType:"address"}],stateMutability:"nonpayable"},{type:"receive",stateMutability:"payable"},{type:"function",name:"changeGuardian",inputs:[{name:"newGuardian",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"claimGuardian",inputs:[],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"createOrderWithEth",inputs:[{name:"params",type:"tuple",internalType:"struct OrderParams",components:[{name:"payloadType",type:"uint8",internalType:"uint8"},{name:"trader",type:"bytes32",internalType:"bytes32"},{name:"destAddr",type:"bytes32",internalType:"bytes32"},{name:"destChainId",type:"uint16",internalType:"uint16"},{name:"referrerAddr",type:"bytes32",internalType:"bytes32"},{name:"tokenOut",type:"bytes32",internalType:"bytes32"},{name:"minAmountOut",type:"uint64",internalType:"uint64"},{name:"gasDrop",type:"uint64",internalType:"uint64"},{name:"cancelFee",type:"uint64",internalType:"uint64"},{name:"refundFee",type:"uint64",internalType:"uint64"},{name:"deadline",type:"uint64",internalType:"uint64"},{name:"referrerBps",type:"uint8",internalType:"uint8"},{name:"auctionMode",type:"uint8",internalType:"uint8"},{name:"random",type:"bytes32",internalType:"bytes32"}]},{name:"customPayload",type:"bytes",internalType:"bytes"}],outputs:[{name:"orderHash",type:"bytes32",internalType:"bytes32"}],stateMutability:"payable"},{type:"function",name:"createOrderWithSig",inputs:[{name:"tokenIn",type:"address",internalType:"address"},{name:"amountIn",type:"uint256",internalType:"uint256"},{name:"params",type:"tuple",internalType:"struct OrderParams",components:[{name:"payloadType",type:"uint8",internalType:"uint8"},{name:"trader",type:"bytes32",internalType:"bytes32"},{name:"destAddr",type:"bytes32",internalType:"bytes32"},{name:"destChainId",type:"uint16",internalType:"uint16"},{name:"referrerAddr",type:"bytes32",internalType:"bytes32"},{name:"tokenOut",type:"bytes32",internalType:"bytes32"},{name:"minAmountOut",type:"uint64",internalType:"uint64"},{name:"gasDrop",type:"uint64",internalType:"uint64"},{name:"cancelFee",type:"uint64",internalType:"uint64"},{name:"refundFee",type:"uint64",internalType:"uint64"},{name:"deadline",type:"uint64",internalType:"uint64"},{name:"referrerBps",type:"uint8",internalType:"uint8"},{name:"auctionMode",type:"uint8",internalType:"uint8"},{name:"random",type:"bytes32",internalType:"bytes32"}]},{name:"customPayload",type:"bytes",internalType:"bytes"},{name:"submissionFee",type:"uint256",internalType:"uint256"},{name:"signedOrderHash",type:"bytes",internalType:"bytes"},{name:"permitParams",type:"tuple",internalType:"struct PermitParams",components:[{name:"value",type:"uint256",internalType:"uint256"},{name:"deadline",type:"uint256",internalType:"uint256"},{name:"v",type:"uint8",internalType:"uint8"},{name:"r",type:"bytes32",internalType:"bytes32"},{name:"s",type:"bytes32",internalType:"bytes32"}]}],outputs:[{name:"orderHash",type:"bytes32",internalType:"bytes32"}],stateMutability:"nonpayable"},{type:"function",name:"createOrderWithToken",inputs:[{name:"tokenIn",type:"address",internalType:"address"},{name:"amountIn",type:"uint256",internalType:"uint256"},{name:"params",type:"tuple",internalType:"struct OrderParams",components:[{name:"payloadType",type:"uint8",internalType:"uint8"},{name:"trader",type:"bytes32",internalType:"bytes32"},{name:"destAddr",type:"bytes32",internalType:"bytes32"},{name:"destChainId",type:"uint16",internalType:"uint16"},{name:"referrerAddr",type:"bytes32",internalType:"bytes32"},{name:"tokenOut",type:"bytes32",internalType:"bytes32"},{name:"minAmountOut",type:"uint64",internalType:"uint64"},{name:"gasDrop",type:"uint64",internalType:"uint64"},{name:"cancelFee",type:"uint64",internalType:"uint64"},{name:"refundFee",type:"uint64",internalType:"uint64"},{name:"deadline",type:"uint64",internalType:"uint64"},{name:"referrerBps",type:"uint8",internalType:"uint8"},{name:"auctionMode",type:"uint8",internalType:"uint8"},{name:"random",type:"bytes32",internalType:"bytes32"}]},{name:"customPayload",type:"bytes",internalType:"bytes"}],outputs:[{name:"orderHash",type:"bytes32",internalType:"bytes32"}],stateMutability:"nonpayable"},{type:"function",name:"emitters",inputs:[{name:"",type:"uint16",internalType:"uint16"}],outputs:[{name:"",type:"bytes32",internalType:"bytes32"}],stateMutability:"view"},{type:"function",name:"feeManager",inputs:[],outputs:[{name:"",type:"address",internalType:"contract IFeeManager"}],stateMutability:"view"},{type:"function",name:"getOrders",inputs:[{name:"orderHashes",type:"bytes32[]",internalType:"bytes32[]"}],outputs:[{name:"",type:"tuple[]",internalType:"struct Order[]",components:[{name:"status",type:"uint8",internalType:"enum Status"},{name:"amountIn",type:"uint64",internalType:"uint64"},{name:"destChainId",type:"uint16",internalType:"uint16"}]}],stateMutability:"view"},{type:"function",name:"guardian",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"nextGuardian",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"orders",inputs:[{name:"",type:"bytes32",internalType:"bytes32"}],outputs:[{name:"status",type:"uint8",internalType:"enum Status"},{name:"amountIn",type:"uint64",internalType:"uint64"},{name:"destChainId",type:"uint16",internalType:"uint16"}],stateMutability:"view"},{type:"function",name:"parseFulfillPayload",inputs:[{name:"encoded",type:"bytes",internalType:"bytes"}],outputs:[{name:"fulfillMsg",type:"tuple",internalType:"struct FulfillMsg",components:[{name:"action",type:"uint8",internalType:"uint8"},{name:"orderHash",type:"bytes32",internalType:"bytes32"},{name:"driver",type:"bytes32",internalType:"bytes32"},{name:"promisedAmount",type:"uint64",internalType:"uint64"},{name:"penaltyPeriod",type:"uint16",internalType:"uint16"}]}],stateMutability:"pure"},{type:"function",name:"parseRefundPayload",inputs:[{name:"encoded",type:"bytes",internalType:"bytes"}],outputs:[{name:"refundMsg",type:"tuple",internalType:"struct RefundMsg",components:[{name:"action",type:"uint8",internalType:"uint8"},{name:"orderHash",type:"bytes32",internalType:"bytes32"},{name:"srcChainId",type:"uint16",internalType:"uint16"},{name:"tokenIn",type:"bytes32",internalType:"bytes32"},{name:"trader",type:"bytes32",internalType:"bytes32"},{name:"canceler",type:"bytes32",internalType:"bytes32"},{name:"cancelFee",type:"uint64",internalType:"uint64"},{name:"refundFee",type:"uint64",internalType:"uint64"}]}],stateMutability:"pure"},{type:"function",name:"parseRefundVerifierPayload",inputs:[{name:"encoded",type:"bytes",internalType:"bytes"}],outputs:[{name:"verifier",type:"tuple",internalType:"struct RefundVerifier",components:[{name:"action",type:"uint8",internalType:"uint8"},{name:"verifier",type:"address",internalType:"address"},{name:"emitterChainId",type:"uint16",internalType:"uint16"},{name:"emitterAddr",type:"bytes32",internalType:"bytes32"}]}],stateMutability:"pure"},{type:"function",name:"parseRescuePayload",inputs:[{name:"encoded",type:"bytes",internalType:"bytes"}],outputs:[{name:"rescueMsg",type:"tuple",internalType:"struct RescueMsg",components:[{name:"action",type:"uint8",internalType:"uint8"},{name:"orderHash",type:"bytes32",internalType:"bytes32"},{name:"orderStatus",type:"uint8",internalType:"uint8"},{name:"token",type:"address",internalType:"address"},{name:"amount",type:"uint64",internalType:"uint64"}]}],stateMutability:"pure"},{type:"function",name:"parseUnlockPayload",inputs:[{name:"encoded",type:"bytes",internalType:"bytes"}],outputs:[{name:"unlockMsg",type:"tuple",internalType:"struct UnlockMsg",components:[{name:"action",type:"uint8",internalType:"uint8"},{name:"orderHash",type:"bytes32",internalType:"bytes32"},{name:"srcChainId",type:"uint16",internalType:"uint16"},{name:"tokenIn",type:"bytes32",internalType:"bytes32"},{name:"referrerAddr",type:"bytes32",internalType:"bytes32"},{name:"referrerBps",type:"uint8",internalType:"uint8"},{name:"protocolBps",type:"uint8",internalType:"uint8"},{name:"unlockReceiver",type:"bytes32",internalType:"bytes32"},{name:"driver",type:"bytes32",internalType:"bytes32"},{name:"fulfillTime",type:"uint64",internalType:"uint64"}]}],stateMutability:"pure"},{type:"function",name:"paused",inputs:[],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"refundEmitterAddr",inputs:[],outputs:[{name:"",type:"bytes32",internalType:"bytes32"}],stateMutability:"view"},{type:"function",name:"refundEmitterChainId",inputs:[],outputs:[{name:"",type:"uint16",internalType:"uint16"}],stateMutability:"view"},{type:"function",name:"refundOrder",inputs:[{name:"encodedVm",type:"bytes",internalType:"bytes"},{name:"fast",type:"bool",internalType:"bool"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"refundVerifier",inputs:[],outputs:[{name:"",type:"address",internalType:"contract IWormhole"}],stateMutability:"view"},{type:"function",name:"rescue",inputs:[{name:"encodedVm",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"rescueVault",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"setEmitters",inputs:[{name:"chainIds",type:"uint16[]",internalType:"uint16[]"},{name:"addresses",type:"bytes32[]",internalType:"bytes32[]"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setFeeManager",inputs:[{name:"_feeManager",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setPause",inputs:[{name:"_pause",type:"bool",internalType:"bool"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setRefundVerifier",inputs:[{name:"encodedVm",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"unlockBatch",inputs:[{name:"encodedVm",type:"bytes",internalType:"bytes"},{name:"indexes",type:"uint16[]",internalType:"uint16[]"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"unlockCompressedBatch",inputs:[{name:"encodedVm",type:"bytes",internalType:"bytes"},{name:"encodedPayload",type:"bytes",internalType:"bytes"},{name:"indexes",type:"uint16[]",internalType:"uint16[]"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"unlockSingle",inputs:[{name:"encodedVm",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"wormhole",inputs:[],outputs:[{name:"",type:"address",internalType:"contract IWormhole"}],stateMutability:"view"},{type:"event",name:"OrderCanceled",inputs:[{name:"key",type:"bytes32",indexed:!1,internalType:"bytes32"},{name:"sequence",type:"uint64",indexed:!1,internalType:"uint64"}],anonymous:!1},{type:"event",name:"OrderCreated",inputs:[{name:"key",type:"bytes32",indexed:!1,internalType:"bytes32"}],anonymous:!1},{type:"event",name:"OrderFulfilled",inputs:[{name:"key",type:"bytes32",indexed:!1,internalType:"bytes32"},{name:"sequence",type:"uint64",indexed:!1,internalType:"uint64"},{name:"netAmount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"OrderRefunded",inputs:[{name:"key",type:"bytes32",indexed:!1,internalType:"bytes32"},{name:"netAmount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"OrderUnlocked",inputs:[{name:"key",type:"bytes32",indexed:!1,internalType:"bytes32"}],anonymous:!1},{type:"error",name:"DuplicateOrder",inputs:[]},{type:"error",name:"EmitterAddressExists",inputs:[]},{type:"error",name:"FeesTooHigh",inputs:[]},{type:"error",name:"InvalidAction",inputs:[]},{type:"error",name:"InvalidBatchIndex",inputs:[]},{type:"error",name:"InvalidBpsFee",inputs:[]},{type:"error",name:"InvalidDestChain",inputs:[]},{type:"error",name:"InvalidEmitterAddress",inputs:[]},{type:"error",name:"InvalidEmitterChain",inputs:[]},{type:"error",name:"InvalidEvmAddr",inputs:[]},{type:"error",name:"InvalidGasDrop",inputs:[]},{type:"error",name:"InvalidOrderStatus",inputs:[]},{type:"error",name:"InvalidPayload",inputs:[]},{type:"error",name:"InvalidPayloadLength",inputs:[]},{type:"error",name:"InvalidSrcChain",inputs:[]},{type:"error",name:"OrderNotExists",inputs:[{name:"orderHash",type:"bytes32",internalType:"bytes32"}]},{type:"error",name:"Paused",inputs:[]},{type:"error",name:"SmallAmountIn",inputs:[]},{type:"error",name:"Unauthorized",inputs:[]}],linkReferences:{},deployedLinkReferences:{}};var Kn={_format:"hh-sol-artifact-1",contractName:"MayanSwift",sourceName:"src/MayanSwift.sol",abi:[{inputs:[{internalType:"address",name:"_wormhole",type:"address"},{internalType:"address",name:"_feeManager",type:"address"},{internalType:"uint16",name:"_auctionChainId",type:"uint16"},{internalType:"bytes32",name:"_auctionAddr",type:"bytes32"},{internalType:"bytes32",name:"_solanaEmitter",type:"bytes32"},{internalType:"uint8",name:"_consistencyLevel",type:"uint8"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"DeadlineViolation",type:"error"},{inputs:[],name:"DuplicateOrder",type:"error"},{inputs:[],name:"FeesTooHigh",type:"error"},{inputs:[],name:"InvalidAction",type:"error"},{inputs:[],name:"InvalidAmount",type:"error"},{inputs:[],name:"InvalidAuctionMode",type:"error"},{inputs:[],name:"InvalidBpsFee",type:"error"},{inputs:[],name:"InvalidContractSignature",type:"error"},{inputs:[],name:"InvalidDestChain",type:"error"},{inputs:[],name:"InvalidEmitterAddress",type:"error"},{inputs:[],name:"InvalidEmitterChain",type:"error"},{inputs:[],name:"InvalidEvmAddr",type:"error"},{inputs:[],name:"InvalidGasDrop",type:"error"},{inputs:[],name:"InvalidOrderHash",type:"error"},{inputs:[],name:"InvalidOrderStatus",type:"error"},{inputs:[],name:"InvalidSignature",type:"error"},{inputs:[],name:"InvalidSignatureLength",type:"error"},{inputs:[],name:"InvalidSigner",type:"error"},{inputs:[],name:"InvalidSrcChain",type:"error"},{inputs:[],name:"InvalidWormholeFee",type:"error"},{inputs:[],name:"OrderNotExists",type:"error"},{inputs:[],name:"Paused",type:"error"},{inputs:[],name:"SmallAmountIn",type:"error"},{inputs:[],name:"Unauthorized",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"key",type:"bytes32"},{indexed:!1,internalType:"uint64",name:"sequence",type:"uint64"}],name:"OrderCanceled",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"key",type:"bytes32"}],name:"OrderCreated",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"key",type:"bytes32"},{indexed:!1,internalType:"uint64",name:"sequence",type:"uint64"},{indexed:!1,internalType:"uint256",name:"netAmount",type:"uint256"}],name:"OrderFulfilled",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"key",type:"bytes32"},{indexed:!1,internalType:"uint256",name:"netAmount",type:"uint256"}],name:"OrderRefunded",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"key",type:"bytes32"}],name:"OrderUnlocked",type:"event"},{inputs:[],name:"auctionAddr",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"auctionChainId",outputs:[{internalType:"uint16",name:"",type:"uint16"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"tokenIn",type:"bytes32"},{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"auctionMode",type:"uint8"},{internalType:"bytes32",name:"random",type:"bytes32"}],internalType:"struct MayanSwift.OrderParams",name:"params",type:"tuple"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"uint8",name:"protocolBps",type:"uint8"},{internalType:"bytes32",name:"canceler",type:"bytes32"}],name:"cancelOrder",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"newGuardian",type:"address"}],name:"changeGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"consistencyLevel",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"auctionMode",type:"uint8"},{internalType:"bytes32",name:"random",type:"bytes32"}],internalType:"struct MayanSwift.OrderParams",name:"params",type:"tuple"}],name:"createOrderWithEth",outputs:[{internalType:"bytes32",name:"orderHash",type:"bytes32"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"auctionMode",type:"uint8"},{internalType:"bytes32",name:"random",type:"bytes32"}],internalType:"struct MayanSwift.OrderParams",name:"params",type:"tuple"},{internalType:"bytes",name:"signedOrderHash",type:"bytes"}],name:"createOrderWithSig",outputs:[{internalType:"bytes32",name:"orderHash",type:"bytes32"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"auctionMode",type:"uint8"},{internalType:"bytes32",name:"random",type:"bytes32"}],internalType:"struct MayanSwift.OrderParams",name:"params",type:"tuple"}],name:"createOrderWithToken",outputs:[{internalType:"bytes32",name:"orderHash",type:"bytes32"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"feeManager",outputs:[{internalType:"contract IFeeManager",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"fulfillAmount",type:"uint256"},{internalType:"bytes",name:"encodedVm",type:"bytes"},{internalType:"bytes32",name:"recepient",type:"bytes32"},{internalType:"bool",name:"batch",type:"bool"}],name:"fulfillOrder",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"fulfillAmount",type:"uint256"},{internalType:"bytes32",name:"orderHash",type:"bytes32"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"bytes32",name:"tokenIn",type:"bytes32"},{internalType:"uint8",name:"protocolBps",type:"uint8"},{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"auctionMode",type:"uint8"},{internalType:"bytes32",name:"random",type:"bytes32"}],internalType:"struct MayanSwift.OrderParams",name:"params",type:"tuple"},{internalType:"bytes32",name:"recepient",type:"bytes32"},{internalType:"bool",name:"batch",type:"bool"}],name:"fulfillSimple",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[],name:"guardian",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"nextGuardian",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"}],name:"orders",outputs:[{internalType:"enum MayanSwift.Status",name:"status",type:"uint8"},{internalType:"uint64",name:"amountIn",type:"uint64"},{internalType:"uint16",name:"destChainId",type:"uint16"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"encoded",type:"bytes"}],name:"parseFulfillPayload",outputs:[{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"bytes32",name:"orderHash",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"bytes32",name:"driver",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"promisedAmount",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"protocolBps",type:"uint8"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"bytes32",name:"tokenIn",type:"bytes32"}],internalType:"struct MayanSwift.FulfillMsg",name:"fulfillMsg",type:"tuple"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"bytes",name:"encoded",type:"bytes"}],name:"parseRefundPayload",outputs:[{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"bytes32",name:"orderHash",type:"bytes32"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"bytes32",name:"tokenIn",type:"bytes32"},{internalType:"bytes32",name:"recipient",type:"bytes32"},{internalType:"bytes32",name:"canceler",type:"bytes32"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"}],internalType:"struct MayanSwift.RefundMsg",name:"refundMsg",type:"tuple"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"bytes",name:"encoded",type:"bytes"}],name:"parseUnlockPayload",outputs:[{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"bytes32",name:"orderHash",type:"bytes32"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"bytes32",name:"tokenIn",type:"bytes32"},{internalType:"bytes32",name:"recipient",type:"bytes32"}],internalType:"struct MayanSwift.UnlockMsg",name:"unlockMsg",type:"tuple"}],stateMutability:"pure",type:"function"},{inputs:[],name:"paused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32[]",name:"orderHashes",type:"bytes32[]"}],name:"postBatch",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"refundOrder",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint8",name:"_consistencyLevel",type:"uint8"}],name:"setConsistencyLevel",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_feeManager",type:"address"}],name:"setFeeManager",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_pause",type:"bool"}],name:"setPause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"solanaEmitter",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"unlockBatch",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"}],name:"unlockMsgs",outputs:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"bytes32",name:"orderHash",type:"bytes32"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"bytes32",name:"tokenIn",type:"bytes32"},{internalType:"bytes32",name:"recipient",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"unlockSingle",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"wormhole",outputs:[{internalType:"contract IWormhole",name:"",type:"address"}],stateMutability:"view",type:"function"},{stateMutability:"payable",type:"receive"}],linkReferences:{},deployedLinkReferences:{}};var S=require("@solana/web3.js");var Se=require("buffer"),he=require("@solana/buffer-layout"),jn=require("@noble/hashes/sha2"),$n=ht(require("bs58"));var tn=require("buffer");function Ln(e){console.log("new decodeJupiterV6InsArgs called");let t="bb64facc31c4af14",n="d19853937cfed8e9",r=tn.Buffer.from(e.subarray(0,8)).toString("hex").toLowerCase(),i=tn.Buffer.from(e.subarray(8));if(r===t){let a=i.readBigUInt64LE(0),p=i.readBigUInt64LE(8),o=i.readUInt16LE(16),s=i.readUInt16LE(18);return{in_amount:a,quoted_out_amount:p,slippage_bps:o,platform_fee_bps:s}}else if(r===n){let a=i.readBigUInt64LE(1),p=i.readBigUInt64LE(9),o=i.readUInt16LE(17),s=i.readUInt16LE(19);return{in_amount:a,quoted_out_amount:p,slippage_bps:o,platform_fee_bps:s}}else throw new Error(`Unsupported Jupiter V6 instruction discriminator: ${r}`)}var ra={};function aa(e){return ra[e]??=new S.Connection(e),new S.Connection(e)}async function ft({trx:e,connection:t,errorChance:n,extraRpcs:r,options:i,rate:a=4}){let p=null,o=0,s,c=[t].concat(r.map(aa));for(let u=0;u<a;u++){if(p)try{let f=await Promise.any(c.map(m=>m.getSignatureStatus(p)));if(console.log("Transaction status check attempt",u,f?.value),f&&f.value){if(f.value.err){if(o>=n)return{signature:p,serializedTrx:e};o++}else if(f.value.confirmationStatus==="confirmed"||f.value.confirmationStatus==="finalized")return{signature:p,serializedTrx:e}}}catch(f){console.error(f)}let d=c.map(f=>f.sendRawTransaction(e,i));if(console.log("Submitting transaction, attempt",u+1),!p)try{p=await Promise.any(d),console.log("Transaction submitted to fetch signature, signature:",p)}catch(f){console.error("Transaction not submitted to fetch signature, remaining attempts:",a-u-1),s=f;try{console.log("now trying to send to individual connections");let m=await t.sendRawTransaction(e)}catch(m){if(console.error("Simulation individual connections failed",m),console.error("Transaction not submitted, remaining attempts:",a-u-1),console.error(m),m&&typeof m=="object"&&"transactionMessage"in m&&typeof m.transactionMessage=="string"&&m.transactionMessage.indexOf("transaction has already been processed")){if(p)return{signature:p,serializedTrx:e};throw new Error("Transaction has already been processed, but no signature found")}s=m}}await ut(3e3)}if(!p)throw s?(console.error("Failed to submit transaction"),s):new Error("Failed to submit transaction, not landed on any signature");return{signature:p,serializedTrx:e}}function re(e,t,n,r,i=new S.PublicKey(l.TOKEN_PROGRAM_ID),a=new S.PublicKey(l.ASSOCIATED_TOKEN_PROGRAM_ID)){let p=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:S.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:S.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}];return new S.TransactionInstruction({keys:p,programId:a,data:Se.Buffer.from([1])})}var Gn=165;async function ve(e,t,n,r,i,a=new S.PublicKey(l.TOKEN_PROGRAM_ID)){let p=[],o=await e.getMinimumBalanceForRentExemption(Gn);return p.push(S.SystemProgram.createAccount({fromPubkey:t,newAccountPubkey:i.publicKey,lamports:o,space:Gn,programId:a})),p.push(new S.TransactionInstruction({keys:[{pubkey:i.publicKey,isWritable:!0,isSigner:!1},{pubkey:n,isWritable:!1,isSigner:!1},{pubkey:r,isWritable:!1,isSigner:!1},{pubkey:S.SYSVAR_RENT_PUBKEY,isWritable:!1,isSigner:!1}],programId:a,data:Se.Buffer.from([1])})),p}var Vn=(0,he.struct)([(0,he.u8)("instruction"),(0,he.blob)(8,"amount")]);function nn(e,t,n,r,i=new S.PublicKey(l.TOKEN_PROGRAM_ID)){let a=[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}],p=Se.Buffer.alloc(Vn.span);return Vn.encode({instruction:4,amount:B(r)},p),new S.TransactionInstruction({keys:a,programId:i,data:p})}var Hn=(0,he.struct)([(0,he.u8)("instruction")]);function et(e){let t=[{pubkey:e,isSigner:!1,isWritable:!0}],n=Se.Buffer.alloc(Hn.span);return Hn.encode({instruction:17},n),new S.TransactionInstruction({keys:t,programId:new S.PublicKey(l.TOKEN_PROGRAM_ID),data:n})}var Qn=(0,he.struct)([(0,he.u8)("instruction")]);function Jn(e,t,n,r=new S.PublicKey(l.TOKEN_PROGRAM_ID)){let i=[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1}],a=Se.Buffer.alloc(Qn.span);return Qn.encode({instruction:9},a),new S.TransactionInstruction({keys:i,programId:r,data:a})}var Yn=(0,he.struct)([(0,he.u8)("instruction"),(0,he.blob)(8,"amount")]);function Re(e,t,n,r,i=new S.PublicKey(l.TOKEN_PROGRAM_ID)){let a=[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1}],p=Se.Buffer.alloc(Yn.span);return Yn.encode({instruction:3,amount:B(r)},p),new S.TransactionInstruction({keys:a,programId:i,data:p})}var Ce=new S.PublicKey("So11111111111111111111111111111111111111112");async function ia(e,t,n,r){let i=r??new S.Connection("https://rpc.ankr.com/solana"),a=U(Ce,e,!1),{blockhash:p,lastValidBlockHeight:o}=await i.getLatestBlockhash(),s=new S.Transaction({feePayer:e,blockhash:p,lastValidBlockHeight:o}),c=await i.getAccountInfo(a,"finalized");(!c||c.data.length===0)&&s.add(re(e,a,e,Ce)),s.add(S.SystemProgram.transfer({fromPubkey:e,toPubkey:a,lamports:w(t,9)})),s.add(et(a));let u=await n(s);return await ft({trx:u.serialize(),connection:i,errorChance:1,extraRpcs:[]})}async function sa(e,t,n,r){let i=r??new S.Connection("https://rpc.ankr.com/solana"),a=U(Ce,e,!1),p=S.Keypair.generate(),{blockhash:o,lastValidBlockHeight:s}=await i.getLatestBlockhash(),c=new S.Transaction({feePayer:e,blockhash:o,lastValidBlockHeight:s}),u=U(Ce,p.publicKey,!1);c.add(re(e,u,p.publicKey,Ce)),c.add(Re(a,u,e,w(t,9))),c.add(Jn(u,e,p.publicKey)),c.partialSign(p);let d=await n(c);return await ft({trx:d.serialize(),connection:i,errorChance:1,extraRpcs:[]})}function yt(e){return new S.TransactionInstruction({programId:new S.PublicKey(e.programId),keys:e.accounts.map(t=>({pubkey:new S.PublicKey(t.pubkey),isSigner:t.isSigner,isWritable:t.isWritable})),data:Se.Buffer.from(e.data,"base64")})}async function Ee(e,t){return(await t.getMultipleAccountsInfo(e.map(r=>new S.PublicKey(r)))).reduce((r,i,a)=>{let p=e[a];if(i){let o=new S.AddressLookupTableAccount({key:new S.PublicKey(p),state:S.AddressLookupTableAccount.deserialize(i.data)});r.push(o)}return r},new Array)}function Oe(e,t,n){let r=yt(e.swapInstruction),i=e.cleanupInstruction?yt(e.cleanupInstruction):null,a=e.computeBudgetInstructions?e.computeBudgetInstructions.map(yt):[],p=e.setupInstructions?ua(e.setupInstructions,n).map(yt):[];return{swapInstruction:r,cleanupInstruction:i,computeBudgetInstructions:a,setupInstructions:p,addressLookupTableAddresses:e.addressLookupTableAddresses}}var oa=[{programId:S.SystemProgram.programId.toString(),instructionDataHex:"00000000",discriminatorLength:4,accountIndex:0},{programId:l.ASSOCIATED_TOKEN_PROGRAM_ID,instructionDataHex:"01",discriminatorLength:1,accountIndex:0},{programId:l.ASSOCIATED_TOKEN_PROGRAM_ID,instructionDataHex:"",discriminatorLength:0,accountIndex:0}];function ua(e,t){return t?e.map(n=>{let r=oa.find(i=>i.programId===n.programId&&i.instructionDataHex===Se.Buffer.from(n.data,"base64").subarray(0,i.discriminatorLength).toString("hex")&&n.accounts.length>i.accountIndex);if(r){let i=[...n.accounts];return i[r.accountIndex]={...i[r.accountIndex],pubkey:t.toString()},{...n,accounts:i}}else return n}):e}function te(e){let t=`global:${e}`;return Se.Buffer.from((0,jn.sha256)(t)).subarray(0,8)}async function rn(){let e;try{let t=await Yt();e=new S.PublicKey(t)}catch{console.log("Relayer not found, using system program"),e=S.SystemProgram.programId}return e}function an(e,t,n,r){let i=r.jitoAccount||"Cw8CFyM9FkoMi7K7Crf6HNQqf4uEMzpKw6QNghXLvLkY";return new S.Transaction({feePayer:new S.PublicKey(e),blockhash:t,lastValidBlockHeight:n}).add(S.SystemProgram.transfer({fromPubkey:new S.PublicKey(e),toPubkey:new S.PublicKey(i),lamports:r.tipLamports}))}var zn=["https://mayan-jito.mayan.finance/v1/bundles"];async function pa(e,t){let n=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:t});if(n.status!==200&&n.status!==201)throw console.error("Post Jito bundle failed",e,n.status,n.statusText),new Error("Send Jito bundle failed: "+n.status+" "+n.statusText);{let r=await n.json();return console.log("Post Jito bundle result",e,r.result),r.result}}async function St(e,t,n=!1){try{let r=[];for(let s of e)r.push(s.serialize());let i={jsonrpc:"2.0",id:1,method:"sendBundle",params:[r.map(s=>$n.default.encode(s))]},a=t.jitoSendUrl?[t.jitoSendUrl]:zn,p=JSON.stringify(i);return await Promise.any(a.map(s=>pa(s,p)))}catch(r){if(console.error("Send Jito bundle failed",r),n)throw new Error("Send Jito bundle failed")}}async function ca(e,t){let r=0;for(;r<5;)try{let i=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",id:1,method:"getBundleStatuses",params:[e]})});if(!i.ok)throw new Error(`HTTP error! Status: ${i.status}`);let a=await i.json();if(a.error)throw new Error(`Error getting bundle statuses: ${JSON.stringify(a.error,null,2)}`);return a.result}catch(i){if(r++,await ut(1e3),r>=5)throw new Error(`Failed to fetch bundle statuses after 5 attempts: ${i.message}`)}}async function sn(e,t,n,r,i){let p=Date.now();for(;Date.now()-p<9e4&&await i.getBlockHeight()<=n;){await ut(2050);let o=t.jitoSendUrl?[t.jitoSendUrl]:zn,s=await Promise.any(o.map(c=>ca([e],c)));if(s&&s.value&&s.value.length>0&&s.value[0]){console.log("===>",s.value[0]);let c=s.value[0].confirmation_status;if(c==="confirmed"||c==="finalized"){let u=await i.getSignatureStatus(r);if(!u||!u.value)continue;if(u.value?.err)throw new Error(`Bundle failed with error: ${u.value.err}`);return}}}throw new Error("Bundle not confirmed, timeout")}async function on(e){try{await fetch("https://explorer-api.mayan.finance/v3/submit/jito-bundle",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bundleId:e})})}catch{}}function la(e,t){if(e){if(!e.programId.equals(new S.PublicKey(l.TOKEN_PROGRAM_ID))&&!e.programId.equals(new S.PublicKey(l.TOKEN_2022_PROGRAM_ID)))throw new Error("Invalid cleanup instruction:: programId");if(Uint8Array.from(e.data).length!==1)throw new Error("Invalid cleanup instruction:: data");if(Uint8Array.from(e.data)[0]!==9)throw new Error("Invalid cleanup instruction:: data");if(t&&!e.keys[1].pubkey.equals(t))throw new Error("Invalid cleanup instruction:: dest account")}}function da(e,t){if(!(e.length<1)){if(e.length>6)throw new Error("Invalid setup instruction:: too many instructions");e.forEach(n=>{if(!n.programId.equals(new S.PublicKey(l.ASSOCIATED_TOKEN_PROGRAM_ID))&&!n.programId.equals(S.SystemProgram.programId)&&!n.programId.equals(new S.PublicKey(l.TOKEN_PROGRAM_ID))&&!n.programId.equals(new S.PublicKey(l.TOKEN_2022_PROGRAM_ID)))throw new Error("Invalid setup instruction:: programId");if(n.programId.equals(new S.PublicKey(l.ASSOCIATED_TOKEN_PROGRAM_ID))){if(Uint8Array.from(n.data).length===1){if(Uint8Array.from(n.data)[0]!==1)throw new Error("Invalid setup instruction:: data")}else if(Uint8Array.from(n.data).length!==0)throw new Error("Invalid setup instruction:: data")}else if(n.programId.equals(S.SystemProgram.programId)){if(!t)throw new Error("Invalid setup instruction:: unknown transfer");let r=U(Ce,t,!0);if(n.data.readUint32LE()!==2)throw new Error("Invalid setup instruction:: invalid system program instruction");if(!n.keys[1].pubkey.equals(r))throw new Error("Invalid setup instruction:: invalid wrap transfer dest")}else if(n.data.toString("base64")!=="EQ==")throw new Error("Invalid setup instruction:: invalid token program instruction")})}}function ma(e,t,n=!1){let r=new S.PublicKey("JUP6LkbZbjS1jKKwapdHNy74zcZ3tLUZoi5QNyVTaV4");if(!e.programId.equals(r))throw new Error("Invalid swap instruction:: programId");if(e.data.subarray(0,8).toString("hex")===te("shared_accounts_route").toString("hex")){if(!e.keys[6].pubkey.equals(t))throw new Error("Invalid swap instruction shared_accounts_route:: dest account")}else if(e.data.subarray(0,8).toString("hex")===te("shared_accounts_route_v2").toString("hex")){if(!e.keys[5].pubkey.equals(t))throw new Error("Invalid swap instruction shared_accounts_route_v2:: dest account")}else if(e.data.subarray(0,8).toString("hex")===te("route").toString("hex")){if(n){if(!e.keys[4].pubkey.equals(r)||!e.keys[3].pubkey.equals(t))throw new Error("Invalid swap instruction route:: dest account")}else if(!e.keys[4].pubkey.equals(t))throw new Error("Invalid swap instruction route:: dest account")}else if(e.data.subarray(0,8).toString("hex")===te("route_v2").toString("hex")){if(n){if(!e.keys[7].pubkey.equals(r)||!e.keys[2].pubkey.equals(t))throw new Error("Invalid swap instruction route_v2:: dest account")}else if(!e.keys[7].pubkey.equals(t))throw new Error("Invalid swap instruction route_v2:: dest account")}else throw new Error("Invalid swap instruction:: ix id")}function un(e,t){let n=Ln(Uint8Array.from(e.data));if(n.in_amount>BigInt(t.effectiveAmountIn64))throw new Error("Invalid swap instruction:: amount in");let r=w(t.minAmountOut,t.toToken.decimals);if(n.quoted_out_amount-n.quoted_out_amount*BigInt(n.slippage_bps)/10000n<r)throw new Error("Invalid swap instruction:: quote expired");if(n.platform_fee_bps!==t.referrerBps)throw new Error("Invalid swap instruction:: platform fee")}function ya(e){e.forEach(t=>{if(!t.programId.equals(S.ComputeBudgetProgram.programId))throw new Error("Invalid compute budget instruction:: programId");if(Uint8Array.from(t.data)[0]===3&&t.data.readBigUInt64LE(1)>100000000n)throw new Error("Invalid compute budget instruction:: to high tx fee")})}function le(e,t,n,r,i=!1){ya(e.computeBudgetInstructions),da(e.setupInstructions,n),ma(e.swapInstruction,t,i),la(e.cleanupInstruction,r)}function Ke(e,t,n,r,i,a=new S.PublicKey("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA")){return new S.TransactionInstruction({keys:[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!1}],programId:new S.PublicKey("B96dV3Luxzo6SokJx3xt8i5y8Mb7HRR6Eec8hCjJDT69"),data:te("transfer_all_and_close")})}function Ye(e,t,n,r){let i=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:S.SystemProgram.programId,isSigner:!1,isWritable:!1}],a=8+2+4+n.length,p=Se.Buffer.alloc(a);return p.set(te("create_simple"),0),p.writeUint16LE(r,8),p.writeUint32LE(n.length,10),p.set(n,14),new S.TransactionInstruction({keys:i,programId:new S.PublicKey(l.PAYLOAD_WRITER_PROGRAM_ID),data:p})}function je(e,t,n){let r=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0}],i=8+2,a=Se.Buffer.alloc(i);return a.set(te("close"),0),a.writeUint16LE(n,8),new S.TransactionInstruction({keys:r,programId:new S.PublicKey(l.PAYLOAD_WRITER_PROGRAM_ID),data:a})}function A(e,t=!1){return t?e:new S.TransactionInstruction({keys:[{pubkey:e.programId,isSigner:!1,isWritable:!1}].concat(e.keys),programId:new S.PublicKey(l.CPI_PROXY_PROGRAM_ID),data:e.data})}function Fe(e){if(e==="solana")return l.LOOKUP_TABLE_SOLANA;if(e==="fogo")return l.LOOKUP_TABLE_FOGO;throw new Error(`Unsupported chain name for lookup table: ${e}`)}var N=require("@solana/web3.js"),ae=require("@solana/buffer-layout");var Ge=require("buffer");var Mt=require("ethers");var C=require("@solana/web3.js"),H=require("@solana/buffer-layout");var ue=require("buffer");var Pe=require("@solana/web3.js");var tt=require("buffer");function Zn(e,t){let n,r;if(t==="solana")n=new Pe.PublicKey(l.WORMHOLE_PROGRAM_ID),r=new Pe.PublicKey(l.WORMHOLE_SHIM_POST_MESSAGE_PROGRAM_ID);else if(t==="fogo")n=new Pe.PublicKey(l.WORMHOLE_PROGRAM_ID_FOGO),r=new Pe.PublicKey(l.WORMHOLE_SHIM_POST_MESSAGE_PROGRAM_ID);else throw new Error("Unsupported chain for wormhole PDAs: "+t);let i=new Pe.PublicKey(e),[a]=Pe.PublicKey.findProgramAddressSync([tt.Buffer.from("Bridge")],n),[p]=Pe.PublicKey.findProgramAddressSync([tt.Buffer.from("emitter")],i),[o]=Pe.PublicKey.findProgramAddressSync([tt.Buffer.from("Sequence"),p.toBuffer()],n),[s]=Pe.PublicKey.findProgramAddressSync([tt.Buffer.from("fee_collector")],n),[c]=Pe.PublicKey.findProgramAddressSync([p.toBuffer()],r),[u]=Pe.PublicKey.findProgramAddressSync([tt.Buffer.from("__event_authority")],r);return{bridgeConfig:a,sequenceKey:o,feeCollector:s,emitter:p,shimEventAuth:u,shimMessage:c}}var Xn=(0,H.struct)([(0,H.blob)(8,"instruction")]);function nt(e,t,n,r,i,a){let p=new C.PublicKey(l.WORMHOLE_PROGRAM_ID),o=new C.PublicKey(l.WORMHOLE_SHIM_POST_MESSAGE_PROGRAM_ID),s=new C.PublicKey(l.TOKEN_PROGRAM_ID),c=new C.PublicKey(l.CCTP_CORE_PROGRAM_ID),u=new C.PublicKey(l.CCTP_TOKEN_PROGRAM_ID),d=new C.PublicKey(l.MCTP_PROGRAM_ID),f=new C.PublicKey(r),m=new C.PublicKey(n),y=U(m,e,!0),b;i&&i>BigInt(0)?b=U(m,f,!1):b=new C.PublicKey(l.MCTP_PROGRAM_ID);let g=Ct(m,t),T=Zn(l.MCTP_PROGRAM_ID,a),I=C.Keypair.generate(),M=[{pubkey:e,isWritable:!0,isSigner:!1},{pubkey:y,isWritable:!0,isSigner:!1},{pubkey:f,isWritable:!0,isSigner:!0},{pubkey:b,isWritable:!0,isSigner:!1},{pubkey:m,isWritable:!0,isSigner:!1},{pubkey:g.senderAuthority,isWritable:!1,isSigner:!1},{pubkey:g.tokenMessenger,isWritable:!1,isSigner:!1},{pubkey:g.remoteTokenMessengerKey,isWritable:!1,isSigner:!1},{pubkey:g.tokenMinter,isWritable:!1,isSigner:!1},{pubkey:g.localToken,isWritable:!0,isSigner:!1},{pubkey:g.eventAuthToken,isWritable:!1,isSigner:!1},{pubkey:g.messageTransmitter,isWritable:!0,isSigner:!1},{pubkey:I.publicKey,isWritable:!0,isSigner:!0},{pubkey:u,isWritable:!1,isSigner:!1},{pubkey:c,isWritable:!1,isSigner:!1},{pubkey:T.emitter,isWritable:!1,isSigner:!1},{pubkey:T.bridgeConfig,isWritable:!0,isSigner:!1},{pubkey:T.sequenceKey,isWritable:!0,isSigner:!1},{pubkey:T.feeCollector,isWritable:!0,isSigner:!1},{pubkey:T.shimMessage,isWritable:!0,isSigner:!1},{pubkey:p,isWritable:!1,isSigner:!1},{pubkey:C.SYSVAR_CLOCK_PUBKEY,isWritable:!1,isSigner:!1},{pubkey:T.shimEventAuth,isWritable:!1,isSigner:!1},{pubkey:o,isWritable:!1,isSigner:!1},{pubkey:s,isWritable:!1,isSigner:!1},{pubkey:C.SystemProgram.programId,isWritable:!1,isSigner:!1}],k=ue.Buffer.alloc(Xn.span);return Xn.encode({instruction:te("bridge_with_fee_shim")},k),{instruction:new C.TransactionInstruction({keys:M,data:k,programId:d}),signers:[I]}}var qn=(0,H.struct)([(0,H.blob)(8,"instruction")]);function er(e,t,n,r,i){let a=[null,null],p=new C.PublicKey(l.TOKEN_PROGRAM_ID),o=new C.PublicKey(l.ASSOCIATED_TOKEN_PROGRAM_ID),s=new C.PublicKey(l.CCTP_CORE_PROGRAM_ID),c=new C.PublicKey(l.CCTP_TOKEN_PROGRAM_ID),u=new C.PublicKey(l.MCTP_PROGRAM_ID),d=new C.PublicKey(r),f=new C.PublicKey(n),m=U(f,e,!0),y=Ct(f,t),b=C.Keypair.generate(),[g]=C.PublicKey.findProgramAddressSync([ue.Buffer.from("LOCKED_FEE"),f.toBuffer(),b.publicKey.toBytes()],u),T;i&&i>BigInt(0)?T=U(f,d,!1):T=new C.PublicKey(l.MCTP_PROGRAM_ID);let I=U(f,g,!0);a[0]=re(d,I,g,f);let M=[{pubkey:e,isWritable:!0,isSigner:!1},{pubkey:m,isWritable:!0,isSigner:!1},{pubkey:d,isWritable:!0,isSigner:!0},{pubkey:T,isWritable:!0,isSigner:!1},{pubkey:g,isWritable:!0,isSigner:!1},{pubkey:I,isWritable:!0,isSigner:!1},{pubkey:f,isWritable:!0,isSigner:!1},{pubkey:y.senderAuthority,isWritable:!1,isSigner:!1},{pubkey:y.tokenMessenger,isWritable:!1,isSigner:!1},{pubkey:y.remoteTokenMessengerKey,isWritable:!1,isSigner:!1},{pubkey:y.tokenMinter,isWritable:!1,isSigner:!1},{pubkey:y.localToken,isWritable:!0,isSigner:!1},{pubkey:y.eventAuthToken,isWritable:!1,isSigner:!1},{pubkey:y.messageTransmitter,isWritable:!0,isSigner:!1},{pubkey:b.publicKey,isWritable:!0,isSigner:!0},{pubkey:c,isWritable:!1,isSigner:!1},{pubkey:s,isWritable:!1,isSigner:!1},{pubkey:p,isWritable:!1,isSigner:!1},{pubkey:o,isWritable:!1,isSigner:!1},{pubkey:C.SystemProgram.programId,isWritable:!1,isSigner:!1}],k=ue.Buffer.alloc(qn.span);qn.encode({instruction:te("bridge_locked_fee")},k);let v=new C.TransactionInstruction({keys:M,data:k,programId:u});return a[1]=v,{instructions:a,signer:b}}var tr=(0,H.struct)([(0,H.blob)(8,"instruction")]);function nr(e,t,n,r,i){let a=new C.PublicKey(l.TOKEN_PROGRAM_ID),p=new C.PublicKey(l.CCTP_CORE_PROGRAM_ID),o=new C.PublicKey(l.CCTP_TOKEN_PROGRAM_ID),s=new C.PublicKey(l.MCTP_PROGRAM_ID),c=new C.PublicKey(r),u=new C.PublicKey(n),d=U(u,e,!0),f=Ct(u,t),m=C.Keypair.generate(),[y]=C.PublicKey.findProgramAddressSync([ue.Buffer.from("ORDER_SOLANA_SOURCE"),e.toBuffer()],s),b;i&&i>BigInt(0)?b=U(u,c,!1):b=new C.PublicKey(l.MCTP_PROGRAM_ID);let g=[{pubkey:e,isWritable:!1,isSigner:!1},{pubkey:d,isWritable:!0,isSigner:!1},{pubkey:c,isWritable:!0,isSigner:!0},{pubkey:b,isWritable:!0,isSigner:!1},{pubkey:u,isWritable:!0,isSigner:!1},{pubkey:y,isWritable:!0,isSigner:!1},{pubkey:f.senderAuthority,isWritable:!1,isSigner:!1},{pubkey:f.tokenMessenger,isWritable:!1,isSigner:!1},{pubkey:f.remoteTokenMessengerKey,isWritable:!1,isSigner:!1},{pubkey:f.tokenMinter,isWritable:!1,isSigner:!1},{pubkey:f.localToken,isWritable:!0,isSigner:!1},{pubkey:f.eventAuthToken,isWritable:!1,isSigner:!1},{pubkey:f.messageTransmitter,isWritable:!0,isSigner:!1},{pubkey:m.publicKey,isWritable:!0,isSigner:!0},{pubkey:o,isWritable:!1,isSigner:!1},{pubkey:p,isWritable:!1,isSigner:!1},{pubkey:new C.PublicKey(l.FEE_MANAGER_PROGRAM_ID),isWritable:!1,isSigner:!1},{pubkey:a,isWritable:!1,isSigner:!1},{pubkey:C.SystemProgram.programId,isWritable:!1,isSigner:!1}],T=ue.Buffer.alloc(tr.span);return tr.encode({instruction:te("create_order")},T),{instruction:new C.TransactionInstruction({keys:g,data:T,programId:s}),signer:m}}var rr=(0,H.struct)([(0,H.blob)(8,"instruction"),(0,H.blob)(32,"destAddress"),(0,H.blob)(8,"amountInMin"),(0,H.blob)(8,"gasDrop"),(0,H.blob)(8,"feeRedeem"),(0,H.blob)(8,"feeSolana"),(0,H.u16)("destinationChain"),(0,H.blob)(32,"keyRnd"),(0,H.u8)("mode")]);function rt(e){if(e.mode!=="WITH_FEE"&&e.mode!=="LOCK_FEE")throw new Error("Invalid mode: "+e.mode);if(e.customPayload&&e.mode!=="WITH_FEE")throw new Error("Custom payload is only supported in WITH_FEE mode");let t=new C.PublicKey(e.swapperAddress),n=new C.PublicKey(e.relayerAddress),r=new C.PublicKey(e.mintAddress),i=U(r,e.ledger,!0),a=_(e.toChain),p=ue.Buffer.from(Q(h(e.destinationAddress,a))),o=B(e.amountInMin64),s=B(w(e.gasDrop,Math.min(j(e.toChain),8))),c=B(w(e.feeRedeem,$)),u=B(e.feeSolana),d=e.referrerAddress?ue.Buffer.from(Q(h(e.referrerAddress,a))):C.SystemProgram.programId.toBuffer(),f=[{pubkey:t,isWritable:!0,isSigner:!0},{pubkey:e.ledger,isWritable:!0,isSigner:!1},{pubkey:i,isWritable:!1,isSigner:!1},{pubkey:e.customPayload||new C.PublicKey(l.MCTP_PROGRAM_ID),isWritable:!1,isSigner:!1},{pubkey:r,isWritable:!1,isSigner:!1},{pubkey:C.SystemProgram.programId,isWritable:!1,isSigner:!1},{pubkey:n,isWritable:!0,isSigner:!0},{pubkey:new C.PublicKey(d),isWritable:!1,isSigner:!1}],m=ue.Buffer.alloc(rr.span);return rr.encode({instruction:te("init_bridge_ledger_gasless"),destAddress:p,amountInMin:o,gasDrop:s,feeRedeem:c,feeSolana:u,destinationChain:a,keyRnd:e.randomKey.toBuffer(),mode:e.mode==="WITH_FEE"?1:2},m),new C.TransactionInstruction({keys:f,data:m,programId:new C.PublicKey(l.MCTP_PROGRAM_ID)})}var ar=(0,H.struct)([(0,H.blob)(8,"instruction"),(0,H.blob)(32,"destAddress"),(0,H.blob)(8,"amountInMin"),(0,H.blob)(8,"gasDrop"),(0,H.blob)(8,"feeRedeem"),(0,H.blob)(8,"feeSolana"),(0,H.u16)("destinationChain"),(0,H.blob)(32,"keyRnd"),(0,H.u8)("mode"),(0,H.blob)(32,"tokenOut"),(0,H.blob)(8,"amountOutMin"),(0,H.blob)(8,"deadline"),(0,H.blob)(32,"refAddress"),(0,H.u8)("feeRateRef")]);function ir(e){let t=new C.PublicKey(e.swapperAddress),n=new C.PublicKey(e.relayerAddress),r=new C.PublicKey(e.mintAddress),i=U(r,e.ledger,!0),a=_(e.toChain),p=ue.Buffer.from(Q(h(e.destinationAddress,a))),o=B(e.amountInMin64),s=B(w(e.gasDrop,Math.min(j(e.toChain),8))),c=B(w(e.feeRedeem,$)),u=B(e.feeSolana),d=ue.Buffer.from(Q(h(e.tokenOut,a))),f=e.referrerAddress?ue.Buffer.from(Q(h(e.referrerAddress,a))):C.SystemProgram.programId.toBuffer(),m=B(w(e.amountOutMin,Math.min(8,e.tokenOutDecimals))),y=B(e.deadline),b=[{pubkey:t,isWritable:!0,isSigner:!0},{pubkey:e.ledger,isWritable:!0,isSigner:!1},{pubkey:i,isWritable:!1,isSigner:!1},{pubkey:r,isWritable:!1,isSigner:!1},{pubkey:C.SystemProgram.programId,isWritable:!1,isSigner:!1},{pubkey:n,isWritable:!0,isSigner:!0}],g=ue.Buffer.alloc(ar.span);return ar.encode({instruction:te("init_order_ledger_gasless"),destAddress:p,amountInMin:o,gasDrop:s,feeRedeem:c,feeSolana:u,destinationChain:a,keyRnd:e.randomKey.toBuffer(),mode:3,tokenOut:d,refAddress:f,amountOutMin:m,deadline:y,feeRateRef:e.feeRateRef},g),new C.TransactionInstruction({keys:b,data:g,programId:new C.PublicKey(l.MCTP_PROGRAM_ID)})}async function pn(e,t,n,r,i,a={}){let p=a?.forceSkipCctpInstructions||!1,o=a?.allowSwapperOffCurve||!1;if(e.toChain==="solana")throw new Error("Unsupported destination chain: "+e.toChain);let s=e.relayer||t,c=[],u=[],d=[],f=[],m=[],y=[],b=[],g=C.Keypair.generate(),T=null;c.push(Fe(e.fromChain));let I=new C.PublicKey(l.MCTP_PROGRAM_ID),M=new C.PublicKey(t),k=new C.PublicKey(s),v=C.Keypair.generate(),x=e.deadline64?BigInt(e.deadline64):BigInt(0);if(e.hasAuction&&!Number(e.deadline64))throw new Error("Swap mode requires a timeout");let F=e.hasAuction?"LEDGER_ORDER":"LEDGER_BRIDGE",[P]=C.PublicKey.findProgramAddressSync([ue.Buffer.from(F),M.toBytes(),v.publicKey.toBytes()],I),L=U(new C.PublicKey(e.mctpInputContract),P,!0),D=e.cheaperChain==="solana"?"LOCK_FEE":"WITH_FEE";if(e.toChain==="sui"&&!e.toToken.verifiedAddress)throw new Error("Missing verified address for SUI coin");let V=e.toChain==="sui"?e.toToken.verifiedAddress:e.toToken.contract;if(!V)throw new Error("Missing token out address");if(a.customPayload&&e.hasAuction)throw new Error("Cannot use customPayload with create Mctp swap");let J=null,z=Math.floor(Math.random()*65e3);if(a.customPayload&&(J=C.PublicKey.findProgramAddressSync([ue.Buffer.from("PAYLOAD"),k.toBuffer(),(()=>{let R=ue.Buffer.alloc(2);return R.writeUInt16LE(z,0),R})()],new C.PublicKey(l.PAYLOAD_WRITER_PROGRAM_ID))[0],u.push(A(Ye(k,J,ue.Buffer.from(a.customPayload),z)))),e.fromToken.contract===e.mctpInputContract){let R=BigInt(p?e.solanaRelayerFee64:0);if(e.suggestedPriorityFee>0&&u.push(C.ComputeBudgetProgram.setComputeUnitPrice({microLamports:e.suggestedPriorityFee})),u.push(A(re(k,L,P,new C.PublicKey(e.mctpInputContract)))),u.push(A(Re(U(new C.PublicKey(e.mctpInputContract),M,o),L,M,BigInt(e.effectiveAmountIn64)))),e.hasAuction){if(u.push(A(ir({ledger:P,swapperAddress:t,mintAddress:e.mctpInputContract,randomKey:v.publicKey,toChain:e.toChain,destinationAddress:n,feeSolana:R,feeRedeem:e.redeemRelayerFee,gasDrop:e.gasDrop,amountInMin64:BigInt(e.effectiveAmountIn64),tokenOut:V,tokenOutDecimals:e.toToken.decimals,referrerAddress:r,amountOutMin:e.minAmountOut,deadline:x,feeRateRef:e.referrerBps||0,relayerAddress:s}),a.skipProxyMayanInstructions)),!p){let{instruction:W,signer:Z}=nr(P,e.toChain,e.mctpInputContract,s,R);u.push(A(W,a.skipProxyMayanInstructions)),d.push(Z)}}else if(u.push(A(rt({ledger:P,swapperAddress:t,mintAddress:e.mctpInputContract,randomKey:v.publicKey,toChain:e.toChain,destinationAddress:n,feeSolana:R,feeRedeem:e.redeemRelayerFee,gasDrop:e.gasDrop,amountInMin64:BigInt(e.effectiveAmountIn64),mode:D,referrerAddress:r,relayerAddress:s,customPayload:J}),a.skipProxyMayanInstructions)),!p)if(D==="WITH_FEE"){let{instruction:W,signers:Z}=nt(P,e.toChain,e.mctpInputContract,s,R,e.fromChain);u.push(A(W,a.skipProxyMayanInstructions)),d.push(...Z)}else{let{instructions:W,signer:Z}=er(P,e.toChain,e.mctpInputContract,s,R);u.push(A(W[0])),u.push(A(W[1],a.skipProxyMayanInstructions)),d.push(Z)}}else{if(!e.minMiddleAmount)throw new Error("Missing minMiddleAmount for swap");let R=await ke({minMiddleAmount:e.minMiddleAmount,middleToken:e.mctpInputContract,userWallet:t,userLedger:P.toString(),slippageBps:e.slippageBps,fromToken:e.fromToken.contract,amountIn64:e.effectiveAmountIn64,depositMode:e.hasAuction?"SWAP":D,fillMaxAccounts:a?.separateSwapTx||!1,tpmTokenAccount:a?.separateSwapTx?g.publicKey.toString():null,referrerAddress:r||null,chainName:e.fromChain}),W=Oe(R,i,k);a?.separateSwapTx&&R.maxAccountsFilled?(le(W,g.publicKey,M),b=await ve(i,k,new C.PublicKey(e.mctpInputContract),M,g),y.push(...W.computeBudgetInstructions),W.setupInstructions&&y.push(...W.setupInstructions),y.push(W.swapInstruction),W.cleanupInstruction&&y.push(W.cleanupInstruction),m.push(...W.addressLookupTableAddresses),u.push(A(re(k,L,P,new C.PublicKey(e.mctpInputContract)))),u.push(A(Ke(M,new C.PublicKey(e.mctpInputContract),g.publicKey,L,k)))):(le(W,L,M),u.push(...W.computeBudgetInstructions),W.setupInstructions&&u.push(...W.setupInstructions.map(oe=>A(oe))),u.push(W.swapInstruction),W.cleanupInstruction&&u.push(A(W.cleanupInstruction)),c.push(...W.addressLookupTableAddresses));let Z=y.length>0?BigInt(0):BigInt(e.solanaRelayerFee64);if(e.hasAuction){if(u.push(A(ir({ledger:P,swapperAddress:t,mintAddress:e.mctpInputContract,randomKey:v.publicKey,toChain:e.toChain,destinationAddress:n,feeSolana:Z,feeRedeem:e.redeemRelayerFee,gasDrop:e.gasDrop,amountInMin64:w(e.minMiddleAmount,$),tokenOut:V,tokenOutDecimals:e.toToken.decimals,referrerAddress:r,amountOutMin:e.minAmountOut,deadline:x,feeRateRef:e.referrerBps||0,relayerAddress:s}),a.skipProxyMayanInstructions)),y.length>0){let{instruction:oe,signer:Te}=nr(P,e.toChain,e.mctpInputContract,s,Z);u.push(A(oe,a.skipProxyMayanInstructions)),d.push(Te)}}else if(u.push(A(rt({ledger:P,swapperAddress:t,mintAddress:e.mctpInputContract,randomKey:v.publicKey,toChain:e.toChain,destinationAddress:n,feeSolana:Z,feeRedeem:e.redeemRelayerFee,gasDrop:e.gasDrop,amountInMin64:w(e.minMiddleAmount,$),mode:D,referrerAddress:r,relayerAddress:s,customPayload:J}),a.skipProxyMayanInstructions)),y.length>0)if(D==="WITH_FEE"){let{instruction:oe,signers:Te}=nt(P,e.toChain,e.mctpInputContract,s,Z,e.fromChain);u.push(A(oe,a.skipProxyMayanInstructions)),d.push(...Te)}else{let{instructions:oe,signer:Te}=er(P,e.toChain,e.mctpInputContract,s,Z);u.push(A(oe[0])),u.push(A(oe[1],a.skipProxyMayanInstructions)),d.push(Te)}}J&&u.push(A(je(k,J,z)));let O=await Ee(c.concat(m),i);if(f=O.slice(0,c.length),y.length>0){let R=O.slice(c.length);T={messageV0:{payerKey:M,instructions:y,addressLookupTableAccounts:R},createTmpTokenAccountIxs:b,tmpTokenAccount:g}}return{instructions:u,signers:d,lookupTables:f,swapMessageV0Params:T}}var Y=require("@solana/web3.js"),q=require("@solana/buffer-layout");var se=require("buffer");var Le=require("ethers");function Pt(e,t,n,r,i,a){let p=e.swiftVersion==="V2"?272:239,o=se.Buffer.alloc(p),s=0;if(e.swiftVersion==="V2"){let F=a?Je:$e;o.writeUInt8(F,s),s+=1}let c=_(e.fromChain),u=se.Buffer.from(Q(h(t,c)));o.set(u,s),s+=32,o.writeUInt16BE(c,s),s+=2;let d=e.fromChain==="sui"?e.swiftVerifiedInputAddress:e.swiftInputContract,f=d===Le.ZeroAddress?h(Y.SystemProgram.programId.toString(),_("solana")):h(d,c),m=se.Buffer.from(Q(f));o.set(m,s),s+=32;let y=_(e.toChain),b=se.Buffer.from(Q(h(n,y)));if(o.set(b,s),s+=32,o.writeUInt16BE(y,s),s+=2,e.toChain==="sui"&&!e.toToken.verifiedAddress)throw new Error("Missing verified address for SUI coin");let g=qe(e),T=se.Buffer.from(Q(g));if(o.set(T,s),s+=32,o.writeBigUInt64BE(w(e.minAmountOut,Math.min(e.toToken.decimals,We(e.toChain,e.type))),s),s+=8,o.writeBigUInt64BE(w(e.gasDrop,Math.min(j(e.toChain),We(e.toChain,e.type))),s),s+=8,!e.cancelRelayerFee64||!e.refundRelayerFee64)throw new Error("Missing relayer fees");o.writeBigUInt64BE(BigInt(e.cancelRelayerFee64),s),s+=8,o.writeBigUInt64BE(BigInt(e.refundRelayerFee64),s),s+=8,o.writeBigUInt64BE(BigInt(e.deadline64),s),s+=8;let I=e.swiftVersion==="V2"?c:y,M=r?se.Buffer.from(Q(h(r,I))):Y.SystemProgram.programId.toBuffer();o.set(M,s),s+=32,o.writeUInt8(e.referrerBps||0,s),s+=1;let k=e.protocolBps||0;if(o.writeUInt8(k,s),s+=1,!e.swiftAuctionMode)throw new Error("Missing swift auction mode");o.writeUInt8(e.swiftAuctionMode,s),s+=1;let v=se.Buffer.from(Q(i));if(v.length!==32)throw new Error("Invalid random key length");if(o.set(v,s),s+=32,e.swiftVersion==="V2"){let F;a?F=se.Buffer.from(Q(Le.ethers.keccak256(se.Buffer.from(a)))):F=Y.SystemProgram.programId.toBuffer(),o.set(F,s),s+=32}if(s!==p)throw new Error(`Invalid order data size: ${s}`);let x=Le.ethers.keccak256(o);return se.Buffer.from(Q(x))}var sr=(0,q.struct)([(0,q.blob)(8,"instruction"),(0,q.blob)(8,"amountInMin"),(0,q.u8)("nativeInput"),(0,q.blob)(8,"feeSubmit"),(0,q.blob)(32,"destAddress"),(0,q.u16)("destinationChain"),(0,q.blob)(32,"tokenOut"),(0,q.blob)(8,"amountOutMin"),(0,q.blob)(8,"gasDrop"),(0,q.blob)(8,"feeCancel"),(0,q.blob)(8,"feeRefund"),(0,q.blob)(8,"deadline"),(0,q.blob)(32,"refAddress"),(0,q.u8)("feeRateRef"),(0,q.u8)("feeRateMayan"),(0,q.u8)("auctionMode"),(0,q.blob)(32,"randomKey")]);function fa(e){let{quote:t}=e,n=t.swiftInputContract===Le.ZeroAddress?Ce:new Y.PublicKey(t.swiftInputContract),r=_(t.toChain);if(r!==t.toToken.wChainId)throw new Error(`Destination chain ID mismatch: ${r} != ${t.toToken.wChainId}`);if(e.customPayload&&!e.customPayloadAccount)throw new Error("Custom payload account is required when custom payload is provided");let i=t.swiftVersion==="V2"?[{pubkey:e.trader,isWritable:!1,isSigner:!1},{pubkey:e.relayer,isWritable:!0,isSigner:!0},{pubkey:e.state,isWritable:!0,isSigner:!1},{pubkey:e.stateAccount,isWritable:!0,isSigner:!1},{pubkey:e.relayerAccount,isWritable:!0,isSigner:!1},{pubkey:e.customPayloadAccount||new Y.PublicKey(l.SWIFT_V2_PROGRAM_ID),isWritable:!1,isSigner:!1},{pubkey:n,isWritable:!1,isSigner:!1},{pubkey:new Y.PublicKey(l.FEE_MANAGER_PROGRAM_ID),isWritable:!1,isSigner:!1},{pubkey:e.tokenProgramId,isWritable:!1,isSigner:!1},{pubkey:Y.SystemProgram.programId,isWritable:!1,isSigner:!1}]:[{pubkey:e.trader,isWritable:!1,isSigner:!0},{pubkey:e.relayer,isWritable:!0,isSigner:!0},{pubkey:e.state,isWritable:!0,isSigner:!1},{pubkey:e.stateAccount,isWritable:!0,isSigner:!1},{pubkey:e.relayerAccount,isWritable:!0,isSigner:!1},{pubkey:n,isWritable:!1,isSigner:!1},{pubkey:new Y.PublicKey(l.FEE_MANAGER_PROGRAM_ID),isWritable:!1,isSigner:!1},{pubkey:new Y.PublicKey(l.TOKEN_PROGRAM_ID),isWritable:!1,isSigner:!1},{pubkey:Y.SystemProgram.programId,isWritable:!1,isSigner:!1}];i.forEach((u,d)=>{console.log(d,u.pubkey)});let a=se.Buffer.alloc(sr.span),p=t.swiftVersion==="V2"?_("solana"):r,o=e.referrerAddress?se.Buffer.from(Q(h(e.referrerAddress,p))):Y.SystemProgram.programId.toBuffer(),s;if(t.fromToken.contract===t.swiftInputContract)s=BigInt(t.effectiveAmountIn64);else{if(!t.minMiddleAmount)throw new Error("Missing min middle amount");s=w(t.minMiddleAmount,t.swiftInputDecimals)}if(t.toChain==="sui"&&!t.toToken.verifiedAddress)throw new Error("Missing verified address for SUI coin");if(!t.cancelRelayerFee64||!t.refundRelayerFee64)throw new Error("Missing relayer fees");let c=qe(t);if(!t.submitRelayerFee64)throw new Error("Missing submit relayer fee");return sr.encode({instruction:te("init_order"),amountInMin:B(s),nativeInput:t.swiftInputContract===Le.ZeroAddress?1:0,feeSubmit:B(BigInt(t.submitRelayerFee64)),destAddress:se.Buffer.from(Q(h(e.destinationAddress,r))),destinationChain:r,tokenOut:se.Buffer.from(Q(c)),amountOutMin:B(w(t.minAmountOut,Math.min(t.toToken.decimals,We(t.toChain,t.type)))),gasDrop:B(w(t.gasDrop,Math.min(j(t.toChain),We(t.toChain,t.type)))),feeCancel:B(BigInt(t.cancelRelayerFee64)),feeRefund:B(BigInt(t.refundRelayerFee64)),deadline:B(e.deadline),refAddress:o,feeRateRef:t.referrerBps,feeRateMayan:t.protocolBps,auctionMode:t.swiftAuctionMode,randomKey:e.randomKey.toBuffer()},a),new Y.TransactionInstruction({keys:i,data:a,programId:new Y.PublicKey(t.swiftVersion==="V2"?l.SWIFT_V2_PROGRAM_ID:l.SWIFT_PROGRAM_ID)})}async function cn(e,t,n,r,i,a={},p,o){if(e.type!=="SWIFT")throw new Error("Unsupported quote type for Swift: "+e.type);if(e.toChain===e.fromChain)throw new Error("Unsupported same chains: "+e.toChain);if(e.swiftVersion!=="V2"&&(e.toChain==="sui"||e.toChain==="ton"||e.toChain==="fogo"))throw new Error("Swift V2 is required for"+e.toChain);let s=e.swiftVersion,c=a.allowSwapperOffCurve||!1,u=[],d=[],f=[];f.push(Fe(e.fromChain));let m=[],y=[],b=[],g=Y.Keypair.generate(),T=null,I=new Y.PublicKey(t),M=new Y.PublicKey(dt(e));if(!Number(e.deadline64))throw new Error("Swift mode requires a timeout");let k=BigInt(e.deadline64);if(p&&!o)throw new Error("Custom payload account is required when custom payload is provided");let v=Pt(e,t,n,r,M.toBuffer().toString("hex"),p),x=se.Buffer.alloc(2);x.writeUInt16LE(_(e.toChain));let[F]=e.swiftVersion==="V2"?Y.PublicKey.findProgramAddressSync([se.Buffer.from("STATE_SOURCE"),v,x],new Y.PublicKey(l.SWIFT_V2_PROGRAM_ID)):Y.PublicKey.findProgramAddressSync([se.Buffer.from("STATE_SOURCE"),v],new Y.PublicKey(l.SWIFT_PROGRAM_ID)),P;e.swiftVersion==="V2"?P=e.swiftInputContractStandard==="spl2022"?new Y.PublicKey(l.TOKEN_2022_PROGRAM_ID):new Y.PublicKey(l.TOKEN_PROGRAM_ID):P=new Y.PublicKey(l.TOKEN_PROGRAM_ID),console.log({tokenProgramId:P});let L=e.swiftInputContract===Le.ZeroAddress?Ce:new Y.PublicKey(e.swiftInputContract),D=U(L,F,!0,P),V=e.gasless?new Y.PublicKey(e.relayer):I,J=U(L,V,!1,P);if(e.fromToken.contract===e.swiftInputContract)e.suggestedPriorityFee>0&&u.push(Y.ComputeBudgetProgram.setComputeUnitPrice({microLamports:e.suggestedPriorityFee})),u.push(A(re(V,D,F,L,P))),e.swiftInputContract===Le.ZeroAddress?u.push(A(Y.SystemProgram.transfer({fromPubkey:I,toPubkey:D,lamports:BigInt(e.effectiveAmountIn64)})),A(et(D))):u.push(A(Re(U(L,I,c,P),D,I,BigInt(e.effectiveAmountIn64),P)));else{if(!e.minMiddleAmount)throw new Error("Missing min middle amount for swap");let O=await ke({minMiddleAmount:e.minMiddleAmount,middleToken:e.swiftInputContract,userWallet:t,slippageBps:e.slippageBps,fromToken:e.fromToken.contract,amountIn64:e.effectiveAmountIn64,depositMode:e.gasless?"SWIFT_GASLESS":"SWIFT",fillMaxAccounts:a?.separateSwapTx||!1,tpmTokenAccount:a?.separateSwapTx?g.publicKey.toString():null,referrerAddress:r||void 0,chainName:e.fromChain,userLedger:F.toString()});if(e.swiftVersion!==s)throw new Error("Quote mutation is not allowed");let R=Oe(O,i,V);if(a?.separateSwapTx&&O.maxAccountsFilled){if(le(R,g.publicKey,I),b=await ve(i,V,L,I,g,P),e.swiftVersion!==s)throw new Error("Quote mutation is not allowed");y.push(...R.computeBudgetInstructions),R.setupInstructions&&y.push(...R.setupInstructions),y.push(R.swapInstruction),R.cleanupInstruction&&y.push(R.cleanupInstruction),m.push(...R.addressLookupTableAddresses),u.push(A(re(V,D,F,L,P))),u.push(A(Ke(I,L,g.publicKey,D,V,P)))}else le(R,D,I),u.push(...R.computeBudgetInstructions),R.setupInstructions&&u.push(...R.setupInstructions.map(W=>A(W))),u.push(R.swapInstruction),R.cleanupInstruction&&u.push(A(R.cleanupInstruction)),f.push(...R.addressLookupTableAddresses)}u.push(A(fa({quote:e,state:F,trader:I,stateAccount:D,randomKey:M,relayerAccount:J,relayer:V,destinationAddress:n,deadline:k,referrerAddress:r,tokenProgramId:P,customPayload:p,customPayloadAccount:o?new Y.PublicKey(o):void 0}),a.skipProxyMayanInstructions));let z=await Ee(f.concat(m),i);if(d=z.slice(0,f.length),y.length>0){let O=z.slice(f.length);T={messageV0:{payerKey:V,instructions:y,addressLookupTableAccounts:O},createTmpTokenAccountIxs:b,tmpTokenAccount:g}}if(console.log({randomKey:M.toBuffer().toString("hex"),hash:v.toString("hex")}),e.swiftVersion!==s)throw new Error("Quote mutation is not allowed");return{instructions:u,signers:[],lookupTables:d,swapMessageV0Params:T}}var mn=ht(require("bs58"));var ge=require("@solana/web3.js");var at=require("buffer");var E=require("@solana/web3.js"),K=require("@solana/buffer-layout");var de=require("buffer");var or=(0,K.struct)([(0,K.blob)(8,"instruction")]);function gt(e,t,n,r,i,a){let p=new E.PublicKey(l.TOKEN_PROGRAM_ID),o=new E.PublicKey(l.CCTPV2_CORE_PROGRAM_ID),s=new E.PublicKey(l.CCTPV2_TOKEN_PROGRAM_ID),c=new E.PublicKey(l.FAST_MCTP_PROGRAM_ID),u=new E.PublicKey(i),d=new E.PublicKey(r),f=U(d,e,!0),m;a&&a>BigInt(0)?m=U(d,u,!1):m=new E.PublicKey(l.FAST_MCTP_PROGRAM_ID);let y=Xt(d,n,e,t),b=E.Keypair.generate(),g=[{pubkey:e,isWritable:!0,isSigner:!1},{pubkey:f,isWritable:!0,isSigner:!1},{pubkey:u,isWritable:!0,isSigner:!0},{pubkey:m,isWritable:!0,isSigner:!1},{pubkey:d,isWritable:!0,isSigner:!1},{pubkey:y.realDenyListAccount,isWritable:!1,isSigner:!1},{pubkey:y.senderAuthority,isWritable:!1,isSigner:!1},{pubkey:y.cctpDenyListAccount,isWritable:!1,isSigner:!1},{pubkey:y.tokenMessenger,isWritable:!1,isSigner:!1},{pubkey:y.remoteTokenMessengerKey,isWritable:!1,isSigner:!1},{pubkey:y.tokenMinter,isWritable:!1,isSigner:!1},{pubkey:y.localToken,isWritable:!0,isSigner:!1},{pubkey:y.eventAuthToken,isWritable:!1,isSigner:!1},{pubkey:y.messageTransmitter,isWritable:!0,isSigner:!1},{pubkey:b.publicKey,isWritable:!0,isSigner:!0},{pubkey:o,isWritable:!1,isSigner:!1},{pubkey:s,isWritable:!1,isSigner:!1},{pubkey:p,isWritable:!1,isSigner:!1},{pubkey:E.SystemProgram.programId,isWritable:!1,isSigner:!1}],T=de.Buffer.alloc(or.span);return or.encode({instruction:te("bridge")},T),{instruction:new E.TransactionInstruction({keys:g,data:T,programId:c}),signers:[b]}}var ur=(0,K.struct)([(0,K.blob)(8,"instruction")]);function pr(e,t,n,r,i,a){let p=new E.PublicKey(l.TOKEN_PROGRAM_ID),o=new E.PublicKey(l.CCTPV2_CORE_PROGRAM_ID),s=new E.PublicKey(l.CCTPV2_TOKEN_PROGRAM_ID),c=new E.PublicKey(l.FAST_MCTP_PROGRAM_ID),u=new E.PublicKey(i),d=new E.PublicKey(r),f=U(d,e,!0),m=Xt(d,n,e,t),y=E.Keypair.generate(),b;a&&a>BigInt(0)?b=U(d,u,!1):b=new E.PublicKey(l.FAST_MCTP_PROGRAM_ID);let g=[{pubkey:e,isWritable:!1,isSigner:!1},{pubkey:f,isWritable:!0,isSigner:!1},{pubkey:u,isWritable:!0,isSigner:!0},{pubkey:b,isWritable:!0,isSigner:!1},{pubkey:d,isWritable:!0,isSigner:!1},{pubkey:m.realDenyListAccount,isWritable:!1,isSigner:!1},{pubkey:m.senderAuthority,isWritable:!1,isSigner:!1},{pubkey:m.cctpDenyListAccount,isWritable:!1,isSigner:!1},{pubkey:m.tokenMessenger,isWritable:!1,isSigner:!1},{pubkey:m.remoteTokenMessengerKey,isWritable:!1,isSigner:!1},{pubkey:m.tokenMinter,isWritable:!1,isSigner:!1},{pubkey:m.localToken,isWritable:!0,isSigner:!1},{pubkey:m.eventAuthToken,isWritable:!1,isSigner:!1},{pubkey:m.messageTransmitter,isWritable:!0,isSigner:!1},{pubkey:y.publicKey,isWritable:!0,isSigner:!0},{pubkey:o,isWritable:!1,isSigner:!1},{pubkey:s,isWritable:!1,isSigner:!1},{pubkey:p,isWritable:!1,isSigner:!1},{pubkey:E.SystemProgram.programId,isWritable:!1,isSigner:!1}],T=de.Buffer.alloc(ur.span);return ur.encode({instruction:te("create_order")},T),{instruction:new E.TransactionInstruction({keys:g,data:T,programId:c}),signer:y}}var cr=(0,K.struct)([(0,K.blob)(8,"instruction"),(0,K.blob)(32,"destAddress"),(0,K.blob)(8,"amountInMin"),(0,K.blob)(8,"gasDrop"),(0,K.blob)(8,"feeRedeem"),(0,K.blob)(8,"feeSolana"),(0,K.u32)("destDomain"),(0,K.blob)(32,"refAddress"),(0,K.u8)("feeRateRef"),(0,K.u16)("keyRnd"),(0,K.blob)(8,"maxCircleFee"),(0,K.u32)("minFinalityThreshold"),(0,K.u8)("mode")]);function bt(e){let t=new E.PublicKey(e.swapperAddress),n=new E.PublicKey(e.relayerAddress),r=new E.PublicKey(e.mintAddress),i=U(r,e.ledger,!0),a=_(e.toChain),p=de.Buffer.from(Q(h(e.destinationAddress,a))),o=B(e.amountInMin64),s=B(w(e.gasDrop,Math.min(j(e.toChain),8))),c=B(e.feeRedeem),u=B(e.feeSolana),d=B(e.maxCircleFee),f=e.referrerAddress?de.Buffer.from(Q(h(e.referrerAddress,a))):E.SystemProgram.programId.toBuffer(),m=fe(e.toChain),y=[{pubkey:t,isWritable:!0,isSigner:!0},{pubkey:e.ledger,isWritable:!0,isSigner:!1},{pubkey:n,isWritable:!0,isSigner:!0},{pubkey:i,isWritable:!1,isSigner:!1},{pubkey:e.customPayload||new E.PublicKey(l.FAST_MCTP_PROGRAM_ID),isWritable:!1,isSigner:!1},{pubkey:r,isWritable:!1,isSigner:!1},{pubkey:E.SystemProgram.programId,isWritable:!1,isSigner:!1}],b=de.Buffer.alloc(cr.span);return cr.encode({instruction:te("init_bridge_ledger"),destAddress:p,amountInMin:o,gasDrop:s,feeRedeem:c,feeSolana:u,destDomain:m,refAddress:f,feeRateRef:e.feeRateRef??0,keyRnd:e.randomKey,maxCircleFee:d,minFinalityThreshold:e.minFinalityThreshold,mode:1},b),new E.TransactionInstruction({keys:y,data:b,programId:new E.PublicKey(l.FAST_MCTP_PROGRAM_ID)})}var lr=(0,K.struct)([(0,K.blob)(8,"instruction"),(0,K.blob)(32,"destAddress"),(0,K.blob)(8,"amountInMin"),(0,K.blob)(8,"gasDrop"),(0,K.blob)(8,"feeRedeem"),(0,K.blob)(8,"feeRefund"),(0,K.blob)(8,"feeSolana"),(0,K.u32)("destDomain"),(0,K.u16)("keyRnd"),(0,K.u8)("mode"),(0,K.blob)(32,"tokenOut"),(0,K.blob)(8,"amountOutMin"),(0,K.blob)(8,"deadline"),(0,K.blob)(32,"refAddress"),(0,K.u8)("feeRateRef"),(0,K.blob)(8,"maxCircleFee"),(0,K.u32)("minFinalityThreshold")]);function dr(e){let t=new E.PublicKey(e.swapperAddress),n=new E.PublicKey(e.relayerAddress),r=new E.PublicKey(e.mintAddress),i=U(r,e.ledger,!0),a=_(e.toChain),p=fe(e.toChain),o=de.Buffer.from(Q(h(e.destinationAddress,a))),s=B(e.amountInMin64),c=B(w(e.gasDrop,Math.min(j(e.toChain),8))),u=B(e.feeRedeem),d=B(e.feeRefund),f=B(e.feeSolana),m=B(e.maxCircleFee),y=de.Buffer.from(Q(h(e.tokenOut,a))),b=e.referrerAddress?de.Buffer.from(Q(h(e.referrerAddress,a))):E.SystemProgram.programId.toBuffer(),g=B(w(e.amountOutMin,Math.min(8,e.tokenOutDecimals))),T=B(e.deadline),I=[{pubkey:t,isWritable:!0,isSigner:!0},{pubkey:e.ledger,isWritable:!0,isSigner:!1},{pubkey:n,isWritable:!0,isSigner:!0},{pubkey:i,isWritable:!1,isSigner:!1},{pubkey:r,isWritable:!1,isSigner:!1},{pubkey:E.SystemProgram.programId,isWritable:!1,isSigner:!1}],M=de.Buffer.alloc(lr.span);return lr.encode({instruction:te("init_order_ledger"),destAddress:o,amountInMin:s,gasDrop:c,feeRedeem:u,feeRefund:d,feeSolana:f,destDomain:p,keyRnd:e.randomKey,maxCircleFee:m,minFinalityThreshold:e.minFinalityThreshold,mode:2,tokenOut:y,amountOutMin:g,deadline:T,refAddress:b,feeRateRef:e.feeRateRef},M),new E.TransactionInstruction({keys:I,data:M,programId:new E.PublicKey(l.FAST_MCTP_PROGRAM_ID)})}async function mr(e,t,n,r,i,a={}){let p=a?.forceSkipCctpInstructions||!1,o=a?.allowSwapperOffCurve||!1;if(e.toChain==="solana")throw new Error("Unsupported destination chain: "+e.toChain);let s=e.relayer||t,c=[],u=[],d=[],f=[],m=[],y=[],b=[],g=E.Keypair.generate(),T=null;c.push(Fe(e.fromChain));let I=new E.PublicKey(l.FAST_MCTP_PROGRAM_ID),M=new E.PublicKey(t),k=new E.PublicKey(s),v=Math.floor(Math.random()*65e3),x=e.deadline64?BigInt(e.deadline64):BigInt(0);if(e.hasAuction&&!Number(e.deadline64))throw new Error("Swap mode requires a timeout");let F=e.hasAuction?"LEDGER_ORDER":"LEDGER_BRIDGE",[P]=E.PublicKey.findProgramAddressSync([de.Buffer.from(F),M.toBytes(),(()=>{let O=de.Buffer.alloc(2);return O.writeUInt16LE(v,0),O})()],I),L=U(new E.PublicKey(e.fastMctpInputContract),P,!0);if(e.toChain==="sui"&&!e.toToken.verifiedAddress)throw new Error("Missing verified address for SUI coin");let D=e.toChain==="sui"?e.toToken.verifiedAddress:e.toToken.contract;if(!D)throw new Error("Missing tokenOut address in quote");if(e.toChain==="sui")throw new Error("Fast MCTP does not support SUI as destination chain");if(a.customPayload&&e.hasAuction)throw new Error("Cannot use customPayload with create Fast Mctp swap");let V=null,J=Math.floor(Math.random()*65e3);if(a.customPayload&&(V=E.PublicKey.findProgramAddressSync([de.Buffer.from("PAYLOAD"),k.toBuffer(),(()=>{let O=de.Buffer.alloc(2);return O.writeUInt16LE(J,0),O})()],new E.PublicKey(l.PAYLOAD_WRITER_PROGRAM_ID))[0],u.push(A(Ye(k,V,de.Buffer.from(a.customPayload),J)))),!e.redeemRelayerFee64)throw new Error("Missing redeem relayer fee in quote");if(e.fromToken.contract===e.fastMctpInputContract){let O=BigInt(p?e.solanaRelayerFee64:0);if(e.suggestedPriorityFee>0&&u.push(E.ComputeBudgetProgram.setComputeUnitPrice({microLamports:e.suggestedPriorityFee})),u.push(A(re(k,L,P,new E.PublicKey(e.fastMctpInputContract)))),u.push(A(Re(U(new E.PublicKey(e.fastMctpInputContract),M,o),L,M,BigInt(e.effectiveAmountIn64)))),e.hasAuction){if(!e.refundRelayerFee64)throw new Error("Missing refund relayer fee in quote");if(u.push(A(dr({ledger:P,swapperAddress:t,mintAddress:e.fastMctpInputContract,randomKey:v,toChain:e.toChain,destinationAddress:n,feeSolana:O,feeRedeem:BigInt(e.redeemRelayerFee64),feeRefund:BigInt(e.refundRelayerFee64),gasDrop:e.gasDrop,amountInMin64:BigInt(e.effectiveAmountIn64),tokenOut:D,tokenOutDecimals:e.toToken.decimals,referrerAddress:r,amountOutMin:e.minAmountOut,deadline:x,feeRateRef:e.referrerBps||0,relayerAddress:s,maxCircleFee:BigInt(e.circleMaxFee64),minFinalityThreshold:e.fastMctpMinFinality}),a.skipProxyMayanInstructions)),!p){let{instruction:R,signer:W}=pr(P,M,e.toChain,e.fastMctpInputContract,s,O);u.push(A(R,a.skipProxyMayanInstructions)),d.push(W)}}else if(u.push(A(bt({ledger:P,swapperAddress:t,mintAddress:e.fastMctpInputContract,randomKey:v,toChain:e.toChain,destinationAddress:n,feeSolana:O,feeRedeem:BigInt(e.redeemRelayerFee64),gasDrop:e.gasDrop,amountInMin64:BigInt(e.effectiveAmountIn64),referrerAddress:r,relayerAddress:s,customPayload:V,feeRateRef:e.referrerBps||0,maxCircleFee:BigInt(e.circleMaxFee64),minFinalityThreshold:e.fastMctpMinFinality}),a.skipProxyMayanInstructions)),!p){let{instruction:R,signers:W}=gt(P,M,e.toChain,e.fastMctpInputContract,s,O);u.push(A(R,a.skipProxyMayanInstructions)),d.push(...W)}}else{if(!e.minMiddleAmount)throw new Error("Missing min middle amount in quote");let O=await ke({minMiddleAmount:e.minMiddleAmount,middleToken:e.fastMctpInputContract,userWallet:t,userLedger:P.toString(),slippageBps:e.slippageBps,fromToken:e.fromToken.contract,amountIn64:e.effectiveAmountIn64,depositMode:e.hasAuction?"FAST_MCTP_ORDER":"FAST_MCTP_BRIDGE",fillMaxAccounts:a?.separateSwapTx||!1,tpmTokenAccount:a?.separateSwapTx?g.publicKey.toString():null,referrerAddress:r||null,chainName:e.fromChain}),R=Oe(O,i,k);a?.separateSwapTx&&O.maxAccountsFilled?(le(R,g.publicKey,M),b=await ve(i,k,new E.PublicKey(e.fastMctpInputContract),M,g),y.push(...R.computeBudgetInstructions),R.setupInstructions&&y.push(...R.setupInstructions),y.push(R.swapInstruction),R.cleanupInstruction&&y.push(R.cleanupInstruction),m.push(...R.addressLookupTableAddresses),u.push(A(re(k,L,P,new E.PublicKey(e.fastMctpInputContract)))),u.push(A(Ke(M,new E.PublicKey(e.fastMctpInputContract),g.publicKey,L,k)))):(le(R,L,M),u.push(...R.computeBudgetInstructions),R.setupInstructions&&u.push(...R.setupInstructions.map(Z=>A(Z))),u.push(R.swapInstruction),R.cleanupInstruction&&u.push(A(R.cleanupInstruction)),c.push(...R.addressLookupTableAddresses));let W=y.length>0?BigInt(0):BigInt(e.solanaRelayerFee64);if(e.hasAuction){if(!e.refundRelayerFee64)throw new Error("Missing refund relayer fee in quote");if(u.push(A(dr({ledger:P,swapperAddress:t,mintAddress:e.fastMctpInputContract,randomKey:v,toChain:e.toChain,destinationAddress:n,feeSolana:W,feeRedeem:BigInt(e.redeemRelayerFee64),feeRefund:BigInt(e.refundRelayerFee64),gasDrop:e.gasDrop,amountInMin64:w(e.minMiddleAmount,$),tokenOut:D,tokenOutDecimals:e.toToken.decimals,referrerAddress:r,amountOutMin:e.minAmountOut,deadline:x,feeRateRef:e.referrerBps||0,relayerAddress:s,maxCircleFee:BigInt(e.circleMaxFee64),minFinalityThreshold:e.fastMctpMinFinality}),a.skipProxyMayanInstructions)),y.length>0){let{instruction:Z,signer:oe}=pr(P,M,e.toChain,e.fastMctpInputContract,s,W);u.push(A(Z,a.skipProxyMayanInstructions)),d.push(oe)}}else if(u.push(A(bt({ledger:P,swapperAddress:t,mintAddress:e.fastMctpInputContract,randomKey:v,toChain:e.toChain,destinationAddress:n,feeSolana:W,feeRedeem:BigInt(e.redeemRelayerFee64),gasDrop:e.gasDrop,amountInMin64:w(e.minMiddleAmount,$),referrerAddress:r,feeRateRef:e.referrerBps||0,relayerAddress:s,customPayload:V,maxCircleFee:BigInt(e.circleMaxFee64),minFinalityThreshold:e.fastMctpMinFinality}),a.skipProxyMayanInstructions)),y.length>0){let{instruction:Z,signers:oe}=gt(P,M,e.toChain,e.fastMctpInputContract,s,W);u.push(A(Z,a.skipProxyMayanInstructions)),d.push(...oe)}}V&&u.push(A(je(k,V,J)));let z=await Ee(c.concat(m),i);if(f=z.slice(0,c.length),y.length>0){let O=z.slice(c.length);T={messageV0:{payerKey:M,instructions:y,addressLookupTableAccounts:O},createTmpTokenAccountIxs:b,tmpTokenAccount:g}}return{instructions:u,signers:d,lookupTables:f,swapMessageV0Params:T}}async function ln(e,t,n,r,i,a={}){if(e.toToken.contract.toLowerCase()!==l.ARBITRUM_USDC_CONTRACT.toLowerCase()||e.type!=="MCTP"&&e.type!=="FAST_MCTP")throw new Error("Unsupported quote type for USDC deposit: "+e.type);if(!a?.usdcPermitSignature)throw new Error("USDC permit signature is required for this quote");if(!e.hyperCoreParams)throw new Error("HyperCore parameters are required for this quote");if(!Number(e.deadline64))throw new Error("HyperCore deposit requires timeout");let p=a.allowSwapperOffCurve||!1,o=[],s=[],c=[],u=[];u.push(Fe(e.fromChain));let d=[],f=[],m=[],y=ge.Keypair.generate(),b=null,g=new ge.PublicKey(t),T=e.relayer||t,I=new ge.PublicKey(e.hyperCoreParams.initiateTokenContract),M=Math.floor(Math.random()*65e3),[k]=ge.PublicKey.findProgramAddressSync([at.Buffer.from("PAYLOAD"),g.toBuffer(),(()=>{let z=at.Buffer.alloc(2);return z.writeUInt16LE(M,0),z})()],new ge.PublicKey(l.PAYLOAD_WRITER_PROGRAM_ID)),v=lt(e,n,a.usdcPermitSignature),x=ge.Keypair.generate(),F=new ge.PublicKey(l.MCTP_PROGRAM_ID),P=Math.floor(Math.random()*65e3),L=new ge.PublicKey(l.FAST_MCTP_PROGRAM_ID),D;if(e.type==="MCTP"){let[z]=ge.PublicKey.findProgramAddressSync([at.Buffer.from("LEDGER_BRIDGE"),g.toBytes(),x.publicKey.toBytes()],F);D=z}else if(e.type==="FAST_MCTP"){let[z]=ge.PublicKey.findProgramAddressSync([at.Buffer.from("LEDGER_BRIDGE"),g.toBytes(),(()=>{let O=at.Buffer.alloc(2);return O.writeUInt16LE(P,0),O})()],L);D=z}if(!D)throw new Error("Unsupported quote type for USDC deposit: "+e.type);let V=U(I,D,!0);if(e.fromToken.contract===e.hyperCoreParams.initiateTokenContract){if(e.suggestedPriorityFee>0&&o.push(ge.ComputeBudgetProgram.setComputeUnitPrice({microLamports:e.suggestedPriorityFee})),o.push(A(re(g,V,D,I))),o.push(A(Re(U(I,g,p),V,g,BigInt(e.hyperCoreParams.bridgeAmountUSDC64)))),o.push(A(Ye(g,k,v,M))),e.type==="MCTP"){o.push(A(rt({ledger:D,randomKey:x.publicKey,swapperAddress:g.toString(),mintAddress:I.toString(),mode:"WITH_FEE",feeSolana:BigInt(0),amountInMin64:BigInt(e.hyperCoreParams.bridgeAmountUSDC64),customPayload:k,destinationAddress:l.HC_ARBITRUM_DEPOSIT_PROCESSOR,referrerAddress:r,feeRedeem:0,gasDrop:e.hyperCoreParams.failureGasDrop,toChain:"arbitrum",relayerAddress:T}),a.skipProxyMayanInstructions));let{instruction:z,signers:O}=nt(D,"arbitrum",e.hyperCoreParams.initiateTokenContract,T,BigInt(0),e.fromChain);o.push(A(z,a.skipProxyMayanInstructions)),s.push(...O)}else if(e.type==="FAST_MCTP"){o.push(A(bt({ledger:D,randomKey:P,swapperAddress:g.toString(),mintAddress:I.toString(),feeSolana:BigInt(0),amountInMin64:BigInt(e.hyperCoreParams.bridgeAmountUSDC64),customPayload:k,destinationAddress:l.HC_ARBITRUM_DEPOSIT_PROCESSOR,referrerAddress:r,feeRedeem:BigInt(0),gasDrop:e.hyperCoreParams.failureGasDrop,toChain:"arbitrum",relayerAddress:T,feeRateRef:e.referrerBps||0,maxCircleFee:BigInt(e.circleMaxFee64),minFinalityThreshold:e.fastMctpMinFinality}),a.skipProxyMayanInstructions));let{instruction:z,signers:O}=gt(D,g,"arbitrum",e.hyperCoreParams.initiateTokenContract,T,BigInt(0));o.push(A(z,a.skipProxyMayanInstructions)),s.push(...O)}else throw new Error("Unsupported quote type for USDC deposit: "+e.type);o.push(A(je(g,k,M)))}else{if(!e.minMiddleAmount)throw new Error("minMiddleAmount is required for swap");let z=await ke({minMiddleAmount:e.minMiddleAmount,middleToken:e.hyperCoreParams.initiateTokenContract,userWallet:g.toString(),slippageBps:e.slippageBps,fromToken:e.fromToken.contract,amountIn64:e.effectiveAmountIn64,depositMode:"HC_USDC",fillMaxAccounts:a?.separateSwapTx||!1,tpmTokenAccount:y.publicKey.toString(),referrerAddress:r||void 0,chainName:e.fromChain,userLedger:D.toString(),quoteType:e.type}),O=Oe(z,i);if(a?.separateSwapTx&&z.maxAccountsFilled)le(O,y.publicKey,g),m=await ve(i,g,I,g,y),f.push(...O.computeBudgetInstructions),O.setupInstructions&&f.push(...O.setupInstructions),f.push(O.swapInstruction),O.cleanupInstruction&&f.push(O.cleanupInstruction),d.push(...O.addressLookupTableAddresses);else{le(O,y.publicKey,g),o.push(...O.computeBudgetInstructions);let Te=await ve(i,g,I,g,y);o.push(...Te.map(xe=>A(xe))),s.push(y),O.setupInstructions&&o.push(...O.setupInstructions.map(xe=>A(xe))),o.push(O.swapInstruction),O.cleanupInstruction&&o.push(A(O.cleanupInstruction)),u.push(...O.addressLookupTableAddresses)}let R=f.length>0?BigInt(0):BigInt(e.solanaRelayerFee64),W=BigInt(e.hyperCoreParams.bridgeAmountUSDC64);f.length>0&&(W=W-BigInt(e.solanaRelayerFee64)),o.push(A(re(g,V,D,I))),o.push(A(Re(y.publicKey,V,g,W)));let Z=U(I,g,p),oe=await i.getAccountInfo(Z);if((!oe||!oe.data)&&o.push(A(re(g,Z,g,I))),o.push(A(Ke(g,I,y.publicKey,Z,g))),o.push(A(Ye(g,k,v,M))),e.type==="MCTP")o.push(A(rt({ledger:D,swapperAddress:g.toString(),mintAddress:I.toString(),randomKey:x.publicKey,mode:"WITH_FEE",feeSolana:R,amountInMin64:W,customPayload:k,destinationAddress:l.HC_ARBITRUM_DEPOSIT_PROCESSOR,referrerAddress:r,feeRedeem:0,gasDrop:e.hyperCoreParams.failureGasDrop,toChain:"arbitrum",relayerAddress:T}),a.skipProxyMayanInstructions));else if(e.type==="FAST_MCTP")o.push(A(bt({ledger:D,randomKey:P,swapperAddress:g.toString(),mintAddress:I.toString(),feeSolana:R,amountInMin64:W,customPayload:k,destinationAddress:l.HC_ARBITRUM_DEPOSIT_PROCESSOR,referrerAddress:r,feeRedeem:BigInt(0),gasDrop:e.hyperCoreParams.failureGasDrop,toChain:"arbitrum",relayerAddress:T,feeRateRef:e.referrerBps||0,maxCircleFee:BigInt(e.circleMaxFee64),minFinalityThreshold:e.fastMctpMinFinality}),a.skipProxyMayanInstructions));else throw new Error("Unsupported quote type");if(o.push(A(je(g,k,M))),f.length>0)if(e.type==="MCTP"){let{instruction:Te,signers:xe}=nt(D,"arbitrum",e.hyperCoreParams.initiateTokenContract,T,BigInt(0),e.fromChain);o.push(A(Te,a.skipProxyMayanInstructions)),s.push(...xe)}else if(e.type==="FAST_MCTP"){let{instruction:Te,signers:xe}=gt(D,g,"arbitrum",e.hyperCoreParams.initiateTokenContract,T,BigInt(0));o.push(A(Te,a.skipProxyMayanInstructions)),s.push(...xe)}else throw new Error("Unsupported quote type")}let J=await Ee(u.concat(d),i);if(c=J.slice(0,u.length),f.length>0){let z=J.slice(u.length);b={messageV0:{payerKey:g,instructions:f,addressLookupTableAccounts:z},createTmpTokenAccountIxs:m,tmpTokenAccount:y}}return{instructions:o,signers:s,lookupTables:c,swapMessageV0Params:b}}var Ze=require("@solana/web3.js");var yr=require("ethers");async function dn(e,t,n,r,i,a={}){if(e.type!=="MONO_CHAIN")throw new Error("Unsupported quote type for mono chain: "+e.type);if(e.fromChain!=="solana")throw new Error("Unsupported destination chain for mono chain: "+e.fromChain);if(e.toChain!=="solana")throw new Error("Unsupported destination chain for mono chain: "+e.toChain);if(e.fromToken.contract===e.toToken.contract)throw new Error("From token and to token are the same: "+e.fromToken.contract);if(n.startsWith("0x"))throw new Error("Destination address should not be EVM address");try{new Ze.PublicKey(n)}catch{throw new Error("Invalid destination address: "+n)}let p=[],o=[],s=[],c=new Ze.PublicKey(t),u=new Ze.PublicKey(n),d=e.toToken.contract===yr.ZeroAddress?Ce:new Ze.PublicKey(e.toToken.contract),f=U(d,u,!0,e.toToken.standard==="spl2022"?new Ze.PublicKey(l.TOKEN_2022_PROGRAM_ID):new Ze.PublicKey(l.TOKEN_PROGRAM_ID)),m=w(e.expectedAmountOut,e.toToken.decimals),y=await ke({userWallet:t,destinationWallet:n,slippageBps:e.slippageBps,fromToken:e.fromToken.contract,middleToken:e.toToken.contract,amountIn64:e.effectiveAmountIn64,expectedAmountOut64:String(m),depositMode:"MONO_CHAIN",referrerAddress:r,referrerBps:e.referrerBps||0,chainName:e.fromChain}),b=Oe(y,i);return le(b,f,c,u,c.equals(u)),un(b.swapInstruction,e),p.push(...b.computeBudgetInstructions),b.setupInstructions&&p.push(...b.setupInstructions.map(g=>A(g))),p.push(b.swapInstruction),b.cleanupInstruction&&p.push(A(b.cleanupInstruction)),s.push(...b.addressLookupTableAddresses),s.push(Fe(e.fromChain)),o=await Ee(s,i),{instructions:p,signers:[],lookupTables:o,swapMessageV0Params:null}}var ga=420,fr=(0,ae.struct)([(0,ae.u8)("instruction"),(0,ae.u8)("stateNonce"),(0,ae.blob)(8,"amount"),(0,ae.blob)(8,"minAmountOut"),(0,ae.blob)(8,"deadline"),(0,ae.blob)(8,"feeSwap"),(0,ae.blob)(8,"feeReturn"),(0,ae.blob)(8,"feeCancel"),(0,ae.blob)(8,"gasDrop"),(0,ae.u16)("destinationChain"),(0,ae.blob)(32,"destinationAddress"),(0,ae.u8)("unwrapRedeem"),(0,ae.u8)("unwrapRefund"),(0,ae.u8)("mayanFeeNonce"),(0,ae.u8)("referrerFeeNonce")]);async function gr(e,t,n,r,i,a={}){let p=Qe(e,r);if(e.fromChain==="hypercore")throw new Error("HyperCore as source chain is not supported in Solana");if(e.toChain==="hypercore"){if(a.customPayload)throw new Error("Custom payload is not supported for HyperCore");return ln(e,t,n,p,i,a)}if(e.type==="MCTP")return pn(e,t,n,p,i,a);if(e.type==="SWIFT")return cn(e,t,n,p,i,a);if(e.type==="MONO_CHAIN"){if(a.customPayload)throw new Error("Custom payload is not supported for MONO_CHAIN yet");return dn(e,t,n,p,i,a)}if(e.type==="FAST_MCTP")return mr(e,t,n,p,i,a);if(a.customPayload)throw new Error("Custom payload is not supported for WH from Solana");let o=[],s=i??new N.Connection("https://rpc.ankr.com/solana"),c=new N.PublicKey(l.MAYAN_PROGRAM_ID),u=new N.PublicKey(l.TOKEN_PROGRAM_ID),d=new N.PublicKey(t),f=new N.PublicKey(l.AUCTION_PROGRAM_ID);e.suggestedPriorityFee>0&&o.push(N.ComputeBudgetProgram.setComputeUnitPrice({microLamports:e.suggestedPriorityFee}));let m;p?m=new N.PublicKey(p):m=N.SystemProgram.programId;let[y,b]=N.PublicKey.findProgramAddressSync([Ge.Buffer.from("MAYANFEE")],c),[g,T]=N.PublicKey.findProgramAddressSync([Ge.Buffer.from("REFERRERFEE"),m.toBuffer()],c),I=N.Keypair.generate(),M=N.Keypair.generate(),[k,v]=N.PublicKey.findProgramAddressSync([Ge.Buffer.from("V2STATE"),Ge.Buffer.from(I.publicKey.toBytes()),Ge.Buffer.from(M.publicKey.toBytes())],c),x=new N.PublicKey(e.fromToken.mint),F=new N.PublicKey(e.toToken.mint),P=U(x,d),L=U(x,k,!0),[[D,V],J,z]=await Promise.all([s.getMultipleAccountsInfo([P,L],"finalized"),s.getMinimumBalanceForRentExemption(ga),rn()]);(!D||D.data.length===0)&&o.push(re(d,P,d,x)),(!V||V.data.length===0)&&o.push(re(d,L,k,x)),e.fromToken.contract===Mt.ZeroAddress&&(o.push(N.SystemProgram.transfer({fromPubkey:d,toPubkey:P,lamports:BigInt(e.effectiveAmountIn64)})),o.push(et(P)));let O=BigInt(e.effectiveAmountIn64),R=N.Keypair.generate();o.push(nn(P,R.publicKey,d,O)),o.push(N.SystemProgram.transfer({fromPubkey:d,toPubkey:R.publicKey,lamports:J}));let W=[{pubkey:R.publicKey,isWritable:!1,isSigner:!0},{pubkey:I.publicKey,isWritable:!1,isSigner:!0},{pubkey:M.publicKey,isWritable:!1,isSigner:!0},{pubkey:k,isWritable:!0,isSigner:!1},{pubkey:P,isWritable:!0,isSigner:!1},{pubkey:d,isWritable:!1,isSigner:!1},{pubkey:L,isWritable:!0,isSigner:!1},{pubkey:x,isWritable:!1,isSigner:!1},{pubkey:F,isWritable:!1,isSigner:!1},{pubkey:f,isWritable:!1,isSigner:!1},{pubkey:m,isWritable:!1,isSigner:!1},{pubkey:y,isWritable:!1,isSigner:!1},{pubkey:g,isWritable:!1,isSigner:!1},{pubkey:R.publicKey,isWritable:!0,isSigner:!0},{pubkey:z,isWritable:!1,isSigner:!1},{pubkey:N.SYSVAR_CLOCK_PUBKEY,isWritable:!1,isSigner:!1},{pubkey:N.SYSVAR_RENT_PUBKEY,isWritable:!1,isSigner:!1},{pubkey:u,isWritable:!1,isSigner:!1},{pubkey:N.SystemProgram.programId,isWritable:!1,isSigner:!1}],Z=_(e.toChain);if(Z===1){let xt=await s.getAccountInfo(new N.PublicKey(n));if(xt&&xt.owner&&xt.owner.equals(u))throw new Error("Destination address is not about token account. It should be a owner address")}let oe=Ge.Buffer.from(Q(h(n,Z)));if(!e.mintDecimals)throw new Error("Mint decimals not provided");let Te=w(e.minAmountOut,e.mintDecimals.to),xe=w(e.swapRelayerFee,e.mintDecimals.from),Fr=w(e.redeemRelayerFee,e.mintDecimals.to),Dr=w(e.refundRelayerFee,e.mintDecimals.from),vr=w(e.gasDrop,Kt(e.toChain)),xr=e.toToken.contract===Mt.ZeroAddress,Br=e.fromToken.contract===Mt.ZeroAddress;if(!Number(e.deadline64))throw new Error("Deadline is not valid");let Nr=BigInt(e.deadline64),_n=Ge.Buffer.alloc(fr.span),Wr={instruction:101,stateNonce:v,amount:B(O),minAmountOut:B(Te),deadline:B(Nr),feeSwap:B(xe),feeReturn:B(Fr),feeCancel:B(Dr),gasDrop:B(vr),destinationChain:Z,destinationAddress:oe,unwrapRedeem:xr?1:0,unwrapRefund:Br?1:0,mayanFeeNonce:b,referrerFeeNonce:T};fr.encode(Wr,_n);let Ur=new N.TransactionInstruction({keys:W,data:_n,programId:c});return o.push(Ur),{instructions:o,signers:[R,I,M],lookupTables:[],swapMessageV0Params:null}}async function ba(e,t,n,r,i,a,p,o,s,c){let u=!!(!e.gasless&&s&&s.tipLamports>0&&s.signAllTransactions),d=[],f,m,y,{instructions:b,signers:g,lookupTables:T,swapMessageV0Params:I}=await gr(e,t,n,r,a,{allowSwapperOffCurve:c?.allowSwapperOffCurve,forceSkipCctpInstructions:c?.forceSkipCctpInstructions,separateSwapTx:u&&s?.separateSwapTx,usdcPermitSignature:c?.usdcPermitSignature,skipProxyMayanInstructions:c?.skipProxyMayanInstructions===!0,customPayload:c?.customPayload});if(e.gasless){f=new N.PublicKey(e.relayer);let{publicKey:F,nonce:P}=await zt(e.fromChain,t);d=[N.SystemProgram.nonceAdvance({noncePubkey:new N.PublicKey(F),authorizedPubkey:f}),...b],m=P,y=0}else{f=new N.PublicKey(t),d=b;let F=await a.getLatestBlockhash();m=F.blockhash,y=F.lastValidBlockHeight}let M=new N.PublicKey(t),k=N.MessageV0.compile({instructions:d,payerKey:f,recentBlockhash:m,addressLookupTableAccounts:T}),v=new N.VersionedTransaction(k);v.sign(g);let x;if(u&&!e.gasless){let F=[];if(I){if(!y)throw new Error("lastValidBlockHeight is missing");let J=new N.Transaction({feePayer:M,blockhash:m,lastValidBlockHeight:y}).add(...I.createTmpTokenAccountIxs);J.partialSign(I.tmpTokenAccount),F.push(J);let z=N.MessageV0.compile({...I.messageV0,recentBlockhash:m});F.push(new N.VersionedTransaction(z))}let P=an(t,m,y,s);F.push(v),F.push(P);let L=await s.signAllTransactions(F);x=L[L.length-2];let D=null,V="version"in x;if(V&&x.signatures[0]?D=mn.default.encode(Uint8Array.from(x.signatures[0])):!V&&x.signatures[0]?.publicKey&&(D=mn.default.encode(Uint8Array.from(x.signatures[0].signature))),D===null)throw new Error("Failed to get mayan tx hash");if(I){let J=await St(L,s,!0);return await sn(J,s,y,D,a),on(J),{signature:D,serializedTrx:null}}else St(L,s).then(()=>{console.log("Jito bundle sent")}).catch(()=>{})}else x=await i(v);if(e.gasless){let F=Ge.Buffer.from(x.serialize()).toString("base64"),{orderHash:P}=await $t(F,e.fromChain);return{signature:P,serializedTrx:null}}return await ft({trx:x.serialize(),connection:a,extraRpcs:p??[],errorChance:2,options:o})}var Tr=require("buffer");function yn(e,t,n,r,i,a){let p=ce(Number(i)),o=_(e.fromChain),s=_(e.toChain);if(o!==p)throw new Error(`Signer chain id(${Number(i)}) and quote from chain are not same! ${o} !== ${p}`);if(!e.swiftMayanContract)throw new Error("SWIFT contract address is missing");if(e.toToken.wChainId!==s)throw new Error(`Destination chain ID mismatch: ${s} != ${e.toToken.wChainId}`);if(e.swiftVersion!=="V2"&&e.toChain==="sui")throw new Error("Swift V2 is required for SUI chain");let c=e.swiftMayanContract;if(!Number(e.deadline64))throw new Error("Swift order requires timeout");let u=BigInt(e.deadline64),d=e.swiftInputContract,f=BigInt(e.effectiveAmountIn64),m,y=e.swiftVersion==="V2"?o:s;r?m=h(r,y):m=h(br.SystemProgram.programId.toString(),1);let b="0x"+dt(e).toString("hex");if(e.toChain==="sui"&&!e.toToken.verifiedAddress)throw new Error("Missing verified address for SUI coin");let g=qe(e),T=w(e.minAmountOut,Math.min(e.toToken.decimals,We(e.toChain,e.type))),I=w(e.gasDrop,Math.min(j(e.toChain),We(e.toChain,e.type)));if(!e.refundRelayerFee64||!e.cancelRelayerFee64)throw new Error("Swift order requires refund and cancel fees");let M=h(n,s);if(!e.swiftAuctionMode)throw new Error("Swift order requires auction mode");let k={payloadType:a?Je:$e,trader:h(t,o),tokenOut:g,minAmountOut:T,gasDrop:I,cancelFee:BigInt(e.cancelRelayerFee64),refundFee:BigInt(e.refundRelayerFee64),deadline:u,destAddr:M,destChainId:s,referrerAddr:m,referrerBps:e.referrerBps||0,auctionMode:e.swiftAuctionMode,random:b};return{contractAddress:c,tokenIn:d,amountIn:f,order:k,customPayload:a?`0x${Tr.Buffer.from(a).toString("hex")}`:"0x"}}async function fn(e,t,n,r,i,a,p){if(e.type!=="SWIFT")throw new Error("Quote type is not SWIFT");if(!Number.isFinite(Number(i)))throw new Error("Invalid signer chain id");if(!Number(e.deadline64))throw new Error("Swift order requires timeout");i=Number(i);let o=a||we,s=new Me.Contract(l.MAYAN_FORWARDER_CONTRACT,Ae.abi),{tokenIn:c,amountIn:u,order:d,contractAddress:f,customPayload:m}=yn(e,t,n,r,i,p),y,b=new Me.Contract(f,e.swiftVersion==="V2"?Un.abi:Kn.abi);e.swiftInputContract===Me.ZeroAddress?y=b.interface.encodeFunctionData("createOrderWithEth",e.swiftVersion==="V2"?[d,m]:[d]):y=b.interface.encodeFunctionData("createOrderWithToken",e.swiftVersion==="V2"?[c,u,d,m]:[c,u,d]);let g,T,I;if(e.fromToken.contract===e.swiftInputContract)e.fromToken.contract===Me.ZeroAddress?(g="forwardEth",T=[f,y],I=(0,Me.toBeHex)(u)):(g="forwardERC20",T=[c,u,o,f,y],I=(0,Me.toBeHex)(0));else{let{swapRouterCalldata:k,swapRouterAddress:v}=await Ue({forwarderAddress:l.MAYAN_FORWARDER_CONTRACT,slippageBps:e.slippageBps,referrerAddress:r,fromToken:e.fromToken.contract,middleToken:e.swiftInputContract,chainName:e.fromChain,amountIn64:e.effectiveAmountIn64});if(!e.minMiddleAmount)throw new Error("Swift swap requires middle amount, router address and calldata");let x=e.fromToken.contract,F=w(e.minMiddleAmount,e.swiftInputDecimals);e.fromToken.contract===Me.ZeroAddress?(g="swapAndForwardEth",T=[u,v,k,e.swiftInputContract,F,f,y],I=(0,Me.toBeHex)(u)):(g="swapAndForwardERC20",T=[x,u,o,v,k,e.swiftInputContract,F,f,y],I=(0,Me.toBeHex)(0))}return{data:s.interface.encodeFunctionData(g,T),to:l.MAYAN_FORWARDER_CONTRACT,value:I,chainId:i,_forwarder:{method:g,params:T}}}function wr(e,t,n){if(!Number.isFinite(Number(n)))throw new Error("Invalid signer chain id");if(!e.submitRelayerFee64)throw new Error("Swift gasless order requires submit relayer fee");if(!e.swiftMayanContract)throw new Error("Swift contract address is missing in quote");let r=BigInt(e.effectiveAmountIn64),i=BigInt(e.submitRelayerFee64);return{domain:{name:"Mayan Swift",chainId:Number(n),verifyingContract:e.swiftMayanContract},types:{CreateOrder:[{name:"OrderId",type:"bytes32"},{name:"InputAmount",type:"uint256"},{name:"SubmissionFee",type:"uint256"}]},value:{OrderId:t,InputAmount:r-i,SubmissionFee:i}}}function gn(e,t,n,r,i,a,p){if(e.type!=="SWIFT")throw new Error("Quote type is not SWIFT");if(!e.gasless)throw new Error("Quote does not support gasless");if(!Number.isFinite(Number(i)))throw new Error("Invalid signer chain id");if(!Number(e.deadline64))throw new Error("Swift order requires timeout");if(e.fromToken.contract!==e.swiftInputContract)throw new Error("Swift gasless order creation does not support source swap");if(!e.submitRelayerFee64)throw new Error("Swift gasless order requires submit relayer fee");let{tokenIn:o,amountIn:s,order:c,customPayload:u}=yn(e,t,n,r,Number(i),p),d=_(e.fromChain),m=`0x${Pt(e,t,n,r,c.random,p).toString("hex")}`,y=wr(e,m,i);return{swiftVersion:e.swiftVersion,permitParams:a,orderParams:{...c,sourceChainId:d,amountIn:s,tokenIn:o,submissionFee:BigInt(e.submitRelayerFee64)},orderHash:m,customPayload:u,orderTypedData:y}}var pe=require("ethers"),_t=require("@solana/web3.js");var bn={abi:[{type:"constructor",inputs:[{name:"_cctpTokenMessengerV2",type:"address",internalType:"address"},{name:"_feeManager",type:"address",internalType:"address"}],stateMutability:"nonpayable"},{type:"receive",stateMutability:"payable"},{type:"function",name:"bridge",inputs:[{name:"tokenIn",type:"address",internalType:"address"},{name:"amountIn",type:"uint256",internalType:"uint256"},{name:"redeemFee",type:"uint64",internalType:"uint64"},{name:"circleMaxFee",type:"uint256",internalType:"uint256"},{name:"gasDrop",type:"uint64",internalType:"uint64"},{name:"destAddr",type:"bytes32",internalType:"bytes32"},{name:"destDomain",type:"uint32",internalType:"uint32"},{name:"referrerAddress",type:"bytes32",internalType:"bytes32"},{name:"referrerBps",type:"uint8",internalType:"uint8"},{name:"payloadType",type:"uint8",internalType:"uint8"},{name:"minFinalityThreshold",type:"uint32",internalType:"uint32"},{name:"customPayload",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"cctpTokenMessengerV2",inputs:[],outputs:[{name:"",type:"address",internalType:"contract ITokenMessengerV2"}],stateMutability:"view"},{type:"function",name:"changeGuardian",inputs:[{name:"newGuardian",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"claimGuardian",inputs:[],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"createOrder",inputs:[{name:"tokenIn",type:"address",internalType:"address"},{name:"amountIn",type:"uint256",internalType:"uint256"},{name:"circleMaxFee",type:"uint256",internalType:"uint256"},{name:"destDomain",type:"uint32",internalType:"uint32"},{name:"minFinalityThreshold",type:"uint32",internalType:"uint32"},{name:"orderPayload",type:"tuple",internalType:"struct FastMCTP.OrderPayload",components:[{name:"payloadType",type:"uint8",internalType:"uint8"},{name:"destAddr",type:"bytes32",internalType:"bytes32"},{name:"tokenOut",type:"bytes32",internalType:"bytes32"},{name:"amountOutMin",type:"uint64",internalType:"uint64"},{name:"gasDrop",type:"uint64",internalType:"uint64"},{name:"redeemFee",type:"uint64",internalType:"uint64"},{name:"refundFee",type:"uint64",internalType:"uint64"},{name:"deadline",type:"uint64",internalType:"uint64"},{name:"referrerAddr",type:"bytes32",internalType:"bytes32"},{name:"referrerBps",type:"uint8",internalType:"uint8"}]}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"domainToCaller",inputs:[{name:"",type:"uint32",internalType:"uint32"}],outputs:[{name:"",type:"bytes32",internalType:"bytes32"}],stateMutability:"view"},{type:"function",name:"feeManager",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"fulfillOrder",inputs:[{name:"cctpMsg",type:"bytes",internalType:"bytes"},{name:"cctpSigs",type:"bytes",internalType:"bytes"},{name:"swapProtocol",type:"address",internalType:"address"},{name:"swapData",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"guardian",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"keyToMintRecipient",inputs:[{name:"",type:"bytes32",internalType:"bytes32"}],outputs:[{name:"",type:"bytes32",internalType:"bytes32"}],stateMutability:"view"},{type:"function",name:"nextGuardian",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"paused",inputs:[],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"redeem",inputs:[{name:"cctpMsg",type:"bytes",internalType:"bytes"},{name:"cctpSigs",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"refund",inputs:[{name:"cctpMsg",type:"bytes",internalType:"bytes"},{name:"cctpSigs",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"rescueEth",inputs:[{name:"amount",type:"uint256",internalType:"uint256"},{name:"to",type:"address",internalType:"address payable"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"rescueRedeem",inputs:[{name:"cctpMsg",type:"bytes",internalType:"bytes"},{name:"cctpSigs",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"rescueToken",inputs:[{name:"token",type:"address",internalType:"address"},{name:"amount",type:"uint256",internalType:"uint256"},{name:"to",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setDomainCallers",inputs:[{name:"domain",type:"uint32",internalType:"uint32"},{name:"caller",type:"bytes32",internalType:"bytes32"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setFeeManager",inputs:[{name:"_feeManager",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setMintRecipient",inputs:[{name:"destDomain",type:"uint32",internalType:"uint32"},{name:"tokenIn",type:"address",internalType:"address"},{name:"mintRecipient",type:"bytes32",internalType:"bytes32"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setPause",inputs:[{name:"_pause",type:"bool",internalType:"bool"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setWhitelistedMsgSenders",inputs:[{name:"sender",type:"address",internalType:"address"},{name:"isWhitelisted",type:"bool",internalType:"bool"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setWhitelistedSwapProtocols",inputs:[{name:"protocol",type:"address",internalType:"address"},{name:"isWhitelisted",type:"bool",internalType:"bool"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"whitelistedMsgSenders",inputs:[{name:"",type:"address",internalType:"address"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"whitelistedSwapProtocols",inputs:[{name:"",type:"address",internalType:"address"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"event",name:"OrderFulfilled",inputs:[{name:"sourceDomain",type:"uint32",indexed:!1,internalType:"uint32"},{name:"sourceNonce",type:"bytes32",indexed:!1,internalType:"bytes32"},{name:"amount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"OrderRefunded",inputs:[{name:"sourceDomain",type:"uint32",indexed:!1,internalType:"uint32"},{name:"sourceNonce",type:"bytes32",indexed:!1,internalType:"bytes32"},{name:"amount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"error",name:"AlreadySet",inputs:[]},{type:"error",name:"CallerNotSet",inputs:[]},{type:"error",name:"CctpReceiveFailed",inputs:[]},{type:"error",name:"DeadlineViolation",inputs:[]},{type:"error",name:"EthTransferFailed",inputs:[]},{type:"error",name:"InvalidAddress",inputs:[]},{type:"error",name:"InvalidAmountOut",inputs:[]},{type:"error",name:"InvalidGasDrop",inputs:[]},{type:"error",name:"InvalidMintRecipient",inputs:[]},{type:"error",name:"InvalidPayload",inputs:[]},{type:"error",name:"InvalidPayloadType",inputs:[]},{type:"error",name:"InvalidRedeemFee",inputs:[]},{type:"error",name:"InvalidRefundFee",inputs:[]},{type:"error",name:"MintRecipientNotSet",inputs:[]},{type:"error",name:"Paused",inputs:[]},{type:"error",name:"Unauthorized",inputs:[]},{type:"error",name:"UnauthorizedMsgSender",inputs:[]},{type:"error",name:"UnauthorizedSwapProtocol",inputs:[]}]};var Ar=require("buffer");function Ta(e,t,n,r,i){let a=ce(Number(r)),p=_(e.fromChain),o=_(e.toChain);if(p!==a)throw new Error(`Signer chain id(${Number(r)}) and quote from chain are not same! ${p} !== ${a}`);let s=h(t,o),c=w(e.redeemRelayerFee,$),u=w(e.gasDrop,Math.min(j(e.toChain),8)),d=BigInt(e.circleMaxFee64),f=BigInt(e.effectiveAmountIn64),m=fe(e.toChain),y;if(n?y=h(n,o):y=h(_t.SystemProgram.programId.toString(),_("solana")),!e.fastMctpMayanContract)throw new Error("FastMctp contract address is missing");let b=e.fastMctpMayanContract;return{tokenIn:e.fastMctpInputContract,amountIn:f,redeemFee:c,gasDrop:u,destAddr:s,destDomain:m,referrerAddr:y,referrerBps:e.referrerBps||0,payloadType:i?Vt:Gt,customPayload:i?`0x${Ar.Buffer.from(i).toString("hex")}`:"0x",minFinalityThreshold:Number(e.fastMctpMinFinality),circleMaxFee:d,contractAddress:b}}function Ir(e,t,n,r,i){let a=Ta(e,t,n,r,i),{contractAddress:p,tokenIn:o,amountIn:s,destAddr:c,redeemFee:u,gasDrop:d,circleMaxFee:f,referrerAddr:m,referrerBps:y,destDomain:b,customPayload:g,minFinalityThreshold:T,payloadType:I}=a,M=new pe.Contract(p,bn.abi),k,v;return k=M.interface.encodeFunctionData("bridge",[o,s,u,f,d,c,b,m,y,I,T,g]),v=(0,pe.toBeHex)(0),{to:p,data:k,value:v,_params:a}}function wa(e,t,n,r){let i=ce(Number(r)),a=_(e.fromChain),p=_(e.toChain);if(a!==i)throw new Error(`Signer chain id(${Number(r)}) and quote from chain are not same! ${a} !== ${i}`);if(!e.fastMctpMayanContract)throw new Error("Fast MCTP contract address is missing");let o=e.fastMctpMayanContract,s=h(t,p),c;n?c=h(n,p):c=h(_t.SystemProgram.programId.toString(),_("solana"));let u=w(e.redeemRelayerFee,$);if(!e.refundRelayerFee64)throw new Error("Refund relayer fee is missing in quote");let d=BigInt(e.refundRelayerFee64),f=BigInt(e.circleMaxFee64),m=w(e.gasDrop,Math.min(j(e.toChain),8)),y=fe(e.toChain),b=BigInt(e.effectiveAmountIn64),g=w(e.minAmountOut,Math.min(8,e.toToken.decimals)),T=BigInt(e.deadline64);if(e.toChain==="sui"&&!e.toToken.verifiedAddress)throw new Error("To token verified address is missing for SUI");let I=e.toToken.contract===pe.ZeroAddress?h(_t.SystemProgram.programId.toString(),_("solana")):h(e.toChain==="sui"?e.toToken.verifiedAddress:e.toToken.contract,e.toToken.wChainId);return{tokenIn:e.fastMctpInputContract,amountIn:b,circleMaxFee:f,destDomain:y,minFinalityThreshold:Number(e.fastMctpMinFinality),orderPayload:{payloadType:Ht,destAddr:s,tokenOut:I,amountOutMin:g,gasDrop:m,redeemFee:u,refundFee:d,deadline:T,referrerAddr:c,referrerBps:e.referrerBps||0},contractAddress:o}}function hr(e,t,n,r){let i=wa(e,t,n,r),{contractAddress:a,orderPayload:p,tokenIn:o,amountIn:s,circleMaxFee:c,destDomain:u,minFinalityThreshold:d}=i,m=new pe.Contract(a,bn.abi).interface.encodeFunctionData("createOrder",[o,s,c,u,d,p]),y=(0,pe.toBeHex)(0);return{to:a,data:m,value:y,_params:i}}async function Tn(e,t,n,r,i,a){if(e.type!=="FAST_MCTP")throw new Error("Quote type is not FAST_MCTP");if(!Number.isFinite(Number(r)))throw new Error("Invalid signer chain id");r=Number(r);let p=i||we,o=new pe.Contract(l.MAYAN_FORWARDER_CONTRACT,Ae.abi);if(e.fromToken.contract===e.fastMctpInputContract)if(e.hasAuction){if(!Number(e.deadline64))throw new Error("Fast Mctp order requires timeout");let s=hr(e,t,n,r),c="forwardERC20",u=[e.fromToken.contract,s._params.amountIn,p,s._params.contractAddress,s.data];return{data:o.interface.encodeFunctionData(c,u),to:l.MAYAN_FORWARDER_CONTRACT,value:(0,pe.toBeHex)(0),chainId:r,_forwarder:{method:c,params:u}}}else{let s=Ir(e,t,n,r,a),c="forwardERC20",u=[e.fromToken.contract,s._params.amountIn,p,s._params.contractAddress,s.data];return{data:o.interface.encodeFunctionData(c,u),to:l.MAYAN_FORWARDER_CONTRACT,value:(0,pe.toBeHex)(0),chainId:r,_forwarder:{method:c,params:u}}}else{let{minMiddleAmount:s}=e;if(!s)throw new Error("Fast Mctp swap requires middle amount, router address and calldata");let{swapRouterCalldata:c,swapRouterAddress:u}=await Ue({forwarderAddress:l.MAYAN_FORWARDER_CONTRACT,fromToken:e.fromToken.contract,middleToken:e.fastMctpInputContract,slippageBps:e.slippageBps,referrerAddress:n||void 0,amountIn64:e.effectiveAmountIn64,chainName:e.fromChain});if(e.hasAuction){if(!Number(e.deadline64))throw new Error("Fast Mctp order requires timeout");let d=hr(e,t,n,r);if(!e.minMiddleAmount)throw new Error("minMiddleAmount is required for Fast MCTP swap");let f=w(e.minMiddleAmount,$);if(e.fromToken.contract===pe.ZeroAddress){let m="swapAndForwardEth",y=[d._params.amountIn,u,c,e.fastMctpInputContract,f,d._params.contractAddress,d.data];return{data:o.interface.encodeFunctionData(m,y),to:l.MAYAN_FORWARDER_CONTRACT,value:(0,pe.toBeHex)(d._params.amountIn),chainId:r,_forwarder:{method:m,params:y}}}else{let m="swapAndForwardERC20",y=[e.fromToken.contract,d._params.amountIn,p,u,c,e.fastMctpInputContract,f,d._params.contractAddress,d.data];return{data:o.interface.encodeFunctionData(m,y),to:l.MAYAN_FORWARDER_CONTRACT,value:(0,pe.toBeHex)(0),chainId:r,_forwarder:{method:m,params:y}}}}else{let d=Ir(e,t,n,r,a);if(!e.minMiddleAmount)throw new Error("minMiddleAmount is required for Fast MCTP swap");let f=w(e.minMiddleAmount,$);if(e.fromToken.contract===pe.ZeroAddress){let m="swapAndForwardEth",y=[d._params.amountIn,u,c,e.fastMctpInputContract,f,d._params.contractAddress,d.data];return{data:o.interface.encodeFunctionData(m,y),to:l.MAYAN_FORWARDER_CONTRACT,value:(0,pe.toBeHex)(d._params.amountIn),chainId:r,_forwarder:{method:m,params:y}}}else{let m="swapAndForwardERC20",y=[e.fromToken.contract,d._params.amountIn,p,u,c,e.fastMctpInputContract,f,d._params.contractAddress,d.data];return{data:o.interface.encodeFunctionData(m,y),to:l.MAYAN_FORWARDER_CONTRACT,value:(0,pe.toBeHex)(0),chainId:r,_forwarder:{method:m,params:y}}}}}}var _e=require("ethers"),Cr=require("@solana/web3.js");var wn={abi:[{type:"constructor",inputs:[{name:"_hcProcessor",type:"address",internalType:"address"},{name:"_usdc",type:"address",internalType:"address"}],stateMutability:"nonpayable"},{type:"function",name:"changeGuardian",inputs:[{name:"newGuardian",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"claimGuardian",inputs:[],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"deposit",inputs:[{name:"tokenIn",type:"address",internalType:"address"},{name:"amountIn",type:"uint256",internalType:"uint256"},{name:"trader",type:"address",internalType:"address"},{name:"gasDrop",type:"uint64",internalType:"uint64"},{name:"bridgeAmount",type:"uint256",internalType:"uint256"},{name:"depositPayload",type:"tuple",internalType:"struct HCDepositInitiator.DepositPayload",components:[{name:"relayerFee",type:"uint64",internalType:"uint64"},{name:"permit",type:"tuple",internalType:"struct IHCBridge.DepositWithPermit",components:[{name:"user",type:"address",internalType:"address"},{name:"usd",type:"uint64",internalType:"uint64"},{name:"deadline",type:"uint64",internalType:"uint64"},{name:"signature",type:"tuple",internalType:"struct IHCBridge.Signature",components:[{name:"r",type:"uint256",internalType:"uint256"},{name:"s",type:"uint256",internalType:"uint256"},{name:"v",type:"uint8",internalType:"uint8"}]}]}]}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"fastDeposit",inputs:[{name:"tokenIn",type:"address",internalType:"address"},{name:"amountIn",type:"uint256",internalType:"uint256"},{name:"trader",type:"address",internalType:"address"},{name:"circleMaxFee",type:"uint256",internalType:"uint256"},{name:"gasDrop",type:"uint64",internalType:"uint64"},{name:"referrerAddress",type:"bytes32",internalType:"bytes32"},{name:"referrerBps",type:"uint8",internalType:"uint8"},{name:"minFinalityThreshold",type:"uint32",internalType:"uint32"},{name:"bridgeAmount",type:"uint256",internalType:"uint256"},{name:"depositPayload",type:"tuple",internalType:"struct HCDepositInitiator.DepositPayload",components:[{name:"relayerFee",type:"uint64",internalType:"uint64"},{name:"permit",type:"tuple",internalType:"struct IHCBridge.DepositWithPermit",components:[{name:"user",type:"address",internalType:"address"},{name:"usd",type:"uint64",internalType:"uint64"},{name:"deadline",type:"uint64",internalType:"uint64"},{name:"signature",type:"tuple",internalType:"struct IHCBridge.Signature",components:[{name:"r",type:"uint256",internalType:"uint256"},{name:"s",type:"uint256",internalType:"uint256"},{name:"v",type:"uint8",internalType:"uint8"}]}]}]}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"fastMCTP",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"guardian",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"mayanCircle",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"nextGuardian",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"setFastMCTP",inputs:[{name:"_fastMCTP",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setMayanCircle",inputs:[{name:"_mayanCircle",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"error",name:"AlreadySet",inputs:[]},{type:"error",name:"InsufficientAmount",inputs:[]},{type:"error",name:"Unauthorized",inputs:[]}]};var In=require("buffer");function Ia(e,t,n,r){if(!e.hyperCoreParams)throw new Error("HyperCore parameters are missing");if(!e.hyperCoreParams.initiateContractAddress)throw new Error("HyperCore initiate contract address is missing");if(e.type!=="MCTP")throw new Error("Unsupported quote type for HyperCore deposit: "+e.type);let i=new _e.Contract(e.hyperCoreParams.initiateContractAddress,wn.abi),a=In.Buffer.from(Q(r));if(a.length!==65)throw new Error("Invalid USDC permit signature length");let p="0x"+a.subarray(0,32).toString("hex"),o="0x"+a.subarray(32,64).toString("hex"),s=a[64],c,u;return c=i.interface.encodeFunctionData("deposit",[e.hyperCoreParams.initiateTokenContract,BigInt(e.hyperCoreParams.bridgeAmountUSDC64),t,w(e.hyperCoreParams.failureGasDrop,Math.min(j("arbitrum"),8)),BigInt(e.hyperCoreParams.bridgeAmountUSDC64),{relayerFee:w(e.redeemRelayerFee,$),permit:{user:n,usd:BigInt(e.hyperCoreParams.depositAmountUSDC64),deadline:BigInt(e.deadline64),signature:{r:p,s:o,v:s}}}]),u=(0,_e.toBeHex)(0),{to:e.hyperCoreParams.initiateContractAddress,data:c,value:u,_params:{amountIn:BigInt(e.hyperCoreParams.bridgeAmountUSDC64),contractAddress:e.hyperCoreParams.initiateContractAddress}}}function ha(e,t,n,r,i){let a=_("arbitrum");if(!e.hyperCoreParams)throw new Error("HyperCore parameters are missing");if(!e.hyperCoreParams.initiateContractAddress)throw new Error("HyperCore initiate contract address is missing");if(e.type!=="FAST_MCTP")throw new Error("Unsupported quote type for HyperCore deposit: "+e.type);let p=new _e.Contract(e.hyperCoreParams.initiateContractAddress,wn.abi),o=In.Buffer.from(Q(i));if(o.length!==65)throw new Error("Invalid USDC permit signature length");let s="0x"+o.subarray(0,32).toString("hex"),c="0x"+o.subarray(32,64).toString("hex"),u=o[64],d;r?d=h(r,a):d=h(Cr.SystemProgram.programId.toString(),_("solana"));let f,m;return f=p.interface.encodeFunctionData("fastDeposit",[e.hyperCoreParams.initiateTokenContract,BigInt(e.hyperCoreParams.bridgeAmountUSDC64),t,BigInt(e.circleMaxFee64),w(e.hyperCoreParams.failureGasDrop,Math.min(j("arbitrum"),8)),d,e.referrerBps,Number(e.fastMctpMinFinality),BigInt(e.hyperCoreParams.bridgeAmountUSDC64),{relayerFee:w(e.redeemRelayerFee,$),permit:{user:n,usd:BigInt(e.hyperCoreParams.depositAmountUSDC64),deadline:BigInt(e.deadline64),signature:{r:s,s:c,v:u}}}]),m=(0,_e.toBeHex)(0),{to:e.hyperCoreParams.initiateContractAddress,data:f,value:m,_params:{amountIn:BigInt(e.hyperCoreParams.bridgeAmountUSDC64),contractAddress:e.hyperCoreParams.initiateContractAddress}}}async function hn(e,t,n,r,i,a,p,o={}){if(e.toToken.contract.toLowerCase()!==l.ARBITRUM_USDC_CONTRACT.toLowerCase()||e.type!=="MCTP"&&e.type!=="FAST_MCTP")throw new Error("Unsupported quote type for USDC deposit: "+e.type);if(!o?.usdcPermitSignature)throw new Error("USDC permit signature is required for this quote");if(!e.hyperCoreParams)throw new Error("HyperCore parameters are required for this quote");if(p)throw new Error("HyperCore deposit does not support payload");if(!Number.isFinite(Number(i)))throw new Error("Invalid signer chain id");let s=ce(Number(i)),c=_(e.fromChain);if(c!==s)throw new Error(`Signer chain id(${Number(i)}) and quote from chain are not same! ${c} !== ${s}`);let u=a||we,d=new _e.Contract(l.MAYAN_FORWARDER_CONTRACT,Ae.abi),f;if(!Number(e.deadline64))throw new Error("HyperCore deposit requires timeout");if(e.type==="MCTP")f=Ia(e,t,n,o.usdcPermitSignature);else if(e.type==="FAST_MCTP")f=ha(e,t,n,r,o.usdcPermitSignature);else throw new Error("Unsupported quote type for HyperCore deposit: "+e.type);if(e.fromToken.contract.toLowerCase()===e.hyperCoreParams.initiateTokenContract.toLowerCase()){let m="forwardERC20",y=[e.fromToken.contract,BigInt(e.effectiveAmountIn64),u,f._params.contractAddress,f.data];return{data:d.interface.encodeFunctionData(m,y),to:l.MAYAN_FORWARDER_CONTRACT,value:(0,_e.toBeHex)(0),chainId:i,_forwarder:{method:m,params:y}}}else{let{swapRouterCalldata:m,swapRouterAddress:y}=await Ue({fromToken:e.fromToken.contract,middleToken:e.hyperCoreParams.initiateTokenContract,chainName:e.fromChain,amountIn64:e.effectiveAmountIn64,referrerAddress:r,slippageBps:e.slippageBps,forwarderAddress:l.MAYAN_FORWARDER_CONTRACT});if(!e.minMiddleAmount)throw new Error("Fast Mctp swap requires middle amount, router address and calldata");let b=w(e.minMiddleAmount,$);if(e.fromToken.contract===_e.ZeroAddress){let g="swapAndForwardEth",T=[BigInt(e.effectiveAmountIn64),y,m,e.hyperCoreParams.initiateTokenContract,b,f._params.contractAddress,f.data];return{data:d.interface.encodeFunctionData(g,T),to:l.MAYAN_FORWARDER_CONTRACT,value:(0,_e.toBeHex)(BigInt(e.effectiveAmountIn64)),chainId:i,_forwarder:{method:g,params:T}}}else{let g="swapAndForwardERC20",T=[e.fromToken.contract,BigInt(e.effectiveAmountIn64),u,y,m,e.hyperCoreParams.initiateTokenContract,b,f._params.contractAddress,f.data];return{data:d.interface.encodeFunctionData(g,T),to:l.MAYAN_FORWARDER_CONTRACT,value:(0,_e.toBeHex)(0),chainId:i,_forwarder:{method:g,params:T}}}}}var be=require("ethers");var Sr={abi:[{type:"constructor",inputs:[{name:"_forwarderAddress",type:"address",internalType:"address"}],stateMutability:"nonpayable"},{type:"receive",stateMutability:"payable"},{type:"function",name:"ForwarderAddress",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"MAX_REFERRER_BPS",inputs:[],outputs:[{name:"",type:"uint8",internalType:"uint8"}],stateMutability:"view"},{type:"function",name:"changeGuardian",inputs:[{name:"newGuardian",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"claimGuardian",inputs:[],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"guardian",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"nextGuardian",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"rescueETH",inputs:[{name:"to",type:"address",internalType:"address"},{name:"amount",type:"uint256",internalType:"uint256"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"rescueToken",inputs:[{name:"token",type:"address",internalType:"address"},{name:"to",type:"address",internalType:"address"},{name:"amount",type:"uint256",internalType:"uint256"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"transferEth",inputs:[{name:"to",type:"address",internalType:"address"},{name:"referrerAddr",type:"address",internalType:"address"},{name:"referrerBps",type:"uint8",internalType:"uint8"}],outputs:[],stateMutability:"payable"},{type:"function",name:"transferToken",inputs:[{name:"token",type:"address",internalType:"address"},{name:"amount",type:"uint256",internalType:"uint256"},{name:"to",type:"address",internalType:"address"},{name:"referrerAddr",type:"address",internalType:"address"},{name:"referrerBps",type:"uint8",internalType:"uint8"}],outputs:[],stateMutability:"nonpayable"},{type:"event",name:"EthTransferred",inputs:[{name:"to",type:"address",indexed:!1,internalType:"address"},{name:"amount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"TokenTransferred",inputs:[{name:"token",type:"address",indexed:!1,internalType:"address"},{name:"to",type:"address",indexed:!1,internalType:"address"},{name:"amount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"error",name:"InvalidReferrerBps",inputs:[]},{type:"error",name:"Unauthorized",inputs:[]}]};function Aa(e,t,n){let r=w(e.expectedAmountOut,e.toToken.decimals),i=new be.Contract(e.monoChainMayanContract,Sr.abi),a=n&&e.referrerBps||0,p,o;return e.toToken.contract===be.ZeroAddress?p=i.interface.encodeFunctionData("transferEth",[t,n||be.ZeroAddress,a]):p=i.interface.encodeFunctionData("transferToken",[e.toToken.contract,r,t,n||be.ZeroAddress,a]),e.fromToken.contract===be.ZeroAddress?o=(0,be.toBeHex)(e.effectiveAmountIn64):o=(0,be.toBeHex)(0),{to:e.monoChainMayanContract,data:p,value:o,_params:{amountIn:BigInt(e.effectiveAmountIn64),tokenIn:e.fromToken.contract}}}function An(e,t,n,r,i){if(e.type!=="MONO_CHAIN")throw new Error("Quote type is not MONO_CHAIN");if(e.fromChain!==e.toChain)throw new Error("Quote chains are not equal");if(e.fromToken.contract.toLowerCase()===e.toToken.contract.toLowerCase())throw new Error(`From token and to token are the same: ${e.fromToken.contract}`);if(!Number.isFinite(Number(r)))throw new Error("Invalid signer chain id");let a=ce(Number(r)),p=_(e.fromChain);if(p!==a)throw new Error(`Signer chain id(${Number(r)}) and quote from chain are not same! ${p} !== ${a}`);r=Number(r);let o=i||we,s=new be.Contract(l.MAYAN_FORWARDER_CONTRACT,Ae.abi),{evmSwapRouterAddress:c,evmSwapRouterCalldata:u}=e;if(!c||!u)throw new Error("Mono chain swap requires router address and calldata");let d=Aa(e,t,n),f=w(e.minAmountOut,e.toToken.decimals);if(e.fromToken.contract===be.ZeroAddress){let m="swapAndForwardEth",y=[d._params.amountIn,c,u,e.toToken.contract,f,e.monoChainMayanContract,d.data];return{data:s.interface.encodeFunctionData(m,y),to:l.MAYAN_FORWARDER_CONTRACT,value:(0,be.toBeHex)(d._params.amountIn),chainId:r,_forwarder:{method:m,params:y}}}else{let m="swapAndForwardERC20",y=[e.fromToken.contract,d._params.amountIn,o,c,u,e.toToken.contract,f,e.monoChainMayanContract,d.data];return{data:s.interface.encodeFunctionData(m,y),to:l.MAYAN_FORWARDER_CONTRACT,value:(0,be.toBeHex)(0),chainId:r,_forwarder:{method:m,params:y}}}}function Ca(e,t,n,r,i,a){let p=new it.PublicKey(l.MAYAN_PROGRAM_ID),[o]=it.PublicKey.findProgramAddressSync([Cn.Buffer.from("MAIN")],p),s=U(new it.PublicKey(e.fromToken.mint),o,!0),c=BigInt(e.effectiveAmountIn64),u=h(s.toString(),1),d=h(l.AUCTION_PROGRAM_ID,1),f;n?f=h(n,1):f=h(it.SystemProgram.programId.toString(),1);let m=ce(Number(i)),y=_(e.fromChain),b=_(e.toChain);if(y!==m)throw new Error(`Signer chain id(${Number(i)}) and quote from chain are not same! ${y} !== ${m}`);let g=e.whMayanContract,T={mayanAddr:u,mayanChainId:1,destAddr:h(t,b),destChainId:b,auctionAddr:d,referrer:f,refundAddr:h(r,m)},I=e.toToken.contract===Ve.ZeroAddress,M={transferDeadline:BigInt(e.deadline64),swapDeadline:BigInt(e.deadline64),amountOutMin:w(e.minAmountOut,Math.min(8,e.toToken.decimals)),gasDrop:w(e.gasDrop,Math.min(8,j(e.toChain))),unwrap:I,customPayload:a?`0x${Cn.Buffer.from(a).toString("hex")}`:"0x"},k={swapFee:w(e.swapRelayerFee,Math.min(8,e.fromToken.decimals)),redeemFee:w(e.redeemRelayerFee,Math.min(8,e.toToken.decimals)),refundFee:w(e.refundRelayerFee,Math.min(8,e.fromToken.decimals))};if(!e.toToken.realOriginContractAddress||!e.toToken.realOriginChainId)throw new Error("Missing toToken real origin contract address");let v=h(e.toToken.realOriginContractAddress,e.toToken.realOriginChainId),x=w(e.bridgeFee,18);return{amountIn:c,tokenIn:e.fromToken.contract,tokenOut:v,tokenOutWChainId:e.toToken.realOriginChainId,criteria:M,recipient:T,relayerFees:k,contractAddress:g,bridgeFee:x}}async function Tt(e,t,n,r,i,a,p,o,s){let c=ce(Number(a)),u=_(e.fromChain);if(u!==c)throw new Error(`Signer chain id(${Number(a)}) and quote from chain are not same! ${u} !== ${c}`);let d=Qe(e,r);if(e.toChain==="hypercore")return hn(e,t,n,d,a,o,p,s);if(e.type==="MCTP")return en(e,n,d,a,o,p);if(e.type==="SWIFT")return fn(e,t,n,d,a,o,p);if(e.type==="SHUTTLE")throw new Error("SHUTTLE quote type is not supported on EVM");if(e.type==="FAST_MCTP")return Tn(e,n,d,a,o,p);if(e.type==="MONO_CHAIN")return An(e,n,d,a,o);if(e.type!="WH")throw new Error("Unsupported quote type");if(!Number(e.deadline64))throw new Error("WH mode requires a timeout");let{relayerFees:f,recipient:m,tokenOut:y,tokenOutWChainId:b,criteria:g,tokenIn:T,amountIn:I,contractAddress:M,bridgeFee:k}=Ca(e,n,d,i,a,p),v=new Ve.Contract(l.MAYAN_FORWARDER_CONTRACT,Ae.abi),x=new Ve.Contract(M,xn.abi),F,P,L,D=o||we;if(T===Ve.ZeroAddress){let J=x.interface.encodeFunctionData("wrapAndSwapETH",[f,m,y,b,g]);F="forwardEth",P=[M,J],L=(0,Ve.toBeHex)(I)}else{let J=x.interface.encodeFunctionData("swap",[f,m,y,b,g,T,I]);F="forwardERC20",P=[T,I,D,M,J],L=(0,Ve.toBeHex)(k)}let V=v.interface.encodeFunctionData(F,P);return{to:l.MAYAN_FORWARDER_CONTRACT,data:V,value:L,chainId:a,_forwarder:{method:F,params:P}}}async function Sa(e,t,n,r,i,a,p,o,s){if(!i.provider)throw new Error("No provider found for signer");let c=await i.getAddress();if(c.toLowerCase()!==t.toLowerCase())throw new Error("Signer address does not match swapper address");let u=Number((await i.provider.getNetwork()).chainId);if(e.type==="SWIFT"&&e.gasless&&e.toChain!=="hypercore"){let f=Qe(e,r),m=gn(e,t,n,f,u,a,o),y=await i.signTypedData(m.orderTypedData.domain,m.orderTypedData.types,m.orderTypedData.value);return await jt(m,y),m.orderHash}let d=await Tt(e,t,n,r,c,u,o,a,s);if(delete d._forwarder,p?.gasPrice&&(d.gasPrice=p.gasPrice),p?.maxFeePerGas&&(d.maxFeePerGas=p.maxFeePerGas),p?.maxPriorityFeePerGas&&(d.maxPriorityFeePerGas=p.maxPriorityFeePerGas),p?.gasLimit)d.gasLimit=p.gasLimit;else{let f=await i.estimateGas(d);d.gasLimit=String(BigInt(String(f))*BigInt(110)/BigInt(100))}return d.chainId=At(e.fromChain),i.sendTransaction(d)}async function Pa(e,t,n,r,i){let a=await n.getAddress(),p=e.toChain==="solana"?"ENsytooJVSZyNHbxvueUeX8Am8gcNqPivVVE8USCBiy5":"0x1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a",o=Number((await n.provider.getNetwork()).chainId);if(e.type==="SWIFT"&&e.gasless)return BigInt(0);let s=await Tt(e,t,p,null,a,o,i,r);delete s._forwarder;let c=await n.estimateGas(s);return c=BigInt(String(c)),e.type==="MCTP"||e.type==="SWIFT"?c*BigInt(110)/BigInt(100):c}async function Ma(e,t,n,r){let i="0x1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a",a=e.toChain==="solana"?"ENsytooJVSZyNHbxvueUeX8Am8gcNqPivVVE8USCBiy5":"0x1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a",p=e?.fromToken?.chainId;if(e.type==="SWIFT"&&e.gasless)return BigInt(0);let o=await Tt(e,i,a,null,i,p,r,n);return delete o._forwarder,t.estimateGas(o)}async function _a(e,t){let n="0x1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a",r=e.toChain==="solana"?"ENsytooJVSZyNHbxvueUeX8Am8gcNqPivVVE8USCBiy5":e.toChain==="sui"?"0xcde6dbe01902be1f200ff03dbbd149e586847be8cee15235f82750d9b06c0e04":"0x1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a",i=At(e.fromChain);if(e.type==="SWIFT"&&e.gasless)return{estimateGas:BigInt(0),gasPrice:BigInt(0),requiredNative:BigInt(0)};let a=await Tt(e,n,r,null,n,i,t,void 0),{gasPrice:p,estimatedGas:o}=await Jt({from:n,chainId:i,tokenIn:e.fromToken.contract,value:"0x"+BigInt(String(a.value)).toString(16),data:a.data,to:a.to});return{estimateGas:o*BigInt(110)/BigInt(100),gasPrice:p,requiredNative:p*o}}async function wt(e,t){let n;try{n=await t.getMoveFunctionArgTypes({package:e.package,module:e.module,function:e.function})}catch{throw new Error(`Failed to fetch ${e.package}::${e.module}::${e.function} ArgTypes`)}if(n){if(n[e.argumentIndex]!=="Pure"&&n[e.argumentIndex]?.Object!=="ByImmutableReference")throw new Error(`Argument ${e.argumentIndex} of ${e.module}::${e.function} is not immutable`)}else throw new Error(`Failed to fetch package::${e.module}::${e.function} ArgTypes`)}async function kt(e,t){let n=[],r=BigInt(0),i;do{let a=await t.getCoins({...e,owner:e.walletAddress,cursor:i}),p=a.data.filter(o=>BigInt(o.balance)>BigInt(0));if(n=[...n,...p],p.forEach(o=>{r+=BigInt(o.balance)}),a.data.length===0||!a.hasNextPage||!a.nextCursor||r>=e.coinAmount)return{coins:n.sort((o,s)=>Number(BigInt(o.coinObjectId)-BigInt(s.coinObjectId))),sum:r};i=a.nextCursor}while(!0)}async function He(e,t){let n;try{n=await t.getObject({id:e,options:{showContent:!0}})}catch(r){throw new Error(`Failed to fetch Mayan Sui package ID: 

 ${r}`)}if(n.data?.content?.fields?.latest_package_id)return n.data.content.fields.latest_package_id;throw new Error("latest_package_id not found in Mayan Sui state object")}async function De(e,t,n,r,i,a){let p;if(a?.result)p=a.result;else if(a?.objectId)p=i.object(a.objectId);else{let{coins:o,sum:s}=await kt({walletAddress:t,coinType:n,coinAmount:e},r);if(s<e)throw new Error(`Insufficient funds to create Coin ${n} with amount ${e}`);o.length>1&&i.mergeCoins(o[0].coinObjectId,o.slice(1).map(u=>u.coinObjectId));let[c]=i.splitCoins(o[0].coinObjectId,[e]);p=c}return p}var st=require("@mysten/sui/transactions"),Et=require("@mysten/sui/utils");var Rt=require("@solana/web3.js");var Pr=require("ethers");async function Sn(e,t,n,r,i,a,p){if(!e.fromToken.verifiedAddress)throw new Error("from token verified address is not provided");let[o,s]=await Promise.all([He(l.SUI_MCTP_STATE,a),e.hasAuction?He(l.SUI_MCTP_FEE_MANAGER_STATE,a):null]),c,u,d=null;if(e.fromToken.contract===e.mctpInputContract)c=p?.builtTransaction??new st.Transaction,u=await De(BigInt(e.effectiveAmountIn64),t,e.mctpInputContract,a,c,p?.inputCoin);else{let{tx:y,outCoin:b,whFeeCoin:g}=await ze({amountIn64:e.effectiveAmountIn64,inputCoinType:e.fromToken.contract,middleCoinType:e.mctpInputContract,userWallet:t,withWhFee:e.hasAuction||e.cheaperChain!=="sui",referrerAddress:r,inputCoin:p?.inputCoin,transaction:p?.builtTransaction?await p.builtTransaction.toJSON():void 0,slippageBps:e.slippageBps,chainName:e.fromChain});c=st.Transaction.from(y),u=b,d=g?{result:g}:null}if(e.hasAuction){if(!s)throw new Error("Fee manager package ID is not found for swap quote");await kr(e,t,n,r,o,s,a,{inputCoin:{result:u},whFeeCoin:d,builtTransaction:c})}else e.cheaperChain==="sui"?await _r(e,t,n,o,a,{inputCoin:{result:u},whFeeCoin:d,builtTransaction:c}):await Mr(e,t,n,o,i,a,{inputCoin:{result:u},whFeeCoin:d,builtTransaction:c});let f=BigInt(e.effectiveAmountIn64),m=i?Uint8Array.from(i):Uint8Array.from([]);c.moveCall({package:o,module:"init_order",function:"log_initialize_mctp",typeArguments:[e.fromToken.contract],arguments:[c.pure.u64(f),c.object(e.fromToken.verifiedAddress),c.pure.vector("u8",m)]});try{let y;r?y=h(r,_(e.toChain)):y=h(Rt.SystemProgram.programId.toString(),_("solana")),c.moveCall({package:l.SUI_LOGGER_PACKAGE_ID,module:"referrer_logger",function:"log_referrer",arguments:[c.pure.address(y),c.pure.u8(e.referrerBps||0)]})}catch(y){console.error("Failed to log referrer",y)}return c}async function Mr(e,t,n,r,i,a,p){return Ot({swapperAddress:t,destinationAddress:n,toChain:e.toChain,effectiveAmountIn64:e.effectiveAmountIn64,minMiddleAmount:e.minMiddleAmount,mctpPackageId:r,fromToken:e.fromToken,mctpInputContract:e.mctpInputContract,gasDrop:e.gasDrop,redeemRelayerFee:e.redeemRelayerFee,mctpVerifiedInputAddress:e.mctpVerifiedInputAddress,mctpInputTreasury:e.mctpInputTreasury,bridgeFee:e.bridgeFee,payload:i,suiClient:a,options:p})}async function _r(e,t,n,r,i,a){let p=_(e.toChain),o=a?.builtTransaction??new st.Transaction,s;if(e.fromToken.contract===e.mctpInputContract)s=BigInt(e.effectiveAmountIn64);else{if(!e.minMiddleAmount)throw new Error("minMiddleAmount is required for bridge locked fee when fromToken is different than mctpInputContract");s=w(e.minMiddleAmount,$)}let c=await De(BigInt(e.effectiveAmountIn64),t,e.mctpInputContract,i,o,a?.inputCoin),u=h(n,p),d=fe(e.toChain),f=w(e.gasDrop,Math.min(j(e.toChain),8)),m=w(e.redeemRelayerFee,$),[y]=o.moveCall({package:r,module:"bridge_locked_fee",function:"prepare_bridge_locked_fee",typeArguments:[e.mctpInputContract],arguments:[c,o.pure.u64(s),o.pure.address(u),o.pure.u32(d),o.pure.u64(f),o.pure.u64(m)]}),[b,g]=o.moveCall({package:r,module:"bridge_locked_fee",function:"bridge_locked_fee",typeArguments:[e.mctpInputContract],arguments:[o.object(l.SUI_MCTP_STATE),o.object(l.SUI_CCTP_CORE_STATE),o.object(e.mctpVerifiedInputAddress),y]}),[T,I]=o.moveCall({package:l.SUI_CCTP_TOKEN_PACKAGE_ID,module:"deposit_for_burn",function:"deposit_for_burn_with_caller_with_package_auth",typeArguments:[e.mctpInputContract,`${r}::bridge_locked_fee::CircleAuth`],arguments:[g,o.object(l.SUI_CCTP_TOKEN_STATE),o.object(l.SUI_CCTP_CORE_STATE),o.object("0x403"),o.object(e.mctpInputTreasury)]});return o.moveCall({package:r,module:"bridge_locked_fee",function:"store_bridge_locked_fee",typeArguments:[e.mctpInputContract],arguments:[o.object(l.SUI_MCTP_STATE),o.object(e.mctpVerifiedInputAddress),b,I]}),o}async function kr(e,t,n,r,i,a,p,o){let s=_(e.toChain),c=o?.builtTransaction??new st.Transaction,u;if(e.fromToken.contract===e.mctpInputContract)u=BigInt(e.effectiveAmountIn64);else{if(!e.minMiddleAmount)throw new Error("minMiddleAmount is required for init order when fromToken is different than mctpInputContract");u=w(e.minMiddleAmount,$)}let[d]=await Promise.all([De(BigInt(e.effectiveAmountIn64),t,e.mctpInputContract,p,c,o?.inputCoin),wt({package:a,module:"calculate_mctp_fee",function:"prepare_calc_mctp_fee",argumentIndex:3},p)]),f=e.toToken.contract===Pr.ZeroAddress?h(Rt.SystemProgram.programId.toString(),_("solana")):h(e.toToken.contract,e.toToken.wChainId),m=w(e.minAmountOut,Math.min(8,e.toToken.decimals)),y=h(n,s),b=fe(e.toChain),g=w(e.gasDrop,Math.min(j(e.toChain),8)),T=w(e.redeemRelayerFee,$),I=BigInt(e.deadline64),M;r?M=h(r,s):M=h(Rt.SystemProgram.programId.toString(),_("solana"));let k=[c.object(e.mctpVerifiedInputAddress),c.pure.u8(Lt),c.pure.address(t),d,c.pure.address(y),c.pure.u16(s),c.pure.address(f),c.pure.u64(m),c.pure.u64(g),c.pure.u64(T),c.pure.u64(I),c.pure.address(M),c.pure.u8(e.referrerBps||0)],[v]=c.moveCall({package:a,module:"calculate_mctp_fee",function:"prepare_calc_mctp_fee",typeArguments:[e.mctpInputContract],arguments:k}),[x]=c.moveCall({package:a,module:"calculate_mctp_fee",function:"calculate_mctp_fee",arguments:[c.object(l.SUI_MCTP_FEE_MANAGER_STATE),v]}),[F]=c.moveCall({package:i,module:"init_order",function:"prepare_initialize_order",typeArguments:[e.mctpInputContract],arguments:[...k.slice(1),c.pure.u32(b),c.pure.u64(u)]}),[P,L]=c.moveCall({package:i,module:"init_order",function:"initialize_order",typeArguments:[e.mctpInputContract],arguments:[c.object(l.SUI_MCTP_STATE),c.object(l.SUI_CCTP_CORE_STATE),c.object(e.mctpVerifiedInputAddress),F,x]}),[D,V]=c.moveCall({package:l.SUI_CCTP_TOKEN_PACKAGE_ID,module:"deposit_for_burn",function:"deposit_for_burn_with_caller_with_package_auth",typeArguments:[e.mctpInputContract,`${i}::init_order::CircleAuth`],arguments:[L,c.object(l.SUI_CCTP_TOKEN_STATE),c.object(l.SUI_CCTP_CORE_STATE),c.object("0x403"),c.object(e.mctpInputTreasury)]}),[J]=c.moveCall({package:i,module:"init_order",function:"publish_init_order",arguments:[c.object(l.SUI_MCTP_STATE),P,V]});return await Rr(c,J,p,BigInt(e.bridgeFee),t,o?.whFeeCoin),c}async function Rr(e,t,n,r,i,a){let p;if(a?.result)p=a.result;else if(a?.objectId)p=e.object(a.objectId);else if(r>BigInt(0)){let{coins:o,sum:s}=await kt({walletAddress:i,coinType:Et.SUI_TYPE_ARG,coinAmount:r},n);if(s<r)throw new Error("Insufficient funds to pay Wormhole message fee");o.length>1&&e.mergeCoins(o[0].coinObjectId,o.slice(1).map(u=>u.coinObjectId));let[c]=e.splitCoins(o[0].coinObjectId,[r]);p=c}else{let[o]=e.splitCoins(e.gas,[e.pure.u64(0)]);p=o}return e.moveCall({package:l.SUI_WORMHOLE_PACKAGE_ID,module:"publish_message",function:"publish_message",arguments:[e.object(l.SUI_WORMHOLE_STATE),p,t,e.object(Et.SUI_CLOCK_OBJECT_ID)]}),e}async function Ot(e){let{swapperAddress:t,destinationAddress:n,mctpPackageId:r,payload:i,suiClient:a,options:p}=e,o=_(e.toChain),s=p?.builtTransaction??new st.Transaction,c;if(e.fromToken.contract===e.mctpInputContract)c=BigInt(e.effectiveAmountIn64);else{if(!e.minMiddleAmount)throw new Error("minMiddleAmount is required for bridge with fee when fromToken is different than mctpInputContract");c=w(e.minMiddleAmount,$)}let u=await De(BigInt(e.effectiveAmountIn64),t,e.mctpInputContract,a,s,p?.inputCoin),d=i?ct:pt,f=h(n,o),m=fe(e.toChain),y=w(e.gasDrop,Math.min(j(e.toChain),8)),b=w(e.redeemRelayerFee,$),g=i?Uint8Array.from(i):Uint8Array.from([]),[T]=s.moveCall({package:r,module:"bridge_with_fee",function:"prepare_bridge_with_fee",typeArguments:[e.mctpInputContract],arguments:[s.pure.u8(d),u,s.pure.u64(c),s.pure.address(f),s.pure.u32(m),s.pure.u64(y),s.pure.u64(b),s.pure.vector("u8",g)]}),[I,M]=s.moveCall({package:r,module:"bridge_with_fee",function:"bridge_with_fee",typeArguments:[e.mctpInputContract],arguments:[s.object(l.SUI_MCTP_STATE),s.object(l.SUI_CCTP_CORE_STATE),s.object(e.mctpVerifiedInputAddress),T]}),[k,v]=s.moveCall({package:l.SUI_CCTP_TOKEN_PACKAGE_ID,module:"deposit_for_burn",function:"deposit_for_burn_with_caller_with_package_auth",typeArguments:[e.mctpInputContract,`${r}::bridge_with_fee::CircleAuth`],arguments:[M,s.object(l.SUI_CCTP_TOKEN_STATE),s.object(l.SUI_CCTP_CORE_STATE),s.object("0x403"),s.object(e.mctpInputTreasury)]}),[x]=s.moveCall({package:r,module:"bridge_with_fee",function:"publish_bridge_with_fee",arguments:[s.object(l.SUI_MCTP_STATE),I,v]});return await Rr(s,x,a,BigInt(e.bridgeFee),t,p?.whFeeCoin),s}var Pn=require("@mysten/sui/transactions");var Er=require("@solana/web3.js");async function Mn(e,t,n,r,i,a){if(e.toToken.contract.toLowerCase()!==l.ARBITRUM_USDC_CONTRACT.toLowerCase()||e.type!=="MCTP")throw new Error("Unsupported quote type for USDC deposit: "+e.type);if(!e.hyperCoreParams)throw new Error("HyperCore parameters are required for this quote");if(!a?.usdcPermitSignature)throw new Error("USDC permit signature is required for this quote");if(!Number(e.deadline64))throw new Error("HyperCore deposit requires timeout");let[p]=await Promise.all([He(l.SUI_MCTP_STATE,i)]),o,s,c=null;if(e.fromToken.contract===e.hyperCoreParams.initiateTokenContract)o=a?.builtTransaction??new Pn.Transaction,s=await De(BigInt(e.hyperCoreParams.bridgeAmountUSDC64),t,e.mctpInputContract,i,o,a?.inputCoin);else{let{tx:m,outCoin:y,whFeeCoin:b}=await ze({amountIn64:e.effectiveAmountIn64,inputCoinType:e.fromToken.contract,middleCoinType:e.hyperCoreParams.initiateTokenContract,userWallet:t,withWhFee:!0,referrerAddress:r,inputCoin:a?.inputCoin,transaction:a?.builtTransaction?await a.builtTransaction.toJSON():void 0,chainName:"sui",slippageBps:e.slippageBps});o=Pn.Transaction.from(m);let[g]=o.splitCoins(y,[BigInt(e.hyperCoreParams.bridgeAmountUSDC64)]);o.transferObjects([y],o.pure.address(t)),s=g,c=b?{result:b}:null}let u=lt(e,n,a.usdcPermitSignature);await Ot({swapperAddress:t,destinationAddress:l.HC_ARBITRUM_DEPOSIT_PROCESSOR,mctpPackageId:p,toChain:"arbitrum",effectiveAmountIn64:e.effectiveAmountIn64,minMiddleAmount:Wt(e.hyperCoreParams.bridgeAmountUSDC64,$),bridgeFee:e.bridgeFee,gasDrop:e.hyperCoreParams.failureGasDrop,fromToken:e.fromToken,mctpInputContract:e.mctpInputContract,mctpInputTreasury:e.mctpInputTreasury,mctpVerifiedInputAddress:e.mctpVerifiedInputAddress,redeemRelayerFee:0,payload:u,suiClient:i,options:{inputCoin:{result:s},whFeeCoin:c,builtTransaction:o}});let d=BigInt(e.effectiveAmountIn64),f=Uint8Array.from(u);if(!e.fromToken.verifiedAddress)throw new Error("From token verified address is required from Sui");o.moveCall({package:p,module:"init_order",function:"log_initialize_mctp",typeArguments:[e.fromToken.contract],arguments:[o.pure.u64(d),o.object(e.fromToken.verifiedAddress),o.pure.vector("u8",f)]});try{let m;r?m=h(r,_("arbitrum")):m=h(Er.SystemProgram.programId.toString(),_("solana")),o.moveCall({package:l.SUI_LOGGER_PACKAGE_ID,module:"referrer_logger",function:"log_referrer",arguments:[o.pure.address(m),o.pure.u8(e.referrerBps||0)]})}catch(m){console.error("Failed to log referrer",m)}return o}var Dt=require("@mysten/sui/transactions");var Ft=require("buffer"),ot=require("@solana/web3.js");var vt=require("ethers");async function Or(e,t,n,r,i,a,p){if(!e.fromToken.verifiedAddress||!e.swiftVerifiedInputAddress)throw new Error("from token or swift input verified address is not provided");let[o,s]=await Promise.all([He(l.SUI_SWIFT_STATE,a),He(l.SUI_SWIFT_FEE_MANAGER_STATE,a)]),c,u;if(e.fromToken.contract===e.swiftInputContract)c=p?.builtTransaction??new Dt.Transaction,u=await De(BigInt(e.effectiveAmountIn64),t,e.swiftInputContract,a,c,p?.inputCoin);else{let{tx:m,outCoin:y}=await ze({amountIn64:e.effectiveAmountIn64,inputCoinType:e.fromToken.contract,middleCoinType:e.swiftInputContract,userWallet:t,withWhFee:!1,referrerAddress:r,inputCoin:p?.inputCoin,transaction:p?.builtTransaction?await p.builtTransaction.toJSON():void 0,slippageBps:e.slippageBps,chainName:e.fromChain});c=Dt.Transaction.from(m),u=y}await ka(e,t,n,r,o,s,i,a,{inputCoin:{result:u},builtTransaction:c,randomKey:p?.randomKey});let d=BigInt(e.effectiveAmountIn64),f=i?Uint8Array.from(i):Uint8Array.from([]);return c.moveCall({package:o,module:"init_order",function:"log_initialize_order",typeArguments:[e.fromToken.contract],arguments:[c.pure.u64(d),c.object(e.fromToken.verifiedAddress),c.pure.vector("u8",f)]}),c}async function ka(e,t,n,r,i,a,p,o,s){let c=_(e.toChain),u=s?.builtTransaction??new Dt.Transaction,d=e.fromToken.contract===e.swiftInputContract?BigInt(e.effectiveAmountIn64):w(e.minMiddleAmount,e.swiftInputDecimals),[f]=await Promise.all([De(BigInt(e.effectiveAmountIn64),t,e.swiftInputContract,o,u,s?.inputCoin),wt({package:a,module:"calculate_swift_fee",function:"prepare_calc_swift_fee",argumentIndex:3},o)]),m=e.toToken.contract===vt.ZeroAddress?h(ot.SystemProgram.programId.toString(),_("solana")):h(e.toToken.contract,e.toToken.wChainId),y=w(e.minAmountOut,Math.min(8,e.toToken.decimals)),b=h(n,c),g=w(e.gasDrop,Math.min(j(e.toChain),8)),T=BigInt(e.cancelRelayerFee64),I=BigInt(e.refundRelayerFee64),M=BigInt(e.deadline64),k;r?k=h(r,_("sui")):k=h(ot.SystemProgram.programId.toString(),_("solana"));let v=p?Je:$e,x;p?x=Ft.Buffer.from(Q(vt.ethers.keccak256(Ft.Buffer.from(p)))):x=ot.SystemProgram.programId.toBuffer();let F=[u.pure.u8(v),u.pure.address(t),u.object(e.swiftVerifiedInputAddress),f,u.pure.address(b),u.pure.u16(c),u.pure.address(m),u.pure.u64(y),u.pure.u64(g),u.pure.u64(T),u.pure.u64(I),u.pure.u64(M),u.pure.address(k),u.pure.u8(e.referrerBps),u.pure.u8(e.swiftAuctionMode)],[P]=u.moveCall({package:a,module:"calculate_swift_fee",function:"prepare_calc_swift_fee",typeArguments:[e.swiftInputContract],arguments:F}),[L]=u.moveCall({package:a,module:"calculate_swift_fee",function:"calculate_swift_fee",arguments:[u.object(l.SUI_SWIFT_FEE_MANAGER_STATE),P]}),D=s?.randomKey?Ft.Buffer.from(s.randomKey):ot.Keypair.generate().publicKey.toBuffer(),[V]=u.moveCall({package:i,module:"init_order",function:"prepare_initialize_order",typeArguments:[e.swiftInputContract],arguments:[F[0],F[1],F[3],u.pure.u64(d),...F.slice(4),u.pure.address("0x"+D.toString("hex")),u.pure.address("0x"+x.toString("hex"))]}),[J,z]=u.moveCall({package:i,module:"init_order",function:"initialize_order",typeArguments:[e.swiftInputContract],arguments:[u.object(l.SUI_SWIFT_STATE),u.object(e.swiftVerifiedInputAddress),V,L]});return u}async function Ra(e,t,n,r,i,a,p){let o=Qe(e,r);if(e.toChain==="hypercore"){if(!e.hyperCoreParams)throw new Error("HyperCore parameters are required for this quote");if(!p?.usdcPermitSignature)throw new Error("USDC permit signature is required for this quote");if(e.type!=="MCTP")throw new Error("Unsupported quote type for HyperCore deposit: "+e.type);if(i)throw new Error("Payload is not supported for HyperCore deposit quotes");return Mn(e,t,n,o,a,p)}if(e.type==="MCTP")return Sn(e,t,n,o,i,a,p);throw e.type==="SWIFT"?new Error("SWIFT swaps are not supported to Sui chain yet"):new Error("Unsupported quote type from Sui chain")}0&&(module.exports={FAST_MCTP_PAYLOAD_TYPE_CUSTOM_PAYLOAD,FAST_MCTP_PAYLOAD_TYPE_DEFAULT,FAST_MCTP_PAYLOAD_TYPE_ORDER,MCTP_INIT_ORDER_PAYLOAD_ID,MCTP_PAYLOAD_TYPE_CUSTOM_PAYLOAD,MCTP_PAYLOAD_TYPE_DEFAULT,PermitTypes,SWIFT_PAYLOAD_TYPE_CUSTOM_PAYLOAD,SWIFT_PAYLOAD_TYPE_DEFAULT,ZeroPermit,addBridgeLockedFeeMoveCalls,addBridgeWithFeeMoveCalls,addBridgeWithFeeMoveCalls2,addInitOrderMoveCalls,addresses,assertArgumentIsImmutable,broadcastJitoBundleId,checkHyperCoreDeposit,checkSdkVersionSupport,confirmJitoBundleId,createApproveInstruction,createAssociatedTokenAccountInstruction,createCloseAccountInstruction,createHyperCoreDepositFromSolanaInstructions,createHyperCoreDepositFromSuiMoveCalls,createInitializeRandomTokenAccountInstructions,createMctpBridgeLedgerInstruction,createMctpBridgeWithFeeInstruction,createMctpFromSolanaInstructions,createMctpFromSuiMoveCalls,createMonoChainFromSolanaInstructions,createPayloadWriterCloseInstruction,createPayloadWriterCreateInstruction,createSplTransferInstruction,createSwapFromSolanaInstructions,createSwapFromSuiMoveCalls,createSwiftFromSolanaInstructions,createSwiftOrderHash,createSwiftRandomKey,createSyncNativeInstruction,createTransferAllAndCloseInstruction,decentralizeClientSwapInstructions,decideRelayer,deserializeInstructionInfo,estimateQuoteRequiredGas,estimateQuoteRequiredGasAprox,estimateQuoteRequiredGasAprox2,fetchAllCoins,fetchAllTokenList,fetchMayanSuiPackageId,fetchQuote,fetchTokenList,generateFetchQuoteUrl,getAddressLookupTableAccounts,getAmountOfFractionalAmount,getAnchorInstructionData,getAssociatedTokenAddress,getCurrentChainTime,getDisplayAmount,getEstimateGasEvm,getEvmChainIdByName,getEvmSwiftParams,getFastMctpFromEvmTxPayload,getGasDecimal,getGasDecimalsInSolana,getHyperCoreDepositFromEvmTxPayload,getHyperCoreUSDCDepositCustomPayload,getHyperCoreUSDCDepositPermitParams,getJitoTipTransfer,getLookupTableAddress,getMctpFromEvmTxPayload,getMonoChainFromEvmTxPayload,getNormalizeFactor,getPermitDomain,getPermitParams,getQuoteSuitableReferrerAddress,getSafeU64Blob,getSdkVersion,getSuggestedRelayer,getSvmDurableNonce,getSwapEvm,getSwapFromEvmTxPayload,getSwapSolana,getSwapSui,getSwiftFromEvmGasLessParams,getSwiftFromEvmTxPayload,getSwiftOrderTypeData,getSwiftToTokenHexString,getWormholeChainIdById,getWormholeChainIdByName,hexToUint8Array,isValidAptosType,nativeAddressToHexString,resolveInputCoin,sandwichInstructionInCpiProxy,sendJitoBundle,solMint,submitSwiftEvmSwap,submitSwiftSolanaSwap,submitTransactionWithRetry,swapFromEvm,swapFromSolana,unwrapSol,validateJupSwap,validateJupSwapInstructionData,wait,wrapSol});
